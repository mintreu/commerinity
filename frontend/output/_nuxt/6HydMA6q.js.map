{"version":3,"file":"6HydMA6q.js","sources":["../../../../pages/dashboard/tour.vue"],"sourcesContent":["<template>\r\n  <div class=\"p-6 max-w-3xl mx-auto mt-14\">\r\n    <h1 class=\"text-2xl font-bold mb-6\">Complete Your Onboarding</h1>\r\n\r\n    <div class=\"space-y-4\">\r\n      <div\r\n          v-for=\"(step, index) in tourSteps\"\r\n          :key=\"index\"\r\n          :class=\"[\r\n          'p-4 border rounded-lg flex justify-between items-center transition',\r\n          step.completed ? 'bg-gray-100 cursor-not-allowed opacity-70' : '',\r\n          isNextStep(index) ? 'ring-2 ring-blue-400' : ''\r\n        ]\"\r\n      >\r\n        <div>\r\n          <h3 class=\"font-semibold text-lg flex items-center gap-2\">\r\n            {{ step.label }}\r\n            <span v-if=\"step.completed\" class=\"text-green-600\"><Icon name=\"solar:verified-check-broken\" /></span>\r\n          </h3>\r\n          <p class=\"text-gray-600\">{{ step.description }}</p>\r\n          <p class=\"text-sm text-gray-400\">Step {{ index + 1 }} of {{ tourSteps.length }}</p>\r\n        </div>\r\n\r\n        <div class=\"flex items-center gap-2\">\r\n          <NuxtLink\r\n              v-if=\"!step.completed\"\r\n              :to=\"step.to\"\r\n              class=\"bg-blue-600 text-white px-4 py-2 rounded hover:bg-blue-700 transition\"\r\n              :class=\"{ 'opacity-50 cursor-not-allowed pointer-events-none': !isNextStep(index) }\"\r\n          >\r\n            Go\r\n          </NuxtLink>\r\n\r\n          <span v-else class=\"text-gray-500 text-sm italic\">Completed</span>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Progress bar -->\r\n    <div class=\"mt-6\">\r\n      <div class=\"w-full bg-gray-200 rounded h-2\">\r\n        <div\r\n            class=\"bg-green-600 h-2 rounded\"\r\n            :style=\"{ width: ((completedSteps / tourSteps.length) * 100) + '%' }\"\r\n        ></div>\r\n      </div>\r\n      <p class=\"text-sm text-gray-500 mt-1\">\r\n        {{ completedSteps }} of {{ tourSteps.length }} steps completed\r\n      </p>\r\n    </div>\r\n\r\n    <!-- Submit button -->\r\n    <div v-if=\"completedSteps === tourSteps.length\" class=\"mt-6 text-center\">\r\n      <button\r\n          @click=\"submitOnboarding\"\r\n          class=\"bg-green-600 text-white px-6 py-3 rounded hover:bg-green-700 transition\"\r\n      >\r\n        Complete Onboarding\r\n      </button>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { ref, computed } from 'vue'\r\nimport { useSanctum, useSanctumFetch, useRuntimeConfig, useToast } from '#imports'\r\n\r\nconst { user } = useSanctum()\r\nconst toast = useToast()\r\nconst config = useRuntimeConfig()\r\nconst profileData = ref<any>(null)\r\ndefinePageMeta({ layout: 'dashboard' })\r\nasync function loadProfile() {\r\n  try {\r\n    const res = await useSanctumFetch(`${config.public.apiBase}/account/profile`)\r\n    profileData.value = res.data\r\n  } catch (err: any) {\r\n    toast.error({ title: 'Error', message: 'Failed to load profile' })\r\n  }\r\n}\r\n\r\nloadProfile()\r\n\r\nconst tourLinks = [\r\n  { to: '/dashboard/account', label: 'Profile', description: 'Update your personal info' },\r\n  { to: '/dashboard/account/address', label: 'Address', description: 'Update your address' },\r\n  { to: '/dashboard/account/kyc', label: 'KYC', description: 'Upload Aadhaar & PAN' },\r\n  { to: '/dashboard/subscribe-now', label: 'Subscription', description: 'Choose your plan' },\r\n]\r\n\r\n// Step completion functions\r\nfunction isProfileComplete(profile: any): boolean {\r\n  return Boolean(profile?.name?.trim()) &&\r\n      Boolean(profile?.dob?.trim()) &&\r\n      Boolean(profile?.gender?.trim())\r\n}\r\n\r\nfunction isAddressComplete(profile: any): boolean {\r\n  return profile?.address?.type === 'HOME'\r\n}\r\n\r\nfunction isKycComplete(profile: any): boolean {\r\n  return Boolean(profile?.kyc)\r\n}\r\n\r\nfunction isSubscriptionComplete(profile: any): boolean {\r\n  return Boolean(profile?.hasLevel) || Boolean(profile?.level_id)\r\n}\r\n\r\n// Compute tour steps dynamically and reactively\r\nconst tourSteps = computed(() => {\r\n  if (!profileData.value) return tourLinks.map(step => ({ ...step, completed: false }))\r\n\r\n  const profile = profileData.value\r\n\r\n  return tourLinks.map(step => {\r\n    let completed = false\r\n    switch (step.label) {\r\n      case 'Profile': completed = isProfileComplete(profile); break\r\n      case 'Address': completed = isAddressComplete(profile); break\r\n      case 'KYC': completed = isKycComplete(profile); break\r\n      case 'Subscription': completed = isSubscriptionComplete(profile); break\r\n    }\r\n    return { ...step, completed }\r\n  })\r\n})\r\n\r\n// Next incomplete step for highlight & enabling Go\r\nfunction isNextStep(index: number): boolean {\r\n  const firstIncompleteIndex = tourSteps.value.findIndex(s => !s.completed)\r\n  return index === firstIncompleteIndex\r\n}\r\n\r\n// Count completed steps\r\nconst completedSteps = computed(() => tourSteps.value.filter(s => s.completed).length)\r\n\r\n\r\n// Submit onboarding\r\nasync function submitOnboarding() {\r\n  try {\r\n    await useSanctumFetch(`${config.public.apiBase}/account/onboarding`, { method: 'POST' })\r\n    toast.success({ title: 'Success!', message: 'Onboarding completed successfully!' })\r\n    await loadProfile()\r\n  } catch (err: any) {\r\n    console.error(err)\r\n    toast.error({ title: 'Error', message: 'Failed to submit onboarding.' })\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n/* Hover & highlight ring for next step */\r\n.ring-blue-400 {\r\n  box-shadow: 0 0 0 4px rgba(96, 165, 250, 0.5);\r\n}\r\n</style>\r\n"],"names":["useSanctum","toast","useToast","config","useRuntimeConfig","profileData","ref","loadProfile","res","useSanctumFetch","tourLinks","isProfileComplete","profile","_a","_b","_c","isAddressComplete","isKycComplete","isSubscriptionComplete","tourSteps","computed","step","completed","isNextStep","index","firstIncompleteIndex","completedSteps","s","submitOnboarding","err","_openBlock","_createElementBlock","_hoisted_1","_cache","_createElementVNode","_hoisted_2","_Fragment","_renderList","_normalizeClass","_hoisted_3","_hoisted_4","_createVNode","_component_Icon","_hoisted_5","_toDisplayString","_hoisted_6","_hoisted_7","_hoisted_8","_createBlock","_component_NuxtLink","_hoisted_9","_hoisted_10","_normalizeStyle","_hoisted_11","_hoisted_12"],"mappings":"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"}