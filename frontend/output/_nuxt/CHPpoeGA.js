(function(){try{var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};t.SENTRY_RELEASE={id:"3703708ef9ac1b45e23fc2a6a145a79341d4c60a"}}catch{}})();try{(function(){var t=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},n=new t.Error().stack;n&&(t._sentryDebugIds=t._sentryDebugIds||{},t._sentryDebugIds[n]="a759cbb6-2aff-46f9-bbeb-ef02bc1350be",t._sentryDebugIdIdentifier="sentry-dbid-a759cbb6-2aff-46f9-bbeb-ef02bc1350be")})()}catch{}var Gt="http://www.w3.org/1999/xhtml";const ye={svg:"http://www.w3.org/2000/svg",xhtml:Gt,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Dt(t){var n=t+="",e=n.indexOf(":");return e>=0&&(n=t.slice(0,e))!=="xmlns"&&(t=t.slice(e+1)),ye.hasOwnProperty(n)?{space:ye[n],local:t}:t}function mn(t){return function(){var n=this.ownerDocument,e=this.namespaceURI;return e===Gt&&n.documentElement.namespaceURI===Gt?n.createElement(t):n.createElementNS(e,t)}}function yn(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Ie(t){var n=Dt(t);return(n.local?yn:mn)(n)}function xn(){}function se(t){return t==null?xn:function(){return this.querySelector(t)}}function _n(t){typeof t!="function"&&(t=se(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],s=o.length,a=i[r]=new Array(s),u,l,c=0;c<s;++c)(u=o[c])&&(l=t.call(u,u.__data__,c,o))&&("__data__"in u&&(l.__data__=u.__data__),a[c]=l);return new L(i,this._parents)}function wn(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function vn(){return[]}function Ye(t){return t==null?vn:function(){return this.querySelectorAll(t)}}function Cn(t){return function(){return wn(t.apply(this,arguments))}}function bn(t){typeof t=="function"?t=Cn(t):t=Ye(t);for(var n=this._groups,e=n.length,i=[],r=[],o=0;o<e;++o)for(var s=n[o],a=s.length,u,l=0;l<a;++l)(u=s[l])&&(i.push(t.call(u,u.__data__,l,s)),r.push(u));return new L(i,r)}function He(t){return function(){return this.matches(t)}}function Pe(t){return function(n){return n.matches(t)}}var $n=Array.prototype.find;function En(t){return function(){return $n.call(this.children,t)}}function kn(){return this.firstElementChild}function Sn(t){return this.select(t==null?kn:En(typeof t=="function"?t:Pe(t)))}var Nn=Array.prototype.filter;function Mn(){return Array.from(this.children)}function zn(t){return function(){return Nn.call(this.children,t)}}function Bn(t){return this.selectAll(t==null?Mn:zn(typeof t=="function"?t:Pe(t)))}function Tn(t){typeof t!="function"&&(t=He(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],s=o.length,a=i[r]=[],u,l=0;l<s;++l)(u=o[l])&&t.call(u,u.__data__,l,o)&&a.push(u);return new L(i,this._parents)}function Fe(t){return new Array(t.length)}function An(){return new L(this._enter||this._groups.map(Fe),this._parents)}function zt(t,n){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=n}zt.prototype={constructor:zt,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,n){return this._parent.insertBefore(t,n)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function Rn(t){return function(){return t}}function Xn(t,n,e,i,r,o){for(var s=0,a,u=n.length,l=o.length;s<l;++s)(a=n[s])?(a.__data__=o[s],i[s]=a):e[s]=new zt(t,o[s]);for(;s<u;++s)(a=n[s])&&(r[s]=a)}function Ln(t,n,e,i,r,o,s){var a,u,l=new Map,c=n.length,f=o.length,d=new Array(c),p;for(a=0;a<c;++a)(u=n[a])&&(d[a]=p=s.call(u,u.__data__,a,n)+"",l.has(p)?r[a]=u:l.set(p,u));for(a=0;a<f;++a)p=s.call(t,o[a],a,o)+"",(u=l.get(p))?(i[a]=u,u.__data__=o[a],l.delete(p)):e[a]=new zt(t,o[a]);for(a=0;a<c;++a)(u=n[a])&&l.get(d[a])===u&&(r[a]=u)}function Dn(t){return t.__data__}function In(t,n){if(!arguments.length)return Array.from(this,Dn);var e=n?Ln:Xn,i=this._parents,r=this._groups;typeof t!="function"&&(t=Rn(t));for(var o=r.length,s=new Array(o),a=new Array(o),u=new Array(o),l=0;l<o;++l){var c=i[l],f=r[l],d=f.length,p=Yn(t.call(c,c&&c.__data__,l,i)),x=p.length,y=a[l]=new Array(x),C=s[l]=new Array(x),_=u[l]=new Array(d);e(c,f,y,C,_,p,n);for(var $=0,S=0,k,z;$<x;++$)if(k=y[$]){for($>=S&&(S=$+1);!(z=C[S])&&++S<x;);k._next=z||null}}return s=new L(s,i),s._enter=a,s._exit=u,s}function Yn(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Hn(){return new L(this._exit||this._groups.map(Fe),this._parents)}function Pn(t,n,e){var i=this.enter(),r=this,o=this.exit();return typeof t=="function"?(i=t(i),i&&(i=i.selection())):i=i.append(t+""),n!=null&&(r=n(r),r&&(r=r.selection())),e==null?o.remove():e(o),i&&r?i.merge(r).order():r}function Fn(t){for(var n=t.selection?t.selection():t,e=this._groups,i=n._groups,r=e.length,o=i.length,s=Math.min(r,o),a=new Array(r),u=0;u<s;++u)for(var l=e[u],c=i[u],f=l.length,d=a[u]=new Array(f),p,x=0;x<f;++x)(p=l[x]||c[x])&&(d[x]=p);for(;u<r;++u)a[u]=e[u];return new L(a,this._parents)}function On(){for(var t=this._groups,n=-1,e=t.length;++n<e;)for(var i=t[n],r=i.length-1,o=i[r],s;--r>=0;)(s=i[r])&&(o&&s.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(s,o),o=s);return this}function qn(t){t||(t=Wn);function n(f,d){return f&&d?t(f.__data__,d.__data__):!f-!d}for(var e=this._groups,i=e.length,r=new Array(i),o=0;o<i;++o){for(var s=e[o],a=s.length,u=r[o]=new Array(a),l,c=0;c<a;++c)(l=s[c])&&(u[c]=l);u.sort(n)}return new L(r,this._parents).order()}function Wn(t,n){return t<n?-1:t>n?1:t>=n?0:NaN}function Vn(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function Un(){return Array.from(this)}function Jn(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length;r<o;++r){var s=i[r];if(s)return s}return null}function Gn(){let t=0;for(const n of this)++t;return t}function Zn(){return!this.node()}function Kn(t){for(var n=this._groups,e=0,i=n.length;e<i;++e)for(var r=n[e],o=0,s=r.length,a;o<s;++o)(a=r[o])&&t.call(a,a.__data__,o,r);return this}function Qn(t){return function(){this.removeAttribute(t)}}function jn(t){return function(){this.removeAttributeNS(t.space,t.local)}}function ti(t,n){return function(){this.setAttribute(t,n)}}function ei(t,n){return function(){this.setAttributeNS(t.space,t.local,n)}}function ni(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttribute(t):this.setAttribute(t,e)}}function ii(t,n){return function(){var e=n.apply(this,arguments);e==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,e)}}function ri(t,n){var e=Dt(t);if(arguments.length<2){var i=this.node();return e.local?i.getAttributeNS(e.space,e.local):i.getAttribute(e)}return this.each((n==null?e.local?jn:Qn:typeof n=="function"?e.local?ii:ni:e.local?ei:ti)(e,n))}function Oe(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function oi(t){return function(){this.style.removeProperty(t)}}function ai(t,n,e){return function(){this.style.setProperty(t,n,e)}}function si(t,n,e){return function(){var i=n.apply(this,arguments);i==null?this.style.removeProperty(t):this.style.setProperty(t,i,e)}}function li(t,n,e){return arguments.length>1?this.each((n==null?oi:typeof n=="function"?si:ai)(t,n,e??"")):ot(this.node(),t)}function ot(t,n){return t.style.getPropertyValue(n)||Oe(t).getComputedStyle(t,null).getPropertyValue(n)}function ci(t){return function(){delete this[t]}}function ui(t,n){return function(){this[t]=n}}function hi(t,n){return function(){var e=n.apply(this,arguments);e==null?delete this[t]:this[t]=e}}function fi(t,n){return arguments.length>1?this.each((n==null?ci:typeof n=="function"?hi:ui)(t,n)):this.node()[t]}function qe(t){return t.trim().split(/^|\s+/)}function le(t){return t.classList||new We(t)}function We(t){this._node=t,this._names=qe(t.getAttribute("class")||"")}We.prototype={add:function(t){var n=this._names.indexOf(t);n<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var n=this._names.indexOf(t);n>=0&&(this._names.splice(n,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function Ve(t,n){for(var e=le(t),i=-1,r=n.length;++i<r;)e.add(n[i])}function Ue(t,n){for(var e=le(t),i=-1,r=n.length;++i<r;)e.remove(n[i])}function di(t){return function(){Ve(this,t)}}function pi(t){return function(){Ue(this,t)}}function gi(t,n){return function(){(n.apply(this,arguments)?Ve:Ue)(this,t)}}function mi(t,n){var e=qe(t+"");if(arguments.length<2){for(var i=le(this.node()),r=-1,o=e.length;++r<o;)if(!i.contains(e[r]))return!1;return!0}return this.each((typeof n=="function"?gi:n?di:pi)(e,n))}function yi(){this.textContent=""}function xi(t){return function(){this.textContent=t}}function _i(t){return function(){var n=t.apply(this,arguments);this.textContent=n??""}}function wi(t){return arguments.length?this.each(t==null?yi:(typeof t=="function"?_i:xi)(t)):this.node().textContent}function vi(){this.innerHTML=""}function Ci(t){return function(){this.innerHTML=t}}function bi(t){return function(){var n=t.apply(this,arguments);this.innerHTML=n??""}}function $i(t){return arguments.length?this.each(t==null?vi:(typeof t=="function"?bi:Ci)(t)):this.node().innerHTML}function Ei(){this.nextSibling&&this.parentNode.appendChild(this)}function ki(){return this.each(Ei)}function Si(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Ni(){return this.each(Si)}function Mi(t){var n=typeof t=="function"?t:Ie(t);return this.select(function(){return this.appendChild(n.apply(this,arguments))})}function zi(){return null}function Bi(t,n){var e=typeof t=="function"?t:Ie(t),i=n==null?zi:typeof n=="function"?n:se(n);return this.select(function(){return this.insertBefore(e.apply(this,arguments),i.apply(this,arguments)||null)})}function Ti(){var t=this.parentNode;t&&t.removeChild(this)}function Ai(){return this.each(Ti)}function Ri(){var t=this.cloneNode(!1),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Xi(){var t=this.cloneNode(!0),n=this.parentNode;return n?n.insertBefore(t,this.nextSibling):t}function Li(t){return this.select(t?Xi:Ri)}function Di(t){return arguments.length?this.property("__data__",t):this.node().__data__}function Ii(t){return function(n){t.call(this,n,this.__data__)}}function Yi(t){return t.trim().split(/^|\s+/).map(function(n){var e="",i=n.indexOf(".");return i>=0&&(e=n.slice(i+1),n=n.slice(0,i)),{type:n,name:e}})}function Hi(t){return function(){var n=this.__on;if(n){for(var e=0,i=-1,r=n.length,o;e<r;++e)o=n[e],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):n[++i]=o;++i?n.length=i:delete this.__on}}}function Pi(t,n,e){return function(){var i=this.__on,r,o=Ii(n);if(i){for(var s=0,a=i.length;s<a;++s)if((r=i[s]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=e),r.value=n;return}}this.addEventListener(t.type,o,e),r={type:t.type,name:t.name,value:n,listener:o,options:e},i?i.push(r):this.__on=[r]}}function Fi(t,n,e){var i=Yi(t+""),r,o=i.length,s;if(arguments.length<2){var a=this.node().__on;if(a){for(var u=0,l=a.length,c;u<l;++u)for(r=0,c=a[u];r<o;++r)if((s=i[r]).type===c.type&&s.name===c.name)return c.value}return}for(a=n?Pi:Hi,r=0;r<o;++r)this.each(a(i[r],n,e));return this}function Je(t,n,e){var i=Oe(t),r=i.CustomEvent;typeof r=="function"?r=new r(n,e):(r=i.document.createEvent("Event"),e?(r.initEvent(n,e.bubbles,e.cancelable),r.detail=e.detail):r.initEvent(n,!1,!1)),t.dispatchEvent(r)}function Oi(t,n){return function(){return Je(this,t,n)}}function qi(t,n){return function(){return Je(this,t,n.apply(this,arguments))}}function Wi(t,n){return this.each((typeof n=="function"?qi:Oi)(t,n))}function*Vi(){for(var t=this._groups,n=0,e=t.length;n<e;++n)for(var i=t[n],r=0,o=i.length,s;r<o;++r)(s=i[r])&&(yield s)}var Ge=[null];function L(t,n){this._groups=t,this._parents=n}function lt(){return new L([[document.documentElement]],Ge)}function Ui(){return this}L.prototype=lt.prototype={constructor:L,select:_n,selectAll:bn,selectChild:Sn,selectChildren:Bn,filter:Tn,data:In,enter:An,exit:Hn,join:Pn,merge:Fn,selection:Ui,order:On,sort:qn,call:Vn,nodes:Un,node:Jn,size:Gn,empty:Zn,each:Kn,attr:ri,style:li,property:fi,classed:mi,text:wi,html:$i,raise:ki,lower:Ni,append:Mi,insert:Bi,remove:Ai,clone:Li,datum:Di,on:Fi,dispatch:Wi,[Symbol.iterator]:Vi};function H(t){return typeof t=="string"?new L([[document.querySelector(t)]],[document.documentElement]):new L([[t]],Ge)}function Ji(t){let n;for(;n=t.sourceEvent;)t=n;return t}function j(t,n){if(t=Ji(t),n===void 0&&(n=t.currentTarget),n){var e=n.ownerSVGElement||n;if(e.createSVGPoint){var i=e.createSVGPoint();return i.x=t.clientX,i.y=t.clientY,i=i.matrixTransform(n.getScreenCTM().inverse()),[i.x,i.y]}if(n.getBoundingClientRect){var r=n.getBoundingClientRect();return[t.clientX-r.left-n.clientLeft,t.clientY-r.top-n.clientTop]}}return[t.pageX,t.pageY]}function Gi(t,n){var e=0,i=0;return Float64Array.from(t,n===void 0?r=>e+=+r||0:r=>e+=+n(r,i++,t)||0)}function Zi(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e<i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e<r||e===void 0&&r>=r)&&(e=r)}return e}function Ki(t,n){let e;if(n===void 0)for(const i of t)i!=null&&(e>i||e===void 0&&i>=i)&&(e=i);else{let i=-1;for(let r of t)(r=n(r,++i,t))!=null&&(e>r||e===void 0&&r>=r)&&(e=r)}return e}function Qi(t,n){let e=0;if(n===void 0)for(let i of t)(i=+i)&&(e+=i);else{let i=-1;for(let r of t)(r=+n(r,++i,t))&&(e+=r)}return e}function ji(t){var n=0,e=t.children,i=e&&e.length;if(!i)n=1;else for(;--i>=0;)n+=e[i].value;t.value=n}function tr(){return this.eachAfter(ji)}function er(t,n){let e=-1;for(const i of this)t.call(n,i,++e,this);return this}function nr(t,n){for(var e=this,i=[e],r,o,s=-1;e=i.pop();)if(t.call(n,e,++s,this),r=e.children)for(o=r.length-1;o>=0;--o)i.push(r[o]);return this}function ir(t,n){for(var e=this,i=[e],r=[],o,s,a,u=-1;e=i.pop();)if(r.push(e),o=e.children)for(s=0,a=o.length;s<a;++s)i.push(o[s]);for(;e=r.pop();)t.call(n,e,++u,this);return this}function rr(t,n){let e=-1;for(const i of this)if(t.call(n,i,++e,this))return i}function or(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,i=n.children,r=i&&i.length;--r>=0;)e+=i[r].value;n.value=e})}function ar(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})}function sr(t){for(var n=this,e=lr(n,t),i=[n];n!==e;)n=n.parent,i.push(n);for(var r=i.length;t!==e;)i.splice(r,0,t),t=t.parent;return i}function lr(t,n){if(t===n)return t;var e=t.ancestors(),i=n.ancestors(),r=null;for(t=e.pop(),n=i.pop();t===n;)r=t,t=e.pop(),n=i.pop();return r}function cr(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n}function ur(){return Array.from(this)}function hr(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t}function fr(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function*dr(){var t=this,n,e=[t],i,r,o;do for(n=e.reverse(),e=[];t=n.pop();)if(yield t,i=t.children)for(r=0,o=i.length;r<o;++r)e.push(i[r]);while(e.length)}function Ze(t,n){t instanceof Map?(t=[void 0,t],n===void 0&&(n=mr)):n===void 0&&(n=gr);for(var e=new at(t),i,r=[e],o,s,a,u;i=r.pop();)if((s=n(i.data))&&(u=(s=Array.from(s)).length))for(i.children=s,a=u-1;a>=0;--a)r.push(o=s[a]=new at(s[a])),o.parent=i,o.depth=i.depth+1;return e.eachBefore(Ke)}function pr(){return Ze(this).eachBefore(yr)}function gr(t){return t.children}function mr(t){return Array.isArray(t)?t[1]:null}function yr(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function Ke(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function at(t){this.data=t,this.depth=this.height=0,this.parent=null}at.prototype=Ze.prototype={constructor:at,count:tr,each:er,eachAfter:ir,eachBefore:nr,find:rr,sum:or,sort:ar,path:sr,ancestors:cr,descendants:ur,leaves:hr,links:fr,copy:pr,[Symbol.iterator]:dr};function Ft(t){return t==null?null:xr(t)}function xr(t){if(typeof t!="function")throw new Error;return t}var _r={depth:-1},xe={},Ot={};function wr(t){return t.id}function vr(t){return t.parentId}function Cr(){var t=wr,n=vr,e;function i(r){var o=Array.from(r),s=t,a=n,u,l,c,f,d,p,x,y,C=new Map;if(e!=null){const _=o.map((k,z)=>br(e(k,z,r))),$=_.map(_e),S=new Set(_).add("");for(const k of $)S.has(k)||(S.add(k),_.push(k),$.push(_e(k)),o.push(Ot));s=(k,z)=>_[z],a=(k,z)=>$[z]}for(c=0,u=o.length;c<u;++c)l=o[c],p=o[c]=new at(l),(x=s(l,c,r))!=null&&(x+="")&&(y=p.id=x,C.set(y,C.has(y)?xe:p)),(x=a(l,c,r))!=null&&(x+="")&&(p.parent=x);for(c=0;c<u;++c)if(p=o[c],x=p.parent){if(d=C.get(x),!d)throw new Error("missing: "+x);if(d===xe)throw new Error("ambiguous: "+x);d.children?d.children.push(p):d.children=[p],p.parent=d}else{if(f)throw new Error("multiple roots");f=p}if(!f)throw new Error("no root");if(e!=null){for(;f.data===Ot&&f.children.length===1;)f=f.children[0],--u;for(let _=o.length-1;_>=0&&(p=o[_],p.data===Ot);--_)p.data=null}if(f.parent=_r,f.eachBefore(function(_){_.depth=_.parent.depth+1,--u}).eachBefore(Ke),f.parent=null,u>0)throw new Error("cycle");return f}return i.id=function(r){return arguments.length?(t=Ft(r),i):t},i.parentId=function(r){return arguments.length?(n=Ft(r),i):n},i.path=function(r){return arguments.length?(e=Ft(r),i):e},i}function br(t){t=`${t}`;let n=t.length;return Zt(t,n-1)&&!Zt(t,n-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:`/${t}`}function _e(t){let n=t.length;if(n<2)return"";for(;--n>1&&!Zt(t,n););return t.slice(0,n)}function Zt(t,n){if(t[n]==="/"){let e=0;for(;n>0&&t[--n]==="\\";)++e;if((e&1)===0)return!0}return!1}function $r(t,n){return t.parent===n.parent?1:2}function qt(t){var n=t.children;return n?n[0]:t.t}function Wt(t){var n=t.children;return n?n[n.length-1]:t.t}function Er(t,n,e){var i=e/(n.i-t.i);n.c-=i,n.s+=e,t.c+=i,n.z+=e,n.m+=e}function kr(t){for(var n=0,e=0,i=t.children,r=i.length,o;--r>=0;)o=i[r],o.z+=n,o.m+=n,n+=o.s+(e+=o.c)}function Sr(t,n,e){return t.a.parent===n.parent?t.a:e}function Et(t,n){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=n}Et.prototype=Object.create(at.prototype);function Nr(t){for(var n=new Et(t,0),e,i=[n],r,o,s,a;e=i.pop();)if(o=e._.children)for(e.children=new Array(a=o.length),s=a-1;s>=0;--s)i.push(r=e.children[s]=new Et(o[s],s)),r.parent=e;return(n.parent=new Et(null,0)).children=[n],n}function Mr(){var t=$r,n=1,e=1,i=null;function r(l){var c=Nr(l);if(c.eachAfter(o),c.parent.m=-c.z,c.eachBefore(s),i)l.eachBefore(u);else{var f=l,d=l,p=l;l.eachBefore(function($){$.x<f.x&&(f=$),$.x>d.x&&(d=$),$.depth>p.depth&&(p=$)});var x=f===d?1:t(f,d)/2,y=x-f.x,C=n/(d.x+x+y),_=e/(p.depth||1);l.eachBefore(function($){$.x=($.x+y)*C,$.y=$.depth*_})}return l}function o(l){var c=l.children,f=l.parent.children,d=l.i?f[l.i-1]:null;if(c){kr(l);var p=(c[0].z+c[c.length-1].z)/2;d?(l.z=d.z+t(l._,d._),l.m=l.z-p):l.z=p}else d&&(l.z=d.z+t(l._,d._));l.parent.A=a(l,d,l.parent.A||f[0])}function s(l){l._.x=l.z+l.parent.m,l.m+=l.parent.m}function a(l,c,f){if(c){for(var d=l,p=l,x=c,y=d.parent.children[0],C=d.m,_=p.m,$=x.m,S=y.m,k;x=Wt(x),d=qt(d),x&&d;)y=qt(y),p=Wt(p),p.a=l,k=x.z+$-d.z-C+t(x._,d._),k>0&&(Er(Sr(x,l,f),l,k),C+=k,_+=k),$+=x.m,C+=d.m,S+=y.m,_+=p.m;x&&!Wt(p)&&(p.t=x,p.m+=$-_),d&&!qt(y)&&(y.t=d,y.m+=C-S,f=l)}return f}function u(l){l.x*=n,l.y=l.depth*e}return r.separation=function(l){return arguments.length?(t=l,r):t},r.size=function(l){return arguments.length?(i=!1,n=+l[0],e=+l[1],r):i?null:[n,e]},r.nodeSize=function(l){return arguments.length?(i=!0,n=+l[0],e=+l[1],r):i?[n,e]:null},r}var zr={value:()=>{}};function ce(){for(var t=0,n=arguments.length,e={},i;t<n;++t){if(!(i=arguments[t]+"")||i in e||/[\s.]/.test(i))throw new Error("illegal type: "+i);e[i]=[]}return new kt(e)}function kt(t){this._=t}function Br(t,n){return t.trim().split(/^|\s+/).map(function(e){var i="",r=e.indexOf(".");if(r>=0&&(i=e.slice(r+1),e=e.slice(0,r)),e&&!n.hasOwnProperty(e))throw new Error("unknown type: "+e);return{type:e,name:i}})}kt.prototype=ce.prototype={constructor:kt,on:function(t,n){var e=this._,i=Br(t+"",e),r,o=-1,s=i.length;if(arguments.length<2){for(;++o<s;)if((r=(t=i[o]).type)&&(r=Tr(e[r],t.name)))return r;return}if(n!=null&&typeof n!="function")throw new Error("invalid callback: "+n);for(;++o<s;)if(r=(t=i[o]).type)e[r]=we(e[r],t.name,n);else if(n==null)for(r in e)e[r]=we(e[r],t.name,null);return this},copy:function(){var t={},n=this._;for(var e in n)t[e]=n[e].slice();return new kt(t)},call:function(t,n){if((r=arguments.length-2)>0)for(var e=new Array(r),i=0,r,o;i<r;++i)e[i]=arguments[i+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],i=0,r=o.length;i<r;++i)o[i].value.apply(n,e)},apply:function(t,n,e){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var i=this._[t],r=0,o=i.length;r<o;++r)i[r].value.apply(n,e)}};function Tr(t,n){for(var e=0,i=t.length,r;e<i;++e)if((r=t[e]).name===n)return r.value}function we(t,n,e){for(var i=0,r=t.length;i<r;++i)if(t[i].name===n){t[i]=zr,t=t.slice(0,i).concat(t.slice(i+1));break}return e!=null&&t.push({name:n,value:e}),t}const Kt={capture:!0,passive:!1};function Qt(t){t.preventDefault(),t.stopImmediatePropagation()}function Ar(t){var n=t.document.documentElement,e=H(t).on("dragstart.drag",Qt,Kt);"onselectstart"in n?e.on("selectstart.drag",Qt,Kt):(n.__noselect=n.style.MozUserSelect,n.style.MozUserSelect="none")}function Rr(t,n){var e=t.document.documentElement,i=H(t).on("dragstart.drag",null);n&&(i.on("click.drag",Qt,Kt),setTimeout(function(){i.on("click.drag",null)},0)),"onselectstart"in e?i.on("selectstart.drag",null):(e.style.MozUserSelect=e.__noselect,delete e.__noselect)}function ue(t,n,e){t.prototype=n.prototype=e,e.constructor=t}function Qe(t,n){var e=Object.create(t.prototype);for(var i in n)e[i]=n[i];return e}function _t(){}var gt=.7,Bt=1/gt,rt="\\s*([+-]?\\d+)\\s*",mt="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",q="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",Xr=/^#([0-9a-f]{3,8})$/,Lr=new RegExp(`^rgb\\(${rt},${rt},${rt}\\)$`),Dr=new RegExp(`^rgb\\(${q},${q},${q}\\)$`),Ir=new RegExp(`^rgba\\(${rt},${rt},${rt},${mt}\\)$`),Yr=new RegExp(`^rgba\\(${q},${q},${q},${mt}\\)$`),Hr=new RegExp(`^hsl\\(${mt},${q},${q}\\)$`),Pr=new RegExp(`^hsla\\(${mt},${q},${q},${mt}\\)$`),ve={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};ue(_t,yt,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Ce,formatHex:Ce,formatHex8:Fr,formatHsl:Or,formatRgb:be,toString:be});function Ce(){return this.rgb().formatHex()}function Fr(){return this.rgb().formatHex8()}function Or(){return je(this).formatHsl()}function be(){return this.rgb().formatRgb()}function yt(t){var n,e;return t=(t+"").trim().toLowerCase(),(n=Xr.exec(t))?(e=n[1].length,n=parseInt(n[1],16),e===6?$e(n):e===3?new X(n>>8&15|n>>4&240,n>>4&15|n&240,(n&15)<<4|n&15,1):e===8?vt(n>>24&255,n>>16&255,n>>8&255,(n&255)/255):e===4?vt(n>>12&15|n>>8&240,n>>8&15|n>>4&240,n>>4&15|n&240,((n&15)<<4|n&15)/255):null):(n=Lr.exec(t))?new X(n[1],n[2],n[3],1):(n=Dr.exec(t))?new X(n[1]*255/100,n[2]*255/100,n[3]*255/100,1):(n=Ir.exec(t))?vt(n[1],n[2],n[3],n[4]):(n=Yr.exec(t))?vt(n[1]*255/100,n[2]*255/100,n[3]*255/100,n[4]):(n=Hr.exec(t))?Se(n[1],n[2]/100,n[3]/100,1):(n=Pr.exec(t))?Se(n[1],n[2]/100,n[3]/100,n[4]):ve.hasOwnProperty(t)?$e(ve[t]):t==="transparent"?new X(NaN,NaN,NaN,0):null}function $e(t){return new X(t>>16&255,t>>8&255,t&255,1)}function vt(t,n,e,i){return i<=0&&(t=n=e=NaN),new X(t,n,e,i)}function qr(t){return t instanceof _t||(t=yt(t)),t?(t=t.rgb(),new X(t.r,t.g,t.b,t.opacity)):new X}function jt(t,n,e,i){return arguments.length===1?qr(t):new X(t,n,e,i??1)}function X(t,n,e,i){this.r=+t,this.g=+n,this.b=+e,this.opacity=+i}ue(X,jt,Qe(_t,{brighter(t){return t=t==null?Bt:Math.pow(Bt,t),new X(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?gt:Math.pow(gt,t),new X(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new X(nt(this.r),nt(this.g),nt(this.b),Tt(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:Ee,formatHex:Ee,formatHex8:Wr,formatRgb:ke,toString:ke}));function Ee(){return`#${et(this.r)}${et(this.g)}${et(this.b)}`}function Wr(){return`#${et(this.r)}${et(this.g)}${et(this.b)}${et((isNaN(this.opacity)?1:this.opacity)*255)}`}function ke(){const t=Tt(this.opacity);return`${t===1?"rgb(":"rgba("}${nt(this.r)}, ${nt(this.g)}, ${nt(this.b)}${t===1?")":`, ${t})`}`}function Tt(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function nt(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function et(t){return t=nt(t),(t<16?"0":"")+t.toString(16)}function Se(t,n,e,i){return i<=0?t=n=e=NaN:e<=0||e>=1?t=n=NaN:n<=0&&(t=NaN),new P(t,n,e,i)}function je(t){if(t instanceof P)return new P(t.h,t.s,t.l,t.opacity);if(t instanceof _t||(t=yt(t)),!t)return new P;if(t instanceof P)return t;t=t.rgb();var n=t.r/255,e=t.g/255,i=t.b/255,r=Math.min(n,e,i),o=Math.max(n,e,i),s=NaN,a=o-r,u=(o+r)/2;return a?(n===o?s=(e-i)/a+(e<i)*6:e===o?s=(i-n)/a+2:s=(n-e)/a+4,a/=u<.5?o+r:2-o-r,s*=60):a=u>0&&u<1?0:s,new P(s,a,u,t.opacity)}function Vr(t,n,e,i){return arguments.length===1?je(t):new P(t,n,e,i??1)}function P(t,n,e,i){this.h=+t,this.s=+n,this.l=+e,this.opacity=+i}ue(P,Vr,Qe(_t,{brighter(t){return t=t==null?Bt:Math.pow(Bt,t),new P(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?gt:Math.pow(gt,t),new P(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,n=isNaN(t)||isNaN(this.s)?0:this.s,e=this.l,i=e+(e<.5?e:1-e)*n,r=2*e-i;return new X(Vt(t>=240?t-240:t+120,r,i),Vt(t,r,i),Vt(t<120?t+240:t-120,r,i),this.opacity)},clamp(){return new P(Ne(this.h),Ct(this.s),Ct(this.l),Tt(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=Tt(this.opacity);return`${t===1?"hsl(":"hsla("}${Ne(this.h)}, ${Ct(this.s)*100}%, ${Ct(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Ne(t){return t=(t||0)%360,t<0?t+360:t}function Ct(t){return Math.max(0,Math.min(1,t||0))}function Vt(t,n,e){return(t<60?n+(e-n)*t/60:t<180?e:t<240?n+(e-n)*(240-t)/60:n)*255}const tn=t=>()=>t;function Ur(t,n){return function(e){return t+e*n}}function Jr(t,n,e){return t=Math.pow(t,e),n=Math.pow(n,e)-t,e=1/e,function(i){return Math.pow(t+i*n,e)}}function Gr(t){return(t=+t)==1?en:function(n,e){return e-n?Jr(n,e,t):tn(isNaN(n)?e:n)}}function en(t,n){var e=n-t;return e?Ur(t,e):tn(isNaN(t)?n:t)}const Me=function t(n){var e=Gr(n);function i(r,o){var s=e((r=jt(r)).r,(o=jt(o)).r),a=e(r.g,o.g),u=e(r.b,o.b),l=en(r.opacity,o.opacity);return function(c){return r.r=s(c),r.g=a(c),r.b=u(c),r.opacity=l(c),r+""}}return i.gamma=t,i}(1);function Q(t,n){return t=+t,n=+n,function(e){return t*(1-e)+n*e}}var te=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Ut=new RegExp(te.source,"g");function Zr(t){return function(){return t}}function Kr(t){return function(n){return t(n)+""}}function Qr(t,n){var e=te.lastIndex=Ut.lastIndex=0,i,r,o,s=-1,a=[],u=[];for(t=t+"",n=n+"";(i=te.exec(t))&&(r=Ut.exec(n));)(o=r.index)>e&&(o=n.slice(e,o),a[s]?a[s]+=o:a[++s]=o),(i=i[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:Q(i,r)})),e=Ut.lastIndex;return e<n.length&&(o=n.slice(e),a[s]?a[s]+=o:a[++s]=o),a.length<2?u[0]?Kr(u[0].x):Zr(n):(n=u.length,function(l){for(var c=0,f;c<n;++c)a[(f=u[c]).i]=f.x(l);return a.join("")})}var ze=180/Math.PI,ee={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function nn(t,n,e,i,r,o){var s,a,u;return(s=Math.sqrt(t*t+n*n))&&(t/=s,n/=s),(u=t*e+n*i)&&(e-=t*u,i-=n*u),(a=Math.sqrt(e*e+i*i))&&(e/=a,i/=a,u/=a),t*i<n*e&&(t=-t,n=-n,u=-u,s=-s),{translateX:r,translateY:o,rotate:Math.atan2(n,t)*ze,skewX:Math.atan(u)*ze,scaleX:s,scaleY:a}}var bt;function jr(t){const n=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return n.isIdentity?ee:nn(n.a,n.b,n.c,n.d,n.e,n.f)}function to(t){return t==null||(bt||(bt=document.createElementNS("http://www.w3.org/2000/svg","g")),bt.setAttribute("transform",t),!(t=bt.transform.baseVal.consolidate()))?ee:(t=t.matrix,nn(t.a,t.b,t.c,t.d,t.e,t.f))}function rn(t,n,e,i){function r(l){return l.length?l.pop()+" ":""}function o(l,c,f,d,p,x){if(l!==f||c!==d){var y=p.push("translate(",null,n,null,e);x.push({i:y-4,x:Q(l,f)},{i:y-2,x:Q(c,d)})}else(f||d)&&p.push("translate("+f+n+d+e)}function s(l,c,f,d){l!==c?(l-c>180?c+=360:c-l>180&&(l+=360),d.push({i:f.push(r(f)+"rotate(",null,i)-2,x:Q(l,c)})):c&&f.push(r(f)+"rotate("+c+i)}function a(l,c,f,d){l!==c?d.push({i:f.push(r(f)+"skewX(",null,i)-2,x:Q(l,c)}):c&&f.push(r(f)+"skewX("+c+i)}function u(l,c,f,d,p,x){if(l!==f||c!==d){var y=p.push(r(p)+"scale(",null,",",null,")");x.push({i:y-4,x:Q(l,f)},{i:y-2,x:Q(c,d)})}else(f!==1||d!==1)&&p.push(r(p)+"scale("+f+","+d+")")}return function(l,c){var f=[],d=[];return l=t(l),c=t(c),o(l.translateX,l.translateY,c.translateX,c.translateY,f,d),s(l.rotate,c.rotate,f,d),a(l.skewX,c.skewX,f,d),u(l.scaleX,l.scaleY,c.scaleX,c.scaleY,f,d),l=c=null,function(p){for(var x=-1,y=d.length,C;++x<y;)f[(C=d[x]).i]=C.x(p);return f.join("")}}}var eo=rn(jr,"px, ","px)","deg)"),no=rn(to,", ",")",")"),io=1e-12;function Be(t){return((t=Math.exp(t))+1/t)/2}function ro(t){return((t=Math.exp(t))-1/t)/2}function oo(t){return((t=Math.exp(2*t))-1)/(t+1)}const ao=function t(n,e,i){function r(o,s){var a=o[0],u=o[1],l=o[2],c=s[0],f=s[1],d=s[2],p=c-a,x=f-u,y=p*p+x*x,C,_;if(y<io)_=Math.log(d/l)/n,C=function(R){return[a+R*p,u+R*x,l*Math.exp(n*R*_)]};else{var $=Math.sqrt(y),S=(d*d-l*l+i*y)/(2*l*e*$),k=(d*d-l*l-i*y)/(2*d*e*$),z=Math.log(Math.sqrt(S*S+1)-S),A=Math.log(Math.sqrt(k*k+1)-k);_=(A-z)/n,C=function(R){var V=R*_,D=Be(z),ct=l/(e*$)*(D*oo(n*V+z)-ro(z));return[a+ct*p,u+ct*x,l*D/Be(n*V+z)]}}return C.duration=_*1e3*n/Math.SQRT2,C}return r.rho=function(o){var s=Math.max(.001,+o),a=s*s,u=a*a;return t(s,a,u)},r}(Math.SQRT2,2,4);var st=0,dt=0,ht=0,on=1e3,At,pt,Rt=0,it=0,It=0,xt=typeof performance=="object"&&performance.now?performance:Date,an=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function he(){return it||(an(so),it=xt.now()+It)}function so(){it=0}function Xt(){this._call=this._time=this._next=null}Xt.prototype=sn.prototype={constructor:Xt,restart:function(t,n,e){if(typeof t!="function")throw new TypeError("callback is not a function");e=(e==null?he():+e)+(n==null?0:+n),!this._next&&pt!==this&&(pt?pt._next=this:At=this,pt=this),this._call=t,this._time=e,ne()},stop:function(){this._call&&(this._call=null,this._time=1/0,ne())}};function sn(t,n,e){var i=new Xt;return i.restart(t,n,e),i}function lo(){he(),++st;for(var t=At,n;t;)(n=it-t._time)>=0&&t._call.call(void 0,n),t=t._next;--st}function Te(){it=(Rt=xt.now())+It,st=dt=0;try{lo()}finally{st=0,uo(),it=0}}function co(){var t=xt.now(),n=t-Rt;n>on&&(It-=n,Rt=t)}function uo(){for(var t,n=At,e,i=1/0;n;)n._call?(i>n._time&&(i=n._time),t=n,n=n._next):(e=n._next,n._next=null,n=t?t._next=e:At=e);pt=t,ne(i)}function ne(t){if(!st){dt&&(dt=clearTimeout(dt));var n=t-it;n>24?(t<1/0&&(dt=setTimeout(Te,t-xt.now()-It)),ht&&(ht=clearInterval(ht))):(ht||(Rt=xt.now(),ht=setInterval(co,on)),st=1,an(Te))}}function Ae(t,n,e){var i=new Xt;return n=n==null?0:+n,i.restart(r=>{i.stop(),t(r+n)},n,e),i}var ho=ce("start","end","cancel","interrupt"),fo=[],ln=0,Re=1,ie=2,St=3,Xe=4,re=5,Nt=6;function Yt(t,n,e,i,r,o){var s=t.__transition;if(!s)t.__transition={};else if(e in s)return;po(t,e,{name:n,index:i,group:r,on:ho,tween:fo,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:ln})}function fe(t,n){var e=F(t,n);if(e.state>ln)throw new Error("too late; already scheduled");return e}function W(t,n){var e=F(t,n);if(e.state>St)throw new Error("too late; already running");return e}function F(t,n){var e=t.__transition;if(!e||!(e=e[n]))throw new Error("transition not found");return e}function po(t,n,e){var i=t.__transition,r;i[n]=e,e.timer=sn(o,0,e.time);function o(l){e.state=Re,e.timer.restart(s,e.delay,e.time),e.delay<=l&&s(l-e.delay)}function s(l){var c,f,d,p;if(e.state!==Re)return u();for(c in i)if(p=i[c],p.name===e.name){if(p.state===St)return Ae(s);p.state===Xe?(p.state=Nt,p.timer.stop(),p.on.call("interrupt",t,t.__data__,p.index,p.group),delete i[c]):+c<n&&(p.state=Nt,p.timer.stop(),p.on.call("cancel",t,t.__data__,p.index,p.group),delete i[c])}if(Ae(function(){e.state===St&&(e.state=Xe,e.timer.restart(a,e.delay,e.time),a(l))}),e.state=ie,e.on.call("start",t,t.__data__,e.index,e.group),e.state===ie){for(e.state=St,r=new Array(d=e.tween.length),c=0,f=-1;c<d;++c)(p=e.tween[c].value.call(t,t.__data__,e.index,e.group))&&(r[++f]=p);r.length=f+1}}function a(l){for(var c=l<e.duration?e.ease.call(null,l/e.duration):(e.timer.restart(u),e.state=re,1),f=-1,d=r.length;++f<d;)r[f].call(t,c);e.state===re&&(e.on.call("end",t,t.__data__,e.index,e.group),u())}function u(){e.state=Nt,e.timer.stop(),delete i[n];for(var l in i)return;delete t.__transition}}function Mt(t,n){var e=t.__transition,i,r,o=!0,s;if(e){n=n==null?null:n+"";for(s in e){if((i=e[s]).name!==n){o=!1;continue}r=i.state>ie&&i.state<re,i.state=Nt,i.timer.stop(),i.on.call(r?"interrupt":"cancel",t,t.__data__,i.index,i.group),delete e[s]}o&&delete t.__transition}}function go(t){return this.each(function(){Mt(this,t)})}function mo(t,n){var e,i;return function(){var r=W(this,t),o=r.tween;if(o!==e){i=e=o;for(var s=0,a=i.length;s<a;++s)if(i[s].name===n){i=i.slice(),i.splice(s,1);break}}r.tween=i}}function yo(t,n,e){var i,r;if(typeof e!="function")throw new Error;return function(){var o=W(this,t),s=o.tween;if(s!==i){r=(i=s).slice();for(var a={name:n,value:e},u=0,l=r.length;u<l;++u)if(r[u].name===n){r[u]=a;break}u===l&&r.push(a)}o.tween=r}}function xo(t,n){var e=this._id;if(t+="",arguments.length<2){for(var i=F(this.node(),e).tween,r=0,o=i.length,s;r<o;++r)if((s=i[r]).name===t)return s.value;return null}return this.each((n==null?mo:yo)(e,t,n))}function de(t,n,e){var i=t._id;return t.each(function(){var r=W(this,i);(r.value||(r.value={}))[n]=e.apply(this,arguments)}),function(r){return F(r,i).value[n]}}function cn(t,n){var e;return(typeof n=="number"?Q:n instanceof yt?Me:(e=yt(n))?(n=e,Me):Qr)(t,n)}function _o(t){return function(){this.removeAttribute(t)}}function wo(t){return function(){this.removeAttributeNS(t.space,t.local)}}function vo(t,n,e){var i,r=e+"",o;return function(){var s=this.getAttribute(t);return s===r?null:s===i?o:o=n(i=s,e)}}function Co(t,n,e){var i,r=e+"",o;return function(){var s=this.getAttributeNS(t.space,t.local);return s===r?null:s===i?o:o=n(i=s,e)}}function bo(t,n,e){var i,r,o;return function(){var s,a=e(this),u;return a==null?void this.removeAttribute(t):(s=this.getAttribute(t),u=a+"",s===u?null:s===i&&u===r?o:(r=u,o=n(i=s,a)))}}function $o(t,n,e){var i,r,o;return function(){var s,a=e(this),u;return a==null?void this.removeAttributeNS(t.space,t.local):(s=this.getAttributeNS(t.space,t.local),u=a+"",s===u?null:s===i&&u===r?o:(r=u,o=n(i=s,a)))}}function Eo(t,n){var e=Dt(t),i=e==="transform"?no:cn;return this.attrTween(t,typeof n=="function"?(e.local?$o:bo)(e,i,de(this,"attr."+t,n)):n==null?(e.local?wo:_o)(e):(e.local?Co:vo)(e,i,n))}function ko(t,n){return function(e){this.setAttribute(t,n.call(this,e))}}function So(t,n){return function(e){this.setAttributeNS(t.space,t.local,n.call(this,e))}}function No(t,n){var e,i;function r(){var o=n.apply(this,arguments);return o!==i&&(e=(i=o)&&So(t,o)),e}return r._value=n,r}function Mo(t,n){var e,i;function r(){var o=n.apply(this,arguments);return o!==i&&(e=(i=o)&&ko(t,o)),e}return r._value=n,r}function zo(t,n){var e="attr."+t;if(arguments.length<2)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;var i=Dt(t);return this.tween(e,(i.local?No:Mo)(i,n))}function Bo(t,n){return function(){fe(this,t).delay=+n.apply(this,arguments)}}function To(t,n){return n=+n,function(){fe(this,t).delay=n}}function Ao(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Bo:To)(n,t)):F(this.node(),n).delay}function Ro(t,n){return function(){W(this,t).duration=+n.apply(this,arguments)}}function Xo(t,n){return n=+n,function(){W(this,t).duration=n}}function Lo(t){var n=this._id;return arguments.length?this.each((typeof t=="function"?Ro:Xo)(n,t)):F(this.node(),n).duration}function Do(t,n){if(typeof n!="function")throw new Error;return function(){W(this,t).ease=n}}function Io(t){var n=this._id;return arguments.length?this.each(Do(n,t)):F(this.node(),n).ease}function Yo(t,n){return function(){var e=n.apply(this,arguments);if(typeof e!="function")throw new Error;W(this,t).ease=e}}function Ho(t){if(typeof t!="function")throw new Error;return this.each(Yo(this._id,t))}function Po(t){typeof t!="function"&&(t=He(t));for(var n=this._groups,e=n.length,i=new Array(e),r=0;r<e;++r)for(var o=n[r],s=o.length,a=i[r]=[],u,l=0;l<s;++l)(u=o[l])&&t.call(u,u.__data__,l,o)&&a.push(u);return new K(i,this._parents,this._name,this._id)}function Fo(t){if(t._id!==this._id)throw new Error;for(var n=this._groups,e=t._groups,i=n.length,r=e.length,o=Math.min(i,r),s=new Array(i),a=0;a<o;++a)for(var u=n[a],l=e[a],c=u.length,f=s[a]=new Array(c),d,p=0;p<c;++p)(d=u[p]||l[p])&&(f[p]=d);for(;a<i;++a)s[a]=n[a];return new K(s,this._parents,this._name,this._id)}function Oo(t){return(t+"").trim().split(/^|\s+/).every(function(n){var e=n.indexOf(".");return e>=0&&(n=n.slice(0,e)),!n||n==="start"})}function qo(t,n,e){var i,r,o=Oo(n)?fe:W;return function(){var s=o(this,t),a=s.on;a!==i&&(r=(i=a).copy()).on(n,e),s.on=r}}function Wo(t,n){var e=this._id;return arguments.length<2?F(this.node(),e).on.on(t):this.each(qo(e,t,n))}function Vo(t){return function(){var n=this.parentNode;for(var e in this.__transition)if(+e!==t)return;n&&n.removeChild(this)}}function Uo(){return this.on("end.remove",Vo(this._id))}function Jo(t){var n=this._name,e=this._id;typeof t!="function"&&(t=se(t));for(var i=this._groups,r=i.length,o=new Array(r),s=0;s<r;++s)for(var a=i[s],u=a.length,l=o[s]=new Array(u),c,f,d=0;d<u;++d)(c=a[d])&&(f=t.call(c,c.__data__,d,a))&&("__data__"in c&&(f.__data__=c.__data__),l[d]=f,Yt(l[d],n,e,d,l,F(c,e)));return new K(o,this._parents,n,e)}function Go(t){var n=this._name,e=this._id;typeof t!="function"&&(t=Ye(t));for(var i=this._groups,r=i.length,o=[],s=[],a=0;a<r;++a)for(var u=i[a],l=u.length,c,f=0;f<l;++f)if(c=u[f]){for(var d=t.call(c,c.__data__,f,u),p,x=F(c,e),y=0,C=d.length;y<C;++y)(p=d[y])&&Yt(p,n,e,y,d,x);o.push(d),s.push(c)}return new K(o,s,n,e)}var Zo=lt.prototype.constructor;function Ko(){return new Zo(this._groups,this._parents)}function Qo(t,n){var e,i,r;return function(){var o=ot(this,t),s=(this.style.removeProperty(t),ot(this,t));return o===s?null:o===e&&s===i?r:r=n(e=o,i=s)}}function un(t){return function(){this.style.removeProperty(t)}}function jo(t,n,e){var i,r=e+"",o;return function(){var s=ot(this,t);return s===r?null:s===i?o:o=n(i=s,e)}}function ta(t,n,e){var i,r,o;return function(){var s=ot(this,t),a=e(this),u=a+"";return a==null&&(u=a=(this.style.removeProperty(t),ot(this,t))),s===u?null:s===i&&u===r?o:(r=u,o=n(i=s,a))}}function ea(t,n){var e,i,r,o="style."+n,s="end."+o,a;return function(){var u=W(this,t),l=u.on,c=u.value[o]==null?a||(a=un(n)):void 0;(l!==e||r!==c)&&(i=(e=l).copy()).on(s,r=c),u.on=i}}function na(t,n,e){var i=(t+="")=="transform"?eo:cn;return n==null?this.styleTween(t,Qo(t,i)).on("end.style."+t,un(t)):typeof n=="function"?this.styleTween(t,ta(t,i,de(this,"style."+t,n))).each(ea(this._id,t)):this.styleTween(t,jo(t,i,n),e).on("end.style."+t,null)}function ia(t,n,e){return function(i){this.style.setProperty(t,n.call(this,i),e)}}function ra(t,n,e){var i,r;function o(){var s=n.apply(this,arguments);return s!==r&&(i=(r=s)&&ia(t,s,e)),i}return o._value=n,o}function oa(t,n,e){var i="style."+(t+="");if(arguments.length<2)return(i=this.tween(i))&&i._value;if(n==null)return this.tween(i,null);if(typeof n!="function")throw new Error;return this.tween(i,ra(t,n,e??""))}function aa(t){return function(){this.textContent=t}}function sa(t){return function(){var n=t(this);this.textContent=n??""}}function la(t){return this.tween("text",typeof t=="function"?sa(de(this,"text",t)):aa(t==null?"":t+""))}function ca(t){return function(n){this.textContent=t.call(this,n)}}function ua(t){var n,e;function i(){var r=t.apply(this,arguments);return r!==e&&(n=(e=r)&&ca(r)),n}return i._value=t,i}function ha(t){var n="text";if(arguments.length<1)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;return this.tween(n,ua(t))}function fa(){for(var t=this._name,n=this._id,e=hn(),i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,u,l=0;l<a;++l)if(u=s[l]){var c=F(u,n);Yt(u,t,e,l,s,{time:c.time+c.delay+c.duration,delay:0,duration:c.duration,ease:c.ease})}return new K(i,this._parents,t,e)}function da(){var t,n,e=this,i=e._id,r=e.size();return new Promise(function(o,s){var a={value:s},u={value:function(){--r===0&&o()}};e.each(function(){var l=W(this,i),c=l.on;c!==t&&(n=(t=c).copy(),n._.cancel.push(a),n._.interrupt.push(a),n._.end.push(u)),l.on=n}),r===0&&o()})}var pa=0;function K(t,n,e,i){this._groups=t,this._parents=n,this._name=e,this._id=i}function hn(){return++pa}var G=lt.prototype;K.prototype={constructor:K,select:Jo,selectAll:Go,selectChild:G.selectChild,selectChildren:G.selectChildren,filter:Po,merge:Fo,selection:Ko,transition:fa,call:G.call,nodes:G.nodes,node:G.node,size:G.size,empty:G.empty,each:G.each,on:Wo,attr:Eo,attrTween:zo,style:na,styleTween:oa,text:la,textTween:ha,remove:Uo,tween:xo,delay:Ao,duration:Lo,ease:Io,easeVarying:Ho,end:da,[Symbol.iterator]:G[Symbol.iterator]};function ga(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var ma={time:null,delay:0,duration:250,ease:ga};function ya(t,n){for(var e;!(e=t.__transition)||!(e=e[n]);)if(!(t=t.parentNode))throw new Error(`transition ${n} not found`);return e}function xa(t){var n,e;t instanceof K?(n=t._id,t=t._name):(n=hn(),(e=ma).time=he(),t=t==null?null:t+"");for(var i=this._groups,r=i.length,o=0;o<r;++o)for(var s=i[o],a=s.length,u,l=0;l<a;++l)(u=s[l])&&Yt(u,t,n,l,s,e||ya(u,n));return new K(i,this._parents,t,n)}lt.prototype.interrupt=go;lt.prototype.transition=xa;const $t=t=>()=>t;function _a(t,{sourceEvent:n,target:e,transform:i,dispatch:r}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:n,enumerable:!0,configurable:!0},target:{value:e,enumerable:!0,configurable:!0},transform:{value:i,enumerable:!0,configurable:!0},_:{value:r}})}function Z(t,n,e){this.k=t,this.x=n,this.y=e}Z.prototype={constructor:Z,scale:function(t){return t===1?this:new Z(this.k*t,this.x,this.y)},translate:function(t,n){return t===0&n===0?this:new Z(this.k,this.x+this.k*t,this.y+this.k*n)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var pe=new Z(1,0,0);Z.prototype;function Jt(t){t.stopImmediatePropagation()}function ft(t){t.preventDefault(),t.stopImmediatePropagation()}function wa(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function va(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function Le(){return this.__zoom||pe}function Ca(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function ba(){return navigator.maxTouchPoints||"ontouchstart"in this}function $a(t,n,e){var i=t.invertX(n[0][0])-e[0][0],r=t.invertX(n[1][0])-e[1][0],o=t.invertY(n[0][1])-e[0][1],s=t.invertY(n[1][1])-e[1][1];return t.translate(r>i?(i+r)/2:Math.min(0,i)||Math.max(0,r),s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s))}function Ea(){var t=wa,n=va,e=$a,i=Ca,r=ba,o=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,u=ao,l=ce("start","zoom","end"),c,f,d,p=500,x=150,y=0,C=10;function _(g){g.property("__zoom",Le).on("wheel.zoom",V,{passive:!1}).on("mousedown.zoom",D).on("dblclick.zoom",ct).filter(r).on("touchstart.zoom",wt).on("touchmove.zoom",ut).on("touchend.zoom touchcancel.zoom",Ht).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(g,h,m,w){var v=g.selection?g.selection():g;v.property("__zoom",Le),g!==v?z(g,h,m,w):v.interrupt().each(function(){A(this,arguments).event(w).start().zoom(null,typeof h=="function"?h.apply(this,arguments):h).end()})},_.scaleBy=function(g,h,m,w){_.scaleTo(g,function(){var v=this.__zoom.k,b=typeof h=="function"?h.apply(this,arguments):h;return v*b},m,w)},_.scaleTo=function(g,h,m,w){_.transform(g,function(){var v=n.apply(this,arguments),b=this.__zoom,E=m==null?k(v):typeof m=="function"?m.apply(this,arguments):m,N=b.invert(E),B=typeof h=="function"?h.apply(this,arguments):h;return e(S($(b,B),E,N),v,s)},m,w)},_.translateBy=function(g,h,m,w){_.transform(g,function(){return e(this.__zoom.translate(typeof h=="function"?h.apply(this,arguments):h,typeof m=="function"?m.apply(this,arguments):m),n.apply(this,arguments),s)},null,w)},_.translateTo=function(g,h,m,w,v){_.transform(g,function(){var b=n.apply(this,arguments),E=this.__zoom,N=w==null?k(b):typeof w=="function"?w.apply(this,arguments):w;return e(pe.translate(N[0],N[1]).scale(E.k).translate(typeof h=="function"?-h.apply(this,arguments):-h,typeof m=="function"?-m.apply(this,arguments):-m),b,s)},w,v)};function $(g,h){return h=Math.max(o[0],Math.min(o[1],h)),h===g.k?g:new Z(h,g.x,g.y)}function S(g,h,m){var w=h[0]-m[0]*g.k,v=h[1]-m[1]*g.k;return w===g.x&&v===g.y?g:new Z(g.k,w,v)}function k(g){return[(+g[0][0]+ +g[1][0])/2,(+g[0][1]+ +g[1][1])/2]}function z(g,h,m,w){g.on("start.zoom",function(){A(this,arguments).event(w).start()}).on("interrupt.zoom end.zoom",function(){A(this,arguments).event(w).end()}).tween("zoom",function(){var v=this,b=arguments,E=A(v,b).event(w),N=n.apply(v,b),B=m==null?k(N):typeof m=="function"?m.apply(v,b):m,O=Math.max(N[1][0]-N[0][0],N[1][1]-N[0][1]),T=v.__zoom,I=typeof h=="function"?h.apply(v,b):h,U=u(T.invert(B).concat(O/T.k),I.invert(B).concat(O/I.k));return function(Y){if(Y===1)Y=I;else{var J=U(Y),Pt=O/J[2];Y=new Z(Pt,B[0]-J[0]*Pt,B[1]-J[1]*Pt)}E.zoom(null,Y)}})}function A(g,h,m){return!m&&g.__zooming||new R(g,h)}function R(g,h){this.that=g,this.args=h,this.active=0,this.sourceEvent=null,this.extent=n.apply(g,h),this.taps=0}R.prototype={event:function(g){return g&&(this.sourceEvent=g),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(g,h){return this.mouse&&g!=="mouse"&&(this.mouse[1]=h.invert(this.mouse[0])),this.touch0&&g!=="touch"&&(this.touch0[1]=h.invert(this.touch0[0])),this.touch1&&g!=="touch"&&(this.touch1[1]=h.invert(this.touch1[0])),this.that.__zoom=h,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(g){var h=H(this.that).datum();l.call(g,this.that,new _a(g,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:l}),h)}};function V(g,...h){if(!t.apply(this,arguments))return;var m=A(this,h).event(g),w=this.__zoom,v=Math.max(o[0],Math.min(o[1],w.k*Math.pow(2,i.apply(this,arguments)))),b=j(g);if(m.wheel)(m.mouse[0][0]!==b[0]||m.mouse[0][1]!==b[1])&&(m.mouse[1]=w.invert(m.mouse[0]=b)),clearTimeout(m.wheel);else{if(w.k===v)return;m.mouse=[b,w.invert(b)],Mt(this),m.start()}ft(g),m.wheel=setTimeout(E,x),m.zoom("mouse",e(S($(w,v),m.mouse[0],m.mouse[1]),m.extent,s));function E(){m.wheel=null,m.end()}}function D(g,...h){if(d||!t.apply(this,arguments))return;var m=g.currentTarget,w=A(this,h,!0).event(g),v=H(g.view).on("mousemove.zoom",B,!0).on("mouseup.zoom",O,!0),b=j(g,m),E=g.clientX,N=g.clientY;Ar(g.view),Jt(g),w.mouse=[b,this.__zoom.invert(b)],Mt(this),w.start();function B(T){if(ft(T),!w.moved){var I=T.clientX-E,U=T.clientY-N;w.moved=I*I+U*U>y}w.event(T).zoom("mouse",e(S(w.that.__zoom,w.mouse[0]=j(T,m),w.mouse[1]),w.extent,s))}function O(T){v.on("mousemove.zoom mouseup.zoom",null),Rr(T.view,w.moved),ft(T),w.event(T).end()}}function ct(g,...h){if(t.apply(this,arguments)){var m=this.__zoom,w=j(g.changedTouches?g.changedTouches[0]:g,this),v=m.invert(w),b=m.k*(g.shiftKey?.5:2),E=e(S($(m,b),w,v),n.apply(this,h),s);ft(g),a>0?H(this).transition().duration(a).call(z,E,w,g):H(this).call(_.transform,E,w,g)}}function wt(g,...h){if(t.apply(this,arguments)){var m=g.touches,w=m.length,v=A(this,h,g.changedTouches.length===w).event(g),b,E,N,B;for(Jt(g),E=0;E<w;++E)N=m[E],B=j(N,this),B=[B,this.__zoom.invert(B),N.identifier],v.touch0?!v.touch1&&v.touch0[2]!==B[2]&&(v.touch1=B,v.taps=0):(v.touch0=B,b=!0,v.taps=1+!!c);c&&(c=clearTimeout(c)),b&&(v.taps<2&&(f=B[0],c=setTimeout(function(){c=null},p)),Mt(this),v.start())}}function ut(g,...h){if(this.__zooming){var m=A(this,h).event(g),w=g.changedTouches,v=w.length,b,E,N,B;for(ft(g),b=0;b<v;++b)E=w[b],N=j(E,this),m.touch0&&m.touch0[2]===E.identifier?m.touch0[0]=N:m.touch1&&m.touch1[2]===E.identifier&&(m.touch1[0]=N);if(E=m.that.__zoom,m.touch1){var O=m.touch0[0],T=m.touch0[1],I=m.touch1[0],U=m.touch1[1],Y=(Y=I[0]-O[0])*Y+(Y=I[1]-O[1])*Y,J=(J=U[0]-T[0])*J+(J=U[1]-T[1])*J;E=$(E,Math.sqrt(Y/J)),N=[(O[0]+I[0])/2,(O[1]+I[1])/2],B=[(T[0]+U[0])/2,(T[1]+U[1])/2]}else if(m.touch0)N=m.touch0[0],B=m.touch0[1];else return;m.zoom("touch",e(S(E,N,B),m.extent,s))}}function Ht(g,...h){if(this.__zooming){var m=A(this,h).event(g),w=g.changedTouches,v=w.length,b,E;for(Jt(g),d&&clearTimeout(d),d=setTimeout(function(){d=null},p),b=0;b<v;++b)E=w[b],m.touch0&&m.touch0[2]===E.identifier?delete m.touch0:m.touch1&&m.touch1[2]===E.identifier&&delete m.touch1;if(m.touch1&&!m.touch0&&(m.touch0=m.touch1,delete m.touch1),m.touch0)m.touch0[1]=this.__zoom.invert(m.touch0[0]);else if(m.end(),m.taps===2&&(E=j(E,this),Math.hypot(f[0]-E[0],f[1]-E[1])<C)){var N=H(this).on("dblclick.zoom");N&&N.apply(this,arguments)}}}return _.wheelDelta=function(g){return arguments.length?(i=typeof g=="function"?g:$t(+g),_):i},_.filter=function(g){return arguments.length?(t=typeof g=="function"?g:$t(!!g),_):t},_.touchable=function(g){return arguments.length?(r=typeof g=="function"?g:$t(!!g),_):r},_.extent=function(g){return arguments.length?(n=typeof g=="function"?g:$t([[+g[0][0],+g[0][1]],[+g[1][0],+g[1][1]]]),_):n},_.scaleExtent=function(g){return arguments.length?(o[0]=+g[0],o[1]=+g[1],_):[o[0],o[1]]},_.translateExtent=function(g){return arguments.length?(s[0][0]=+g[0][0],s[1][0]=+g[1][0],s[0][1]=+g[0][1],s[1][1]=+g[1][1],_):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},_.constrain=function(g){return arguments.length?(e=g,_):e},_.duration=function(g){return arguments.length?(a=+g,_):a},_.interpolate=function(g){return arguments.length?(u=g,_):u},_.on=function(){var g=l.on.apply(l,arguments);return g===l?_:g},_.clickDistance=function(g){return arguments.length?(y=(g=+g)*g,_):Math.sqrt(y)},_.tapDistance=function(g){return arguments.length?(C=+g,_):C},_}function ka(t){var n=0,e=t.children,i=e&&e.length;if(!i)n=1;else for(;--i>=0;)n+=e[i].value;t.value=n}function Sa(){return this.eachAfter(ka)}function Na(t){var n=this,e,i=[n],r,o,s;do for(e=i.reverse(),i=[];n=e.pop();)if(t(n),r=n.children,r)for(o=0,s=r.length;o<s;++o)i.push(r[o]);while(i.length);return this}function Ma(t){for(var n=this,e=[n],i,r;n=e.pop();)if(t(n),i=n.children,i)for(r=i.length-1;r>=0;--r)e.push(i[r]);return this}function za(t){for(var n=this,e=[n],i=[],r,o,s;n=e.pop();)if(i.push(n),r=n.children,r)for(o=0,s=r.length;o<s;++o)e.push(r[o]);for(;n=i.pop();)t(n);return this}function Ba(t){return this.eachAfter(function(n){for(var e=+t(n.data)||0,i=n.children,r=i&&i.length;--r>=0;)e+=i[r].value;n.value=e})}function Ta(t){return this.eachBefore(function(n){n.children&&n.children.sort(t)})}function Aa(t){for(var n=this,e=Ra(n,t),i=[n];n!==e;)n=n.parent,i.push(n);for(var r=i.length;t!==e;)i.splice(r,0,t),t=t.parent;return i}function Ra(t,n){if(t===n)return t;var e=t.ancestors(),i=n.ancestors(),r=null;for(t=e.pop(),n=i.pop();t===n;)r=t,t=e.pop(),n=i.pop();return r}function Xa(){for(var t=this,n=[t];t=t.parent;)n.push(t);return n}function La(){var t=[];return this.each(function(n){t.push(n)}),t}function Da(){var t=[];return this.eachBefore(function(n){n.children||t.push(n)}),t}function Ia(){var t=this,n=[];return t.each(function(e){e!==t&&n.push({source:e.parent,target:e})}),n}function ge(t,n){var e=new Lt(t),i=+t.value&&(e.value=t.value),r,o=[e],s,a,u,l;for(n==null&&(n=Ha);r=o.pop();)if(i&&(r.value=+r.data.value),(a=n(r.data))&&(l=a.length))for(r.children=new Array(l),u=l-1;u>=0;--u)o.push(s=r.children[u]=new Lt(a[u])),s.parent=r,s.depth=r.depth+1;return e.eachBefore(Fa)}function Ya(){return ge(this).eachBefore(Pa)}function Ha(t){return t.children}function Pa(t){t.data=t.data.data}function Fa(t){var n=0;do t.height=n;while((t=t.parent)&&t.height<++n)}function Lt(t){this.data=t,this.depth=this.height=0,this.parent=null}Lt.prototype=ge.prototype={constructor:Lt,count:Sa,each:Na,eachAfter:za,eachBefore:Ma,sum:Ba,sort:Ta,path:Aa,ancestors:Xa,descendants:La,leaves:Da,links:Ia,copy:Ya};const Oa="2.1.2",qa={version:Oa},{version:Wa}=qa,Va=Object.freeze({children:t=>t.children,nodeSize:t=>t.data.size,spacing:0});function me(t){const n=Object.assign({},Va,t);function e(a){const u=n[a];return typeof u=="function"?u:()=>u}function i(a){const u=s(o(),a,l=>l.children);return u.update(),u.data}function r(){const a=e("nodeSize"),u=e("spacing");return class fn extends ge.prototype.constructor{constructor(c){super(c)}copy(){const c=s(this.constructor,this,f=>f.children);return c.each(f=>f.data=f.data.data),c}get size(){return a(this)}spacing(c){return u(this,c)}get nodes(){return this.descendants()}get xSize(){return this.size[0]}get ySize(){return this.size[1]}get top(){return this.y}get bottom(){return this.y+this.ySize}get left(){return this.x-this.xSize/2}get right(){return this.x+this.xSize/2}get root(){const c=this.ancestors();return c[c.length-1]}get numChildren(){return this.hasChildren?this.children.length:0}get hasChildren(){return!this.noChildren}get noChildren(){return this.children===null}get firstChild(){return this.hasChildren?this.children[0]:null}get lastChild(){return this.hasChildren?this.children[this.numChildren-1]:null}get extents(){return(this.children||[]).reduce((c,f)=>fn.maxExtents(c,f.extents),this.nodeExtents)}get nodeExtents(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}static maxExtents(c,f){return{top:Math.min(c.top,f.top),bottom:Math.max(c.bottom,f.bottom),left:Math.min(c.left,f.left),right:Math.max(c.right,f.right)}}}}function o(){const a=r(),u=e("nodeSize"),l=e("spacing");return class extends a{constructor(c){super(c),Object.assign(this,{x:0,y:0,relX:0,prelim:0,shift:0,change:0,lExt:this,lExtRelX:0,lThr:null,rExt:this,rExtRelX:0,rThr:null})}get size(){return u(this.data)}spacing(c){return l(this.data,c.data)}get x(){return this.data.x}set x(c){this.data.x=c}get y(){return this.data.y}set y(c){this.data.y=c}update(){return dn(this),pn(this),this}}}function s(a,u,l){const c=(f,d)=>{const p=new a(f);Object.assign(p,{parent:d,depth:d===null?0:d.depth+1,height:0,length:1});const x=l(f)||[];return p.children=x.length===0?null:x.map(y=>c(y,p)),p.children&&Object.assign(p,p.children.reduce((y,C)=>({height:Math.max(y.height,C.height+1),length:y.length+C.length}),p)),p};return c(u,null)}return Object.assign(i,{nodeSize(a){return arguments.length?(n.nodeSize=a,i):n.nodeSize},spacing(a){return arguments.length?(n.spacing=a,i):n.spacing},children(a){return arguments.length?(n.children=a,i):n.children},hierarchy(a,u){const l=typeof u>"u"?n.children:u;return s(r(),a,l)},dump(a){const u=e("nodeSize"),l=c=>f=>{const d=c+"  ",p=c+"    ",{x,y}=f,C=u(f),_=f.children||[],$=_.length===0?" ":`,${d}children: [${p}${_.map(l(p)).join(p)}${d}],${c}`;return`{ size: [${C.join(", ")}],${d}x: ${x}, y: ${y}${$}},`};return l(`
`)(a)}}),i}me.version=Wa;const dn=(t,n=0)=>(t.y=n,(t.children||[]).reduce((e,i)=>{const[r,o]=e;dn(i,t.y+t.ySize);const s=(r===0?i.lExt:i.rExt).bottom;r!==0&&Ja(t,r,o);const a=ns(s,r,o);return[r+1,a]},[0,null]),Ua(t),es(t),t),pn=(t,n,e)=>{typeof n>"u"&&(n=-t.relX-t.prelim,e=0);const i=n+t.relX;return t.relX=i+t.prelim-e,t.prelim=0,t.x=e+t.relX,(t.children||[]).forEach(r=>pn(r,i,t.x)),t},Ua=t=>{(t.children||[]).reduce((n,e)=>{const[i,r]=n,o=i+e.shift,s=r+o+e.change;return e.relX+=s,[o,s]},[0,0])},Ja=(t,n,e)=>{const i=t.children[n-1],r=t.children[n];let o=i,s=i.relX,a=r,u=r.relX,l=!0;for(;o&&a;){o.bottom>e.lowY&&(e=e.next);const c=s+o.prelim-(u+a.prelim)+o.xSize/2+a.xSize/2+o.spacing(a);(c>0||c<0&&l)&&(u+=c,Ga(r,c),Za(t,n,e.index,c)),l=!1;const f=o.bottom,d=a.bottom;f<=d&&(o=Qa(o),o&&(s+=o.relX)),f>=d&&(a=Ka(a),a&&(u+=a.relX))}!o&&a?ja(t,n,a,u):o&&!a&&ts(t,n,o,s)},Ga=(t,n)=>{t.relX+=n,t.lExtRelX+=n,t.rExtRelX+=n},Za=(t,n,e,i)=>{const r=t.children[n],o=n-e;if(o>1){const s=i/o;t.children[e+1].shift+=s,r.shift-=s,r.change-=i-s}},Ka=t=>t.hasChildren?t.firstChild:t.lThr,Qa=t=>t.hasChildren?t.lastChild:t.rThr,ja=(t,n,e,i)=>{const r=t.firstChild,o=r.lExt,s=t.children[n];o.lThr=e;const a=i-e.relX-r.lExtRelX;o.relX+=a,o.prelim-=a,r.lExt=s.lExt,r.lExtRelX=s.lExtRelX},ts=(t,n,e,i)=>{const r=t.children[n],o=r.rExt,s=t.children[n-1];o.rThr=e;const a=i-e.relX-r.rExtRelX;o.relX+=a,o.prelim-=a,r.rExt=s.rExt,r.rExtRelX=s.rExtRelX},es=t=>{if(t.hasChildren){const n=t.firstChild,e=t.lastChild,i=(n.prelim+n.relX-n.xSize/2+e.relX+e.prelim+e.xSize/2)/2;Object.assign(t,{prelim:i,lExt:n.lExt,lExtRelX:n.lExtRelX,rExt:e.rExt,rExtRelX:e.rExtRelX})}},ns=(t,n,e)=>{for(;e!==null&&t>=e.lowY;)e=e.next;return{lowY:t,index:n,next:e}};function De(t){return function(){return t}}const oe=Math.PI,ae=2*oe,tt=1e-6,is=ae-tt;function gn(t){this._+=t[0];for(let n=1,e=t.length;n<e;++n)this._+=arguments[n]+t[n]}function rs(t){let n=Math.floor(t);if(!(n>=0))throw new Error(`invalid digits: ${t}`);if(n>15)return gn;const e=10**n;return function(i){this._+=i[0];for(let r=1,o=i.length;r<o;++r)this._+=Math.round(arguments[r]*e)/e+i[r]}}class os{constructor(n){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=n==null?gn:rs(n)}moveTo(n,e){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+e}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(n,e){this._append`L${this._x1=+n},${this._y1=+e}`}quadraticCurveTo(n,e,i,r){this._append`Q${+n},${+e},${this._x1=+i},${this._y1=+r}`}bezierCurveTo(n,e,i,r,o,s){this._append`C${+n},${+e},${+i},${+r},${this._x1=+o},${this._y1=+s}`}arcTo(n,e,i,r,o){if(n=+n,e=+e,i=+i,r=+r,o=+o,o<0)throw new Error(`negative radius: ${o}`);let s=this._x1,a=this._y1,u=i-n,l=r-e,c=s-n,f=a-e,d=c*c+f*f;if(this._x1===null)this._append`M${this._x1=n},${this._y1=e}`;else if(d>tt)if(!(Math.abs(f*u-l*c)>tt)||!o)this._append`L${this._x1=n},${this._y1=e}`;else{let p=i-s,x=r-a,y=u*u+l*l,C=p*p+x*x,_=Math.sqrt(y),$=Math.sqrt(d),S=o*Math.tan((oe-Math.acos((y+d-C)/(2*_*$)))/2),k=S/$,z=S/_;Math.abs(k-1)>tt&&this._append`L${n+k*c},${e+k*f}`,this._append`A${o},${o},0,0,${+(f*p>c*x)},${this._x1=n+z*u},${this._y1=e+z*l}`}}arc(n,e,i,r,o,s){if(n=+n,e=+e,i=+i,s=!!s,i<0)throw new Error(`negative radius: ${i}`);let a=i*Math.cos(r),u=i*Math.sin(r),l=n+a,c=e+u,f=1^s,d=s?r-o:o-r;this._x1===null?this._append`M${l},${c}`:(Math.abs(this._x1-l)>tt||Math.abs(this._y1-c)>tt)&&this._append`L${l},${c}`,i&&(d<0&&(d=d%ae+ae),d>is?this._append`A${i},${i},0,1,${f},${n-a},${e-u}A${i},${i},0,1,${f},${this._x1=l},${this._y1=c}`:d>tt&&this._append`A${i},${i},0,${+(d>=oe)},${f},${this._x1=n+i*Math.cos(o)},${this._y1=e+i*Math.sin(o)}`)}rect(n,e,i,r){this._append`M${this._x0=this._x1=+n},${this._y0=this._y1=+e}h${i=+i}v${+r}h${-i}Z`}toString(){return this._}}function as(t){let n=3;return t.digits=function(e){if(!arguments.length)return n;if(e==null)n=null;else{const i=Math.floor(e);if(!(i>=0))throw new RangeError(`invalid digits: ${e}`);n=i}return t},()=>new os(n)}var ss=Array.prototype.slice;function ls(t){return t[0]}function cs(t){return t[1]}class us{constructor(n,e){this._context=n,this._x=e}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(n,e){switch(n=+n,e=+e,this._point){case 0:{this._point=1,this._line?this._context.lineTo(n,e):this._context.moveTo(n,e);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+n)/2,this._y0,this._x0,e,n,e):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+e)/2,n,this._y0,n,e);break}}this._x0=n,this._y0=e}}function hs(t){return new us(t,!0)}function fs(t){return t.source}function ds(t){return t.target}function ps(t){let n=fs,e=ds,i=ls,r=cs,o=null,s=null,a=as(u);function u(){let l;const c=ss.call(arguments),f=n.apply(this,c),d=e.apply(this,c);if(o==null&&(s=t(l=a())),s.lineStart(),c[0]=f,s.point(+i.apply(this,c),+r.apply(this,c)),c[0]=d,s.point(+i.apply(this,c),+r.apply(this,c)),s.lineEnd(),l)return s=null,l+""||null}return u.source=function(l){return arguments.length?(n=l,u):n},u.target=function(l){return arguments.length?(e=l,u):e},u.x=function(l){return arguments.length?(i=typeof l=="function"?l:De(+l),u):i},u.y=function(l){return arguments.length?(r=typeof l=="function"?l:De(+l),u):r},u.context=function(l){return arguments.length?(l==null?o=s=null:s=t(o=l),u):o},u}function gs(){return ps(hs)}const M={selection:lt,select:H,max:Zi,min:Ki,sum:Qi,cumsum:Gi,tree:Mr,stratify:Cr,zoom:Ea,zoomIdentity:pe,linkHorizontal:gs,flextree:me};class ms{constructor(){const n={id:`ID${Math.floor(Math.random()*1e6)}`,firstDraw:!0,ctx:document.createElement("canvas").getContext("2d"),initialExpandLevel:1,nodeDefaultBackground:"none",lastTransform:{x:0,y:0,k:1},allowedNodesCount:{},zoomBehavior:null,generateRoot:null,svgWidth:800,svgHeight:window.innerHeight-100,container:"body",data:null,connections:[],defaultFont:"Helvetica",nodeId:e=>e.nodeId||e.id,parentNodeId:e=>e.parentNodeId||e.parentId,rootMargin:40,nodeWidth:e=>250,nodeHeight:e=>150,neighbourMargin:(e,i)=>80,siblingsMargin:e=>20,childrenMargin:e=>60,compactMarginPair:e=>100,compactMarginBetween:e=>20,nodeButtonWidth:e=>40,nodeButtonHeight:e=>40,nodeButtonX:e=>-20,nodeButtonY:e=>-20,linkYOffset:30,pagingStep:e=>5,minPagingVisibleNodes:e=>2e3,scaleExtent:[.001,20],duration:400,imageName:"Chart",setActiveNodeCentered:!0,layout:"top",compact:!0,createZoom:e=>M.zoom(),onZoomStart:e=>{},onZoom:e=>{},onZoomEnd:e=>{},onNodeClick:e=>e,onExpandOrCollapse:e=>e,nodeContent:e=>`<div style="padding:5px;font-size:10px;">Sample Node(id=${e.id}), override using <br/> 
            <code>chart.nodeContent({data}=>{ <br/>
             &nbsp;&nbsp;&nbsp;&nbsp;return '' // Custom HTML <br/>
             })</code>
             <br/> 
             Or check different <a href="https://github.com/bumbeishvili/org-chart#jump-to-examples" target="_blank">layout examples</a>
             </div>`,buttonContent:({node:e,state:i})=>`<div style="border:1px solid #E4E2E9;border-radius:3px;padding:3px;font-size:9px;margin:auto auto;background-color:white"> ${{left:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                          <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                          </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`,bottom:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${e.data._directSubordinatesPaging} </span></div>
                       `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="margin-left:1px;color:#716E7B" >${e.data._directSubordinatesPaging} </span></div>
                    `,right:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M7.989 3.49944C7.85817 3.63339 7.78492 3.8132 7.78492 4.00044C7.78492 4.18768 7.85817 4.36749 7.989 4.50144L15.2985 11.9999L7.989 19.4969C7.85817 19.6309 7.78492 19.8107 7.78492 19.9979C7.78492 20.1852 7.85817 20.365 7.989 20.4989C8.05259 20.5643 8.12863 20.6162 8.21261 20.6516C8.2966 20.6871 8.38684 20.7053 8.478 20.7053C8.56916 20.7053 8.6594 20.6871 8.74338 20.6516C8.82737 20.6162 8.90341 20.5643 8.967 20.4989L16.74 12.5234C16.8765 12.3834 16.9529 12.1955 16.9529 11.9999C16.9529 11.8044 16.8765 11.6165 16.74 11.4764L8.967 3.50094C8.90341 3.43563 8.82737 3.38371 8.74338 3.34827C8.6594 3.31282 8.56916 3.29456 8.478 3.29456C8.38684 3.29456 8.2966 3.31282 8.21261 3.34827C8.12863 3.38371 8.05259 3.43563 7.989 3.50094V3.49944Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                       <path d="M14.283 3.50094L6.51 11.4749C6.37348 11.615 6.29707 11.8029 6.29707 11.9984C6.29707 12.194 6.37348 12.3819 6.51 12.5219L14.283 20.4989C14.3466 20.5643 14.4226 20.6162 14.5066 20.6516C14.5906 20.6871 14.6808 20.7053 14.772 20.7053C14.8632 20.7053 14.9534 20.6871 15.0374 20.6516C15.1214 20.6162 15.1974 20.5643 15.261 20.4989C15.3918 20.365 15.4651 20.1852 15.4651 19.9979C15.4651 19.8107 15.3918 19.6309 15.261 19.4969L7.9515 11.9984L15.261 4.50144C15.3914 4.36756 15.4643 4.18807 15.4643 4.00119C15.4643 3.81431 15.3914 3.63482 15.261 3.50094C15.1974 3.43563 15.1214 3.38371 15.0374 3.34827C14.9534 3.31282 14.8632 3.29456 14.772 3.29456C14.6808 3.29456 14.5906 3.31282 14.5066 3.34827C14.4226 3.38371 14.3466 3.43563 14.283 3.50094V3.50094Z" fill="#716E7B" stroke="#716E7B"/>
                       </svg></span><span style="color:#716E7B">${e.data._directSubordinatesPaging} </span></div>`,top:o=>o?`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11.457 8.07005L3.49199 16.4296C3.35903 16.569 3.28485 16.7543 3.28485 16.9471C3.28485 17.1398 3.35903 17.3251 3.49199 17.4646L3.50099 17.4736C3.56545 17.5414 3.64304 17.5954 3.72904 17.6324C3.81504 17.6693 3.90765 17.6883 4.00124 17.6883C4.09483 17.6883 4.18745 17.6693 4.27344 17.6324C4.35944 17.5954 4.43703 17.5414 4.50149 17.4736L12.0015 9.60155L19.4985 17.4736C19.563 17.5414 19.6405 17.5954 19.7265 17.6324C19.8125 17.6693 19.9052 17.6883 19.9987 17.6883C20.0923 17.6883 20.1849 17.6693 20.2709 17.6324C20.3569 17.5954 20.4345 17.5414 20.499 17.4736L20.508 17.4646C20.641 17.3251 20.7151 17.1398 20.7151 16.9471C20.7151 16.7543 20.641 16.569 20.508 16.4296L12.543 8.07005C12.4729 7.99653 12.3887 7.93801 12.2954 7.89801C12.202 7.85802 12.1015 7.8374 12 7.8374C11.8984 7.8374 11.798 7.85802 11.7046 7.89801C11.6113 7.93801 11.527 7.99653 11.457 8.07005Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${e.data._directSubordinatesPaging} </span></div>
                        `:`<div style="display:flex;"><span style="align-items:center;display:flex;"><svg width="8" height="8" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M19.497 7.98903L12 15.297L4.503 7.98903C4.36905 7.85819 4.18924 7.78495 4.002 7.78495C3.81476 7.78495 3.63495 7.85819 3.501 7.98903C3.43614 8.05257 3.38462 8.12842 3.34944 8.21213C3.31427 8.29584 3.29615 8.38573 3.29615 8.47653C3.29615 8.56733 3.31427 8.65721 3.34944 8.74092C3.38462 8.82463 3.43614 8.90048 3.501 8.96403L11.4765 16.74C11.6166 16.8765 11.8044 16.953 12 16.953C12.1956 16.953 12.3834 16.8765 12.5235 16.74L20.499 8.96553C20.5643 8.90193 20.6162 8.8259 20.6517 8.74191C20.6871 8.65792 20.7054 8.56769 20.7054 8.47653C20.7054 8.38537 20.6871 8.29513 20.6517 8.21114C20.6162 8.12715 20.5643 8.05112 20.499 7.98753C20.3651 7.85669 20.1852 7.78345 19.998 7.78345C19.8108 7.78345 19.6309 7.85669 19.497 7.98753V7.98903Z" fill="#716E7B" stroke="#716E7B"/>
                        </svg></span><span style="margin-left:1px;color:#716E7B">${e.data._directSubordinatesPaging} </span></div>
                    `}[i.layout](e.children)}  </div>`,pagingButton:(e,i,r,o)=>{const s=o.pagingStep(e.parent),a=e.parent.data._pagingStep,u=e.parent.data._directSubordinatesPaging-a;return`
                   <div style="margin-top:90px;">
                      <div style="display:flex;width:170px;border-radius:20px;padding:5px 15px; padding-bottom:4px;;background-color:#E5E9F2">
                      <div><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.59 7.41L10.18 12L5.59 16.59L7 18L13 12L7 6L5.59 7.41ZM16 6H18V18H16V6Z" fill="#716E7B" stroke="#716E7B"/>
                      </svg>
                      </div><div style="line-height:2"> Show next ${Math.min(u,s)}  nodes </div></div>
                   </div>
                `},nodeUpdate:function(e,i,r){M.select(this).select(".node-rect").attr("stroke",o=>o.data._highlighted||o.data._upToTheRootHighlighted?"#E27396":"none").attr("stroke-width",e.data._highlighted||e.data._upToTheRootHighlighted?10:1)},nodeEnter:e=>e,nodeExit:e=>e,linkUpdate:function(e,i,r){M.select(this).attr("stroke",o=>o.data._upToTheRootHighlighted?"#E27396":"#E4E2E9").attr("stroke-width",o=>o.data._upToTheRootHighlighted?5:1),e.data._upToTheRootHighlighted&&M.select(this).raise()},hdiagonal:function(e,i,r){const o=e.x,s=e.y,a=i.x,u=i.y;let l=r&&r.x!=null?r.x:o,c=r&&r.y!=null?r.y:s,f=a-o<0?-1:1,d=u-s<0?-1:1,p=35,x=Math.abs(a-o)/2<p?Math.abs(a-o)/2:p;x=Math.abs(u-s)/2<x?Math.abs(u-s)/2:x;let y=Math.abs(a-o)/2-x;return`
                          M ${l} ${c}
                          L ${l} ${s}
                          L ${o} ${s}
                          L ${o+y*f} ${s}
                          C ${o+y*f+x*f} ${s} 
                            ${o+y*f+x*f} ${s} 
                            ${o+y*f+x*f} ${s+x*d}
                          L ${o+y*f+x*f} ${u-x*d} 
                          C ${o+y*f+x*f}  ${u} 
                            ${o+y*f+x*f}  ${u} 
                            ${a-y*f}  ${u}
                          L ${a} ${u}
               `},diagonal:function(e,i,r,o={sy:0}){const s=e.x;let a=e.y;const u=i.x,l=i.y;let c=r&&r.x!=null?r.x:s,f=r&&r.y!=null?r.y:a,d=u-s<0?-1:1,p=l-a<0?-1:1;a+=o.sy;let x=35,y=Math.abs(u-s)/2<x?Math.abs(u-s)/2:x;y=Math.abs(l-a)/2<y?Math.abs(l-a)/2:y;let C=Math.abs(l-a)/2-y,_=Math.abs(u-s)-y*2;return`
                          M ${c} ${f}
                          L ${s} ${f}
                          L ${s} ${a}
                          L ${s} ${a+C*p}
                          C  ${s} ${a+C*p+y*p} ${s} ${a+C*p+y*p} ${s+y*d} ${a+C*p+y*p}
                          L ${s+_*d+y*d} ${a+C*p+y*p}
                          C  ${u}  ${a+C*p+y*p} ${u}  ${a+C*p+y*p} ${u} ${l-C*p}
                          L ${u} ${l}
               `},defs:function(e,i){return`<defs>
                    ${i.map(r=>{const o=this.getTextWidth(r.label,{ctx:e.ctx,fontSize:2,defaultFont:e.defaultFont});return`
                       <marker id="${r.from+"_"+r.to}" refX="${r._source.x<r._target.x?-7:7}" refY="5" markerWidth="500"  markerHeight="500"  orient="${r._source.x<r._target.x?"auto":"auto-start-reverse"}" >
                       <rect rx=0.5 width=${r.label?o+3:0} height=3 y=1  fill="#E27396"></rect>
                       <text font-size="2px" x=1 fill="white" y=3>${r.label||""}</text>
                       </marker>

                       <marker id="arrow-${r.from+"_"+r.to}"  markerWidth="500"  markerHeight="500"  refY="2"  refX="1" orient="${r._source.x<r._target.x?"auto":"auto-start-reverse"}" >
                       <path transform="translate(0)" d='M0,0 V4 L2,2 Z' fill='#E27396' />
                       </marker>
                    `}).join("")}
                    </defs>
                    `},connectionsUpdate:function(e,i,r){M.select(this).attr("stroke",o=>"#E27396").attr("stroke-linecap","round").attr("stroke-width",o=>"5").attr("pointer-events","none").attr("marker-start",o=>`url(#${o.from+"_"+o.to})`).attr("marker-end",o=>`url(#arrow-${o.from+"_"+o.to})`)},linkGroupArc:M.linkHorizontal().x(e=>e.x).y(e=>e.y),layoutBindings:{left:{nodeLeftX:e=>0,nodeRightX:e=>e.width,nodeTopY:e=>-e.height/2,nodeBottomY:e=>e.height/2,nodeJoinX:e=>e.x+e.width,nodeJoinY:e=>e.y-e.height/2,linkJoinX:e=>e.x+e.width,linkJoinY:e=>e.y,linkX:e=>e.x,linkY:e=>e.y,linkCompactXStart:e=>e.x+e.width/2,linkCompactYStart:e=>e.y+(e.compactEven?e.height/2:-e.height/2),compactLinkMidX:(e,i)=>e.firstCompactNode.x,compactLinkMidY:(e,i)=>e.firstCompactNode.y+e.firstCompactNode.flexCompactDim[0]/4+i.compactMarginPair(e)/4,linkParentX:e=>e.parent.x+e.parent.width,linkParentY:e=>e.parent.y,buttonX:e=>e.width,buttonY:e=>e.height/2,centerTransform:({root:e,rootMargin:i,centerY:r,scale:o,centerX:s})=>`translate(${i},${r}) scale(${o})`,compactDimension:{sizeColumn:e=>e.height,sizeRow:e=>e.width,reverse:e=>e.slice().reverse()},nodeFlexSize:({height:e,width:i,siblingsMargin:r,childrenMargin:o,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[e+r,i+o],zoomTransform:({centerY:e,scale:i})=>`translate(0,${e}) scale(${i})`,diagonal:this.hdiagonal.bind(this),swap:e=>{const i=e.x;e.x=e.y,e.y=i},nodeUpdateTransform:({x:e,y:i,width:r,height:o})=>`translate(${e},${i-o/2})`},top:{nodeLeftX:e=>-e.width/2,nodeRightX:e=>e.width/2,nodeTopY:e=>0,nodeBottomY:e=>e.height,nodeJoinX:e=>e.x-e.width/2,nodeJoinY:e=>e.y+e.height,linkJoinX:e=>e.x,linkJoinY:e=>e.y+e.height,linkCompactXStart:e=>e.x+(e.compactEven?e.width/2:-e.width/2),linkCompactYStart:e=>e.y+e.height/2,compactLinkMidX:(e,i)=>e.firstCompactNode.x+e.firstCompactNode.flexCompactDim[0]/4+i.compactMarginPair(e)/4,compactLinkMidY:e=>e.firstCompactNode.y,compactDimension:{sizeColumn:e=>e.width,sizeRow:e=>e.height,reverse:e=>e},linkX:e=>e.x,linkY:e=>e.y,linkParentX:e=>e.parent.x,linkParentY:e=>e.parent.y+e.parent.height,buttonX:e=>e.width/2,buttonY:e=>e.height,centerTransform:({root:e,rootMargin:i,centerY:r,scale:o,centerX:s})=>`translate(${s},${i}) scale(${o})`,nodeFlexSize:({height:e,width:i,siblingsMargin:r,childrenMargin:o,state:s,node:a,compactViewIndex:u})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[i+r,e+o],zoomTransform:({centerX:e,scale:i})=>`translate(${e},0}) scale(${i})`,diagonal:this.diagonal.bind(this),swap:e=>{},nodeUpdateTransform:({x:e,y:i,width:r,height:o})=>`translate(${e-r/2},${i})`},bottom:{nodeLeftX:e=>-e.width/2,nodeRightX:e=>e.width/2,nodeTopY:e=>-e.height,nodeBottomY:e=>0,nodeJoinX:e=>e.x-e.width/2,nodeJoinY:e=>e.y-e.height-e.height,linkJoinX:e=>e.x,linkJoinY:e=>e.y-e.height,linkCompactXStart:e=>e.x+(e.compactEven?e.width/2:-e.width/2),linkCompactYStart:e=>e.y-e.height/2,compactLinkMidX:(e,i)=>e.firstCompactNode.x+e.firstCompactNode.flexCompactDim[0]/4+i.compactMarginPair(e)/4,compactLinkMidY:e=>e.firstCompactNode.y,linkX:e=>e.x,linkY:e=>e.y,compactDimension:{sizeColumn:e=>e.width,sizeRow:e=>e.height,reverse:e=>e},linkParentX:e=>e.parent.x,linkParentY:e=>e.parent.y-e.parent.height,buttonX:e=>e.width/2,buttonY:e=>0,centerTransform:({root:e,rootMargin:i,centerY:r,scale:o,centerX:s,chartHeight:a})=>`translate(${s},${a-i}) scale(${o})`,nodeFlexSize:({height:e,width:i,siblingsMargin:r,childrenMargin:o,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[i+r,e+o],zoomTransform:({centerX:e,scale:i})=>`translate(${e},0}) scale(${i})`,diagonal:this.diagonal.bind(this),swap:e=>{e.y=-e.y},nodeUpdateTransform:({x:e,y:i,width:r,height:o})=>`translate(${e-r/2},${i-o})`},right:{nodeLeftX:e=>-e.width,nodeRightX:e=>0,nodeTopY:e=>-e.height/2,nodeBottomY:e=>e.height/2,nodeJoinX:e=>e.x-e.width-e.width,nodeJoinY:e=>e.y-e.height/2,linkJoinX:e=>e.x-e.width,linkJoinY:e=>e.y,linkX:e=>e.x,linkY:e=>e.y,linkParentX:e=>e.parent.x-e.parent.width,linkParentY:e=>e.parent.y,buttonX:e=>0,buttonY:e=>e.height/2,linkCompactXStart:e=>e.x-e.width/2,linkCompactYStart:e=>e.y+(e.compactEven?e.height/2:-e.height/2),compactLinkMidX:(e,i)=>e.firstCompactNode.x,compactLinkMidY:(e,i)=>e.firstCompactNode.y+e.firstCompactNode.flexCompactDim[0]/4+i.compactMarginPair(e)/4,centerTransform:({root:e,rootMargin:i,centerY:r,scale:o,centerX:s,chartWidth:a})=>`translate(${a-i},${r}) scale(${o})`,nodeFlexSize:({height:e,width:i,siblingsMargin:r,childrenMargin:o,state:s,node:a})=>s.compact&&a.flexCompactDim?[a.flexCompactDim[0],a.flexCompactDim[1]]:[e+r,i+o],compactDimension:{sizeColumn:e=>e.height,sizeRow:e=>e.width,reverse:e=>e.slice().reverse()},zoomTransform:({centerY:e,scale:i})=>`translate(0,${e}) scale(${i})`,diagonal:this.hdiagonal.bind(this),swap:e=>{const i=e.x;e.x=-e.y,e.y=i},nodeUpdateTransform:({x:e,y:i,width:r,height:o})=>`translate(${e-r},${i-o/2})`}}};this.getChartState=()=>n,Object.keys(n).forEach(e=>{this[e]=function(i){if(arguments.length)n[e]=i;else return n[e];return this}}),this.initializeEnterExitUpdatePattern()}initializeEnterExitUpdatePattern(){M.selection.prototype.patternify=function(n){var e=this,i=n.selector,r=n.tag,o=n.data||[i],s=e.selectAll("."+i).data(o,(a,u)=>typeof a=="object"&&a.id?a.id:u);return s.exit().remove(),s=s.enter().append(r).merge(s),s.attr("class",i),s}}getNodeChildren({data:n,children:e,_children:i},r){return r.push(n),e&&e.forEach(o=>{this.getNodeChildren(o,r)}),i&&i.forEach(o=>{this.getNodeChildren(o,r)}),r}initialZoom(n){const e=this.getChartState();return e.lastTransform.k=n,this}render(){const n=this.getChartState();if(!n.data||n.data.length==0)return console.log("ORG CHART - Data is empty"),n.container&&(H(n.container).select(".nodes-wrapper").remove(),H(n.container).select(".links-wrapper").remove(),H(n.container).select(".connections-wrapper").remove()),this;const e=M.select(n.container),i=e.node().getBoundingClientRect();i.width>0&&(n.svgWidth=i.width);const r={id:`ID${Math.floor(Math.random()*1e6)}`,chartWidth:n.svgWidth,chartHeight:n.svgHeight};if(n.calc=r,r.centerX=r.chartWidth/2,r.centerY=r.chartHeight/2,n.firstDraw){const a={zoom:null};a.zoom=n.createZoom().clickDistance(10).on("start",(u,l)=>n.onZoomStart(u)).on("end",(u,l)=>n.onZoomEnd(u)).on("zoom",(u,l)=>{n.onZoom(u),this.zoomed(u,l)}).scaleExtent(n.scaleExtent),n.zoomBehavior=a.zoom}n.flexTreeLayout=me({nodeSize:a=>{const u=n.nodeWidth(a),l=n.nodeHeight(a),c=n.siblingsMargin(a),f=n.childrenMargin(a);return n.layoutBindings[n.layout].nodeFlexSize({state:n,node:a,width:u,height:l,siblingsMargin:c,childrenMargin:f})}}).spacing((a,u)=>a.parent==u.parent?0:n.neighbourMargin(a,u)),this.setLayouts({expandNodesFirst:!1});const o=e.patternify({tag:"svg",selector:"svg-chart-container"}).attr("width",n.svgWidth).attr("height",n.svgHeight).attr("font-family",n.defaultFont);n.firstDraw&&o.call(n.zoomBehavior).on("dblclick.zoom",null).attr("cursor","move"),n.svg=o;const s=o.patternify({tag:"g",selector:"chart"});return n.centerG=s.patternify({tag:"g",selector:"center-group"}),n.linksWrapper=n.centerG.patternify({tag:"g",selector:"links-wrapper"}),n.nodesWrapper=n.centerG.patternify({tag:"g",selector:"nodes-wrapper"}),n.connectionsWrapper=n.centerG.patternify({tag:"g",selector:"connections-wrapper"}),n.defsWrapper=o.patternify({tag:"g",selector:"defs-wrapper"}),n.firstDraw&&n.centerG.attr("transform",()=>n.layoutBindings[n.layout].centerTransform({centerX:r.centerX,centerY:r.centerY,scale:n.lastTransform.k,rootMargin:n.rootMargin,root:n.root,chartHeight:r.chartHeight,chartWidth:r.chartWidth})),n.chart=s,this.update(n.root),M.select(window).on(`resize.${n.id}`,()=>{const a=M.select(n.container).node().getBoundingClientRect();n.svg.attr("width",a.width)}),n.firstDraw&&(n.firstDraw=!1),this}addNode(n){const e=this.getChartState();if(n&&(e.parentNodeId(n)==null||e.parentNodeId(n)==e.nodeId(n))&&e.data.length==0)return e.data.push(n),this.render(),this;const r=e.generateRoot(e.data).descendants(),o=r.filter(({data:s})=>e.nodeId(s).toString()===e.nodeId(n).toString())[0];return r.filter(({data:s})=>e.nodeId(s).toString()===e.parentNodeId(n).toString())[0],o?(console.log(`ORG CHART - ADD - Node with id "${e.nodeId(n)}" already exists in tree`),this):(n._centered&&!n._expanded&&(n._expanded=!0),e.data.push(n),this.updateNodesState(),this)}removeNode(n){const e=this.getChartState(),o=e.generateRoot(e.data).descendants().filter(({data:a})=>e.nodeId(a)==n)[0];return o?(o.descendants().forEach(a=>a.data._filteredOut=!0),e.data=e.data.filter(a=>!a._filteredOut),e.data.length==0?this.render():this.updateNodesState.bind(this)(),this):(console.log(`ORG CHART - REMOVE - Node with id "${n}" not found in the tree`),this)}groupBy(n,e,i){const r={};return n.forEach(o=>{const s=e(o);r[s]||(r[s]=[]),r[s].push(o)}),Object.keys(r).forEach(o=>{r[o]=i(r[o])}),Object.entries(r)}calculateCompactFlexDimensions(n){const e=this.getChartState();n.eachBefore(i=>{i.firstCompact=null,i.compactEven=null,i.flexCompactDim=null,i.firstCompactNode=null}),n.eachBefore(i=>{if(i.children&&i.children.length>1){const r=i.children.filter(c=>!c.children);if(r.length<2)return;r.forEach((c,f)=>{f||(c.firstCompact=!0),f%2?c.compactEven=!1:c.compactEven=!0,c.row=Math.floor(f/2)});const o=M.max(r.filter(c=>c.compactEven),e.layoutBindings[e.layout].compactDimension.sizeColumn),s=M.max(r.filter(c=>!c.compactEven),e.layoutBindings[e.layout].compactDimension.sizeColumn),a=Math.max(o,s)*2,u=this.groupBy(r,c=>c.row,c=>M.max(c,f=>e.layoutBindings[e.layout].compactDimension.sizeRow(f)+e.compactMarginBetween(f))),l=M.sum(u.map(c=>c[1]));r.forEach(c=>{c.firstCompactNode=r[0],c.firstCompact?c.flexCompactDim=[a+e.compactMarginPair(c),l-e.compactMarginBetween(c)]:c.flexCompactDim=[0,0]}),i.flexCompactDim=null}})}calculateCompactFlexPositions(n){const e=this.getChartState();n.eachBefore(i=>{if(i.children){const r=i.children.filter(c=>c.flexCompactDim),o=r[0];if(!o)return;r.forEach((c,f,d)=>{f==0&&(o.x-=o.flexCompactDim[0]/2),f&f%2-1?c.x=o.x+o.flexCompactDim[0]*.25-e.compactMarginPair(c)/4:f&&(c.x=o.x+o.flexCompactDim[0]*.75+e.compactMarginPair(c)/4)});const s=o.x+o.flexCompactDim[0]*.5;o.x=o.x+o.flexCompactDim[0]*.25-e.compactMarginPair(o)/4;const a=i.x-s;Math.abs(a)<10&&r.forEach(c=>c.x+=a);const u=this.groupBy(r,c=>c.row,c=>M.max(c,f=>e.layoutBindings[e.layout].compactDimension.sizeRow(f))),l=M.cumsum(u.map(c=>c[1]+e.compactMarginBetween(c)));r.forEach((c,f)=>{c.row?c.y=o.y+l[c.row-1]:c.y=o.y})}})}update({x0:n,y0:e,x:i=0,y:r=0,width:o,height:s}){const a=this.getChartState();a.calc,a.compact&&this.calculateCompactFlexDimensions(a.root);const u=a.flexTreeLayout(a.root);a.compact&&this.calculateCompactFlexPositions(a.root);const l=u.descendants(),c=u.descendants().slice(1);l.forEach(a.layoutBindings[a.layout].swap);const f=a.connections,d={};a.allNodes.forEach(h=>d[a.nodeId(h.data)]=h);const p={};l.forEach(h=>p[a.nodeId(h.data)]=h),f.forEach(h=>{const m=d[h.from],w=d[h.to];h._source=m,h._target=w});const x=f.filter(h=>p[h.from]&&p[h.to]),y=a.defs.bind(this)(a,x),C=a.defsWrapper.html();y!==C&&a.defsWrapper.html(y);const _=a.linksWrapper.selectAll("path.link").data(c,h=>a.nodeId(h.data)),S=_.enter().insert("path","g").attr("class","link").attr("d",h=>{const m=a.layoutBindings[a.layout].linkJoinX({x:n,y:e,width:o,height:s}),w=a.layoutBindings[a.layout].linkJoinY({x:n,y:e,width:o,height:s}),v={x:m,y:w};return a.layoutBindings[a.layout].diagonal(v,v,v)}).merge(_);S.attr("fill","none"),this.isEdge()?S.style("display",h=>h.data._pagingButton?"none":"auto"):S.attr("display",h=>h.data._pagingButton?"none":"auto"),S.each(a.linkUpdate),S.transition().duration(a.duration).attr("d",h=>{const m=a.compact&&h.flexCompactDim?{x:a.layoutBindings[a.layout].compactLinkMidX(h,a),y:a.layoutBindings[a.layout].compactLinkMidY(h,a)}:{x:a.layoutBindings[a.layout].linkX(h),y:a.layoutBindings[a.layout].linkY(h)},w={x:a.layoutBindings[a.layout].linkParentX(h),y:a.layoutBindings[a.layout].linkParentY(h)},v=a.compact&&h.flexCompactDim?{x:a.layoutBindings[a.layout].linkCompactXStart(h),y:a.layoutBindings[a.layout].linkCompactYStart(h)}:m;return a.layoutBindings[a.layout].diagonal(m,w,v,{sy:a.linkYOffset})}),_.exit().transition().duration(a.duration).attr("d",h=>{const m=a.layoutBindings[a.layout].linkJoinX({x:i,y:r,width:o,height:s}),w=a.layoutBindings[a.layout].linkJoinY({x:i,y:r,width:o,height:s}),v={x:m,y:w};return a.layoutBindings[a.layout].diagonal(v,v,null,{sy:a.linkYOffset})}).remove();const k=a.connectionsWrapper.selectAll("path.connection").data(x),A=k.enter().insert("path","g").attr("class","connection").attr("d",h=>{const m=a.layoutBindings[a.layout].linkJoinX({x:n,y:e,width:o,height:s}),w=a.layoutBindings[a.layout].linkJoinY({x:n,y:e,width:o,height:s}),v={x:m,y:w};return a.layoutBindings[a.layout].diagonal(v,v,null,{sy:a.linkYOffset})}).merge(k);A.attr("fill","none"),A.transition().duration(a.duration).attr("d",h=>{const m=a.layoutBindings[a.layout].linkX({x:h._source.x,y:h._source.y,width:h._source.width,height:h._source.height}),w=a.layoutBindings[a.layout].linkY({x:h._source.x,y:h._source.y,width:h._source.width,height:h._source.height}),v=a.layoutBindings[a.layout].linkJoinX({x:h._target.x,y:h._target.y,width:h._target.width,height:h._target.height}),b=a.layoutBindings[a.layout].linkJoinY({x:h._target.x,y:h._target.y,width:h._target.width,height:h._target.height});return a.linkGroupArc({source:{x:m,y:w},target:{x:v,y:b}})}),A.each(a.connectionsUpdate),k.exit().transition().duration(a.duration).attr("opacity",0).remove();const R=a.nodesWrapper.selectAll("g.node").data(l,({data:h})=>a.nodeId(h)),V=R.enter().append("g").attr("class","node").attr("transform",h=>{if(h==a.root)return`translate(${n},${e})`;const m=a.layoutBindings[a.layout].nodeJoinX({x:n,y:e,width:o,height:s}),w=a.layoutBindings[a.layout].nodeJoinY({x:n,y:e,width:o,height:s});return`translate(${m},${w})`}).attr("cursor","pointer").on("click.node",(h,m)=>{const{data:w}=m;if(![...h.srcElement.classList].includes("node-button-foreign-object")){if([...h.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(m);return}if(!w._pagingButton){a.onNodeClick(m);return}console.log("event fired, no handlers")}}).on("keydown.node",(h,m)=>{const{data:w}=m;if(h.key==="Enter"||h.key===" "||h.key==="Spacebar"){if([...h.srcElement.classList].includes("node-button-foreign-object"))return;if([...h.srcElement.classList].includes("paging-button-wrapper")){this.loadPagingNodes(m);return}(h.key==="Enter"||h.key===" "||h.key==="Spacebar")&&this.onButtonClick(h,m)}});V.each(a.nodeEnter),V.patternify({tag:"rect",selector:"node-rect",data:h=>[h]});const D=V.merge(R).style("font","12px sans-serif");D.patternify({tag:"foreignObject",selector:"node-foreign-object",data:h=>[h]}).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-foreign-object-div",data:h=>[h]}),this.restyleForeignObjectElements();const wt=V.patternify({tag:"g",selector:"node-button-g",data:h=>[h]}).on("click",(h,m)=>this.onButtonClick(h,m)).on("keydown",(h,m)=>{(h.key==="Enter"||h.key===" "||h.key==="Spacebar")&&this.onButtonClick(h,m)});wt.patternify({tag:"rect",selector:"node-button-rect",data:h=>[h]}).attr("opacity",0).attr("pointer-events","all").attr("width",h=>a.nodeButtonWidth(h)).attr("height",h=>a.nodeButtonHeight(h)).attr("x",h=>a.nodeButtonX(h)).attr("y",h=>a.nodeButtonY(h)),wt.patternify({tag:"foreignObject",selector:"node-button-foreign-object",data:h=>[h]}).attr("width",h=>a.nodeButtonWidth(h)).attr("height",h=>a.nodeButtonHeight(h)).attr("x",h=>a.nodeButtonX(h)).attr("y",h=>a.nodeButtonY(h)).style("overflow","visible").patternify({tag:"xhtml:div",selector:"node-button-div",data:h=>[h]}).style("pointer-events","none").style("display","flex").style("width","100%").style("height","100%"),D.transition().attr("opacity",0).duration(a.duration).attr("transform",({x:h,y:m,width:w,height:v})=>a.layoutBindings[a.layout].nodeUpdateTransform({x:h,y:m,width:w,height:v})).attr("opacity",1),D.select(".node-rect").attr("width",({width:h})=>h).attr("height",({height:h})=>h).attr("x",({width:h})=>0).attr("y",({height:h})=>0).attr("cursor","pointer").attr("rx",3).attr("fill",a.nodeDefaultBackground),D.select(".node-button-g").attr("transform",({data:h,width:m,height:w})=>{const v=a.layoutBindings[a.layout].buttonX({width:m,height:w}),b=a.layoutBindings[a.layout].buttonY({width:m,height:w});return`translate(${v},${b})`}).attr("display",({data:h})=>h._directSubordinates>0?null:"none").attr("opacity",({data:h,children:m,_children:w})=>h._pagingButton?0:m||w?1:0),D.select(".node-button-foreign-object .node-button-div").html(h=>a.buttonContent({node:h,state:a})),D.select(".node-button-text").attr("text-anchor","middle").attr("alignment-baseline","middle").attr("font-size",({children:h})=>h?40:26).text(({children:h})=>h?"-":"+").attr("y",this.isEdge()?10:0),D.each(a.nodeUpdate);const ut=R.exit();ut.each(a.nodeExit);const Ht=ut.data().reduce((h,m)=>h.depth<m.depth?h:m,{depth:1/0});ut.attr("opacity",1).transition().duration(a.duration).attr("transform",h=>{let{x:m,y:w,width:v,height:b}=Ht.parent||{};const E=a.layoutBindings[a.layout].nodeJoinX({x:m,y:w,width:v,height:b}),N=a.layoutBindings[a.layout].nodeJoinY({x:m,y:w,width:v,height:b});return`translate(${E},${N})`}).on("end",function(){M.select(this).remove()}).attr("opacity",0),l.forEach(h=>{h.x0=h.x,h.y0=h.y});const g=a.allNodes.filter(h=>h.data._centered)[0];if(g){let h=[g];g.data._centeredWithDescendants&&(a.compact?h=g.descendants().filter((m,w)=>w<7):h=g.descendants().filter((m,w,v)=>{const b=Math.round(v.length/2),E=2;return v.length%2?w>b-E&&w<b+E-1:w>b-E&&w<b+E})),g.data._centeredWithDescendants=null,g.data._centered=null,this.fit({animate:!0,scale:!1,nodes:h})}}isEdge(){return window.navigator.userAgent.includes("Edge")}hdiagonal(n,e,i,r){return this.getChartState().hdiagonal(n,e,i,r)}diagonal(n,e,i,r){return this.getChartState().diagonal(n,e,i,r)}restyleForeignObjectElements(){const n=this.getChartState();n.svg.selectAll(".node-foreign-object").attr("width",({width:e})=>e).attr("height",({height:e})=>e).attr("x",({width:e})=>0).attr("y",({height:e})=>0),n.svg.selectAll(".node-foreign-object-div").style("width",({width:e})=>`${e}px`).style("height",({height:e})=>`${e}px`).html(function(e,i,r){return e.data._pagingButton?`<div class="paging-button-wrapper"><div style="pointer-events:none">${n.pagingButton(e,i,r,n)}</div></div>`:n.nodeContent.bind(this)(e,i,r,n)})}onButtonClick(n,e){const i=this.getChartState();e.data._pagingButton||(i.setActiveNodeCentered&&(e.data._centered=!0,e.data._centeredWithDescendants=!0),e.children?(e._children=e.children,e.children=null,this.setExpansionFlagToChildren(e,!1)):(e.children=e._children,e._children=null,e.children&&e.children.forEach(({data:r})=>r._expanded=!0)),this.update(e),n.stopPropagation(),i.onExpandOrCollapse(e))}setExpansionFlagToChildren({data:n,children:e,_children:i},r){n._expanded=r,e&&e.forEach(o=>{this.setExpansionFlagToChildren(o,r)}),i&&i.forEach(o=>{this.setExpansionFlagToChildren(o,r)})}expandSomeNodes(n){if(n.data._expanded){let e=n.parent;for(;e&&e._children;)e.children=e._children,e._children=null,e=e.parent}n._children&&n._children.forEach(e=>this.expandSomeNodes(e)),n.children&&n.children.forEach(e=>this.expandSomeNodes(e))}updateNodesState(){const n=this.getChartState();this.setLayouts({expandNodesFirst:!0}),this.update(n.root)}setLayouts({expandNodesFirst:n=!0}){const e=this.getChartState();e.generateRoot=M.stratify().id(o=>e.nodeId(o)).parentId(o=>e.parentNodeId(o)),e.root=e.generateRoot(e.data);const i=e.root.descendants();e.initialExpandLevel>1&&i.length>0&&(i.forEach(o=>{o.depth<=e.initialExpandLevel&&(o.data._expanded=!0)}),e.initialExpandLevel=1);const r={};e.root.descendants().filter(o=>o.children).filter(o=>!o.data._pagingStep).forEach(o=>{o.data._pagingStep=e.minPagingVisibleNodes(o)}),e.root.eachBefore((o,s)=>{o.data._directSubordinatesPaging=o.children?o.children.length:0,o.children&&o.children.forEach((a,u)=>{if(a.data._pagingButton=!1,u>o.data._pagingStep&&(r[a.id]=!0),u===o.data._pagingStep&&o.children.length-1>o.data._pagingStep&&(a.data._pagingButton=!0),r[a.parent.id]&&(r[a.id]=!0),a.data._expanded||a.data._centered||a.data._highlighted||a.data._upToTheRootHighlighted){let l=a;for(;l&&(r[l.id]||l.data._pagingButton);)r[l.id]=!1,l.data._pagingButton&&(l.data._pagingButton=!1,l.parent.children.forEach(c=>{c.data._expanded=!0,r[c.id]=!1})),l=l.parent}})}),e.root=M.stratify().id(o=>e.nodeId(o)).parentId(o=>e.parentNodeId(o))(e.data.filter(o=>r[o.id]!==!0)),e.root.each((o,s,a)=>{let u=o._hierarchyHeight||o.height,l=e.nodeWidth(o),c=e.nodeHeight(o);Object.assign(o,{width:l,height:c,_hierarchyHeight:u})}),e.root.x0=0,e.root.y0=0,e.allNodes=e.root.descendants(),e.allNodes.forEach(o=>{Object.assign(o.data,{_directSubordinates:o.children?o.children.length:0,_totalSubordinates:o.descendants().length-1})}),e.root.children&&(n&&e.root.children.forEach(this.expand),e.root.children.forEach(o=>this.collapse(o)),e.initialExpandLevel==0&&(e.root._children=e.root.children,e.root.children=null),[e.root].forEach(o=>this.expandSomeNodes(o)))}collapse(n){n.children&&(n._children=n.children,n._children.forEach(e=>this.collapse(e)),n.children=null)}expand(n){n._children&&(n.children=n._children,n.children.forEach(e=>this.expand(e)),n._children=null)}zoomed(n,e){const i=this.getChartState(),r=i.chart,o=n.transform;i.lastTransform=o,r.attr("transform",o),this.isEdge()&&this.restyleForeignObjectElements()}zoomTreeBounds({x0:n,x1:e,y0:i,y1:r,params:o={animate:!0,scale:!0,onCompleted:()=>{}}}){const{centerG:s,svgWidth:a,svgHeight:u,svg:l,zoomBehavior:c,duration:f,lastTransform:d}=this.getChartState();let p=Math.min(8,.9/Math.max((e-n)/a,(r-i)/u)),x=M.zoomIdentity.translate(a/2,u/2);x=x.scale(o.scale?p:d.k),x=x.translate(-(n+e)/2,-(i+r)/2),l.transition().duration(o.animate?f:0).call(c.transform,x),s.transition().duration(o.animate?f:0).attr("transform","translate(0,0)").on("end",function(){o.onCompleted&&o.onCompleted()})}fit({animate:n=!0,nodes:e,scale:i=!0,onCompleted:r=()=>{}}={}){const o=this.getChartState(),{root:s}=o;let a=e||s.descendants();const u=M.min(a,d=>d.x+o.layoutBindings[o.layout].nodeLeftX(d)),l=M.max(a,d=>d.x+o.layoutBindings[o.layout].nodeRightX(d)),c=M.min(a,d=>d.y+o.layoutBindings[o.layout].nodeTopY(d)),f=M.max(a,d=>d.y+o.layoutBindings[o.layout].nodeBottomY(d));return this.zoomTreeBounds({params:{animate:n,scale:i,onCompleted:r},x0:u-50,x1:l+50,y0:c-50,y1:f+50}),this}loadPagingNodes(n){const e=this.getChartState();n.data._pagingButton=!1;const i=n.parent.data._pagingStep,r=e.pagingStep(n.parent),o=i+r;n.parent.data._pagingStep=o,this.updateNodesState()}setExpanded(n,e=!0){const i=this.getChartState(),r=i.allNodes.filter(({data:o})=>i.nodeId(o)==n)[0];if(!r)return console.log(`ORG CHART - ${e?"EXPAND":"COLLAPSE"} - Node with id (${n})  not found in the tree`),this;if(r.data._expanded=e,e==!1){const o=r.parent||{descendants:()=>[]};o.descendants().filter(a=>a!=o).forEach(a=>a.data._expanded=!1)}return this}setCentered(n){const e=this.getChartState(),o=e.generateRoot(e.data).descendants().filter(({data:a})=>e.nodeId(a).toString()==n.toString())[0];return o?(o.ancestors().forEach(a=>a.data._expanded=!0),o.data._centered=!0,o.data._expanded=!0,this):(console.log(`ORG CHART - CENTER - Node with id (${n}) not found in the tree`),this)}setHighlighted(n){const e=this.getChartState(),o=e.generateRoot(e.data).descendants().filter(a=>e.nodeId(a.data).toString()===n.toString())[0];return o?(o.ancestors().forEach(a=>a.data._expanded=!0),o.data._highlighted=!0,o.data._expanded=!0,o.data._centered=!0,this):(console.log(`ORG CHART - HIGHLIGHT - Node with id (${n})  not found in the tree`),this)}setUpToTheRootHighlighted(n){const e=this.getChartState(),o=e.generateRoot(e.data).descendants().filter(a=>e.nodeId(a.data).toString()===n.toString())[0];return o?(o.ancestors().forEach(a=>a.data._expanded=!0),o.data._upToTheRootHighlighted=!0,o.data._expanded=!0,o.ancestors().forEach(a=>a.data._upToTheRootHighlighted=!0),this):(console.log(`ORG CHART - HIGHLIGHTROOT - Node with id (${n}) not found in the tree`),this)}clearHighlighting(){const n=this.getChartState();return n.allNodes.forEach(e=>{e.data._highlighted=!1,e.data._upToTheRootHighlighted=!1}),this.update(n.root),this}fullscreen(n){const e=this.getChartState(),i=M.select(n||e.container).node();M.select(document).on("fullscreenchange."+e.id,function(r){(document.fullscreenElement||document.mozFullscreenElement||document.webkitFullscreenElement)==i?setTimeout(s=>{e.svg.attr("height",window.innerHeight-40)},500):e.svg.attr("height",e.svgHeight)}),i.requestFullscreen?i.requestFullscreen():i.mozRequestFullScreen?i.mozRequestFullScreen():i.webkitRequestFullscreen?i.webkitRequestFullscreen():i.msRequestFullscreen&&i.msRequestFullscreen()}zoomIn(){const{svg:n,zoomBehavior:e}=this.getChartState();n.transition().call(e.scaleBy,1.3)}zoomOut(){const{svg:n,zoomBehavior:e}=this.getChartState();n.transition().call(e.scaleBy,.78)}toDataURL(n,e){var i=new XMLHttpRequest;i.onload=function(){var r=new FileReader;r.onloadend=function(){e(r.result)},r.readAsDataURL(i.response)},i.open("GET",n),i.responseType="blob",i.send()}exportImg({full:n=!1,scale:e=3,onLoad:i=s=>s,save:r=!0,backgroundColor:o="#FAFAFA"}={}){const s=this,a=this.getChartState(),{svg:u,root:l}=a;let c=0;const f=u.selectAll("img");let d=f.size();const p=()=>{JSON.parse(JSON.stringify(s.lastTransform()));const x=s.duration();n&&s.fit();const{svg:y}=s.getChartState();setTimeout(C=>{s.downloadImage({node:y.node(),scale:e,isSvg:!1,backgroundColor:o,onAlreadySerialized:_=>{s.update(l)},imageName:a.imageName,onLoad:i,save:r})},n?x+10:0)};d>0?f.each(function(){s.toDataURL(this.src,x=>{this.src=x,++c==d&&p()})}):p()}exportSvg(){const{svg:n,imageName:e}=this.getChartState();return this.downloadImage({imageName:e,node:n.node(),scale:3,isSvg:!0}),this}expandAll(){const{allNodes:n,root:e,data:i}=this.getChartState();return i.forEach(r=>r._expanded=!0),this.render(),this}collapseAll(){const{allNodes:n,root:e}=this.getChartState();return n.forEach(i=>i.data._expanded=!1),this.initialExpandLevel(0),this.render(),this}downloadImage({node:n,scale:e=2,imageName:i="graph",isSvg:r=!1,save:o=!0,backgroundColor:s="#FAFAFA",onAlreadySerialized:a=l=>{},onLoad:u=l=>{}}){const l=n;function c(y,C){var _=document.createElement("a");typeof _.download=="string"?(document.body.appendChild(_),_.download=C,_.href=y,_.click(),document.body.removeChild(_)):location.replace(y)}function f(y){const C="http://www.w3.org/2000/xmlns/",_="http://www.w3.org/1999/xlink",$="http://www.w3.org/2000/svg";y=y.cloneNode(!0);const S=window.location.href+"#",k=document.createTreeWalker(y,NodeFilter.SHOW_ELEMENT,null,!1);for(;k.nextNode();)for(const R of k.currentNode.attributes)R.value.includes(S)&&(R.value=R.value.replace(S,"#"));return y.setAttributeNS(C,"xmlns",$),y.setAttributeNS(C,"xmlns:xlink",_),new XMLSerializer().serializeToString(y)}if(r){let y=f(l);y=`<?xml version="1.0" standalone="no"?>\r
`+y;var x="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(y);c(x,i+".svg"),a();return}const d=e,p=document.createElement("img");p.onload=function(){const y=document.createElement("canvas"),C=l.getBoundingClientRect();y.width=C.width*d,y.height=C.height*d;const _=y.getContext("2d");_.fillStyle=s,_.fillRect(0,0,C.width*d,C.height*d),_.drawImage(p,0,0,C.width*d,C.height*d);let $=y.toDataURL("image/png");u&&u($),o&&c($,i+".png")};var x="data:image/svg+xml; charset=utf8, "+encodeURIComponent(f(l));a(),p.src=x}getTextWidth(n,{fontSize:e=14,fontWeight:i=400,defaultFont:r="Helvetice",ctx:o}={}){return o.font=`${i||""} ${e}px ${r} `,o.measureText(n).width}clear(){const n=this.getChartState();M.select(window).on(`resize.${n.id}`,null),n.svg&&n.svg.selectAll("*").remove()}}export{ms as OrgChart};
