import{_ as S}from"./KQNRGUnb.js";import{m as D,f as E}from"./B4utk0fH.js";import{b4 as I,br as T,bd as d,bi as U,aW as B,aY as v,b5 as t,bg as N,aZ as y,b9 as l,b8 as j,a_ as _,aX as F}from"./B132AJ_X.js";import{u as L}from"./DVwEWGMy.js";(function(){try{var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};a.SENTRY_RELEASE={id:"3703708ef9ac1b45e23fc2a6a145a79341d4c60a"}}catch{}})();try{(function(){var a=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},s=new a.Error().stack;s&&(a._sentryDebugIds=a._sentryDebugIds||{},a._sentryDebugIds[s]="4ef88a08-f1b9-459e-a41e-422d35128c3f",a._sentryDebugIdIdentifier="sentry-dbid-4ef88a08-f1b9-459e-a41e-422d35128c3f")})()}catch{}const V={class:"m-2"},z={class:"relative w-40 h-40 rounded-full overflow-hidden border-4 border-white shadow-md cursor-pointer group mx-auto"},Y={key:0,class:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50"},$={class:"bg-white dark:bg-gray-800 p-6 rounded-lg shadow-lg w-full max-w-lg"},q={class:"relative w-full aspect-square border rounded overflow-hidden bg-gray-100 dark:bg-gray-700"},M={class:"flex justify-end gap-3 mt-4"},P=["disabled"],W=I({__name:"AvatarUploader",setup(a){const{refreshUser:s,user:h}=T(),w=B(),u=d(null),p=d(null),n=d(null),f=d(!1),x=U(),i=L("put",`${w.public.apiBase}/account/avatar`,{avatar:null});function C(o){var c,r;const e=(r=(c=o.target)==null?void 0:c.files)==null?void 0:r[0];if(e){const b=new FileReader;b.onload=R=>{var m;u.value=(m=R.target)==null?void 0:m.result,f.value=!0},b.readAsDataURL(e)}}function k({canvas:o}){n.value=o}function g(){u.value=null,f.value=!1,n.value=null}async function A(){if(!n.value)return;const o=await new Promise(e=>n.value.toBlob(e,"image/png"));i.avatar=new File([o],"avatar.png",{type:"image/png"});try{await i.submit(),p.value=n.value.toDataURL(),s(),g()}catch(e){console.error("Upload failed:",e),x.error({title:"Error!",message:"Something went wrong."})}}return(o,e)=>{var r;const c=S;return _(),v("div",V,[t("div",z,[t("input",{type:"file",accept:"image/*",onChange:C,class:"absolute inset-0 opacity-0 z-10 cursor-pointer"},null,32),y(c,{src:p.value||((r=l(h))==null?void 0:r.avatar)||"/default-avatar.png",alt:"Avatar",class:"w-full h-full object-cover rounded-full"},null,8,["src"]),e[0]||(e[0]=t("div",{class:"absolute inset-0 bg-black bg-opacity-20 hidden group-hover:flex items-center justify-center text-white font-medium"}," Change ",-1))]),f.value?(_(),v("div",Y,[t("div",$,[e[1]||(e[1]=t("h3",{class:"text-lg font-semibold mb-4"},"Crop your Avatar",-1)),t("div",q,[y(l(E),{class:"cropper",src:u.value,"stencil-component":l(D),"stencil-props":{aspectRatio:1},onChange:k},null,8,["src","stencil-component"])]),t("div",M,[t("button",{class:"btn-secondary",onClick:g},"Cancel"),t("button",{class:"btn-primary",onClick:A,disabled:l(i).processing},j(l(i).processing?"Saving...":"Save"),9,P)])])])):N("",!0)])}}}),J=F(W,[["__scopeId","data-v-9175315e"]]);export{J as A};
