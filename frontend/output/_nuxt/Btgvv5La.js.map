{"version":3,"file":"Btgvv5La.js","sources":["../../../../pages/dashboard/helpdesk/[url].vue"],"sourcesContent":["<template>\r\n  <div class=\"p-4 sm:p-6 max-w-screen-xl mx-auto space-y-6 sm:space-y-8\">\r\n    <!-- Page Title -->\r\n    <div class=\"flex items-center gap-3\">\r\n      <Icon name=\"mdi-ticket\" class=\"text-blue-600 dark:text-blue-400 text-2xl\" />\r\n      <h1 class=\"text-2xl font-bold text-gray-900 dark:text-gray-100\">Ticket Details</h1>\r\n    </div>\r\n\r\n    <!-- Loader -->\r\n    <div v-if=\"isLoading\" class=\"w-full flex items-center justify-center py-16\">\r\n      <div class=\"flex items-center gap-3 text-gray-700 dark:text-gray-300\">\r\n        <Icon name=\"mdi-loading\" class=\"animate-spin\" />\r\n        <span>Loading ticket and conversation…</span>\r\n      </div>\r\n    </div>\r\n\r\n    <div v-else class=\"grid grid-cols-1 lg:grid-cols-2 gap-6\">\r\n      <!-- Conversation -->\r\n      <section\r\n          :class=\"[\r\n          'order-1 lg:order-none bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-800 shadow-sm flex flex-col',\r\n          chatExpanded ? 'lg:col-span-2' : ''\r\n        ]\"\r\n      >\r\n        <header class=\"px-4 sm:px-6 py-3 border-b border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 rounded-t-lg\">\r\n          <div class=\"flex items-center justify-between\">\r\n            <h2 class=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Conversation</h2>\r\n            <button\r\n                type=\"button\"\r\n                @click=\"chatExpanded = !chatExpanded\"\r\n                class=\"inline-flex items-center gap-2 px-3 py-1.5 rounded border border-gray-300 dark:border-gray-700 text-gray-800 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-800\"\r\n                :aria-pressed=\"chatExpanded\"\r\n            >\r\n              <Icon :name=\"chatExpanded ? 'mdi-arrow-collapse' : 'mdi-arrow-expand'\" />\r\n              <span>{{ chatExpanded ? 'Minimize' : 'Maximize' }}</span>\r\n            </button>\r\n          </div>\r\n        </header>\r\n\r\n        <!-- Fixed-height scroll; latest at bottom via column-reverse -->\r\n        <div\r\n            ref=\"messagesContainer\"\r\n            class=\"px-4 sm:px-6 py-4 space-y-4 flex flex-col-reverse overflow-y-auto\"\r\n            :style=\"{ height: chatExpanded ? expandedHeight : compactHeight }\"\r\n            @scroll.passive=\"onScrollMessages\"\r\n        >\r\n          <!-- sentinel -->\r\n          <div ref=\"topSentinel\"></div>\r\n\r\n          <!-- Messages in ASC; visual bottom thanks to column-reverse -->\r\n          <div\r\n              v-for=\"(message, index) in messages\"\r\n              :key=\"index\"\r\n              :class=\"[\r\n              'flex items-start gap-3',\r\n              message.isSupport ? 'justify-start' : 'justify-end',\r\n            ]\"\r\n          >\r\n            <!-- Left aligned (support): avatar left, bubble right -->\r\n            <template v-if=\"message.isSupport\">\r\n              <img\r\n                  :src=\"message.author.avatar\"\r\n                  :alt=\"message.author.name\"\r\n                  class=\"w-8 h-8 rounded-full border border-gray-200 dark:border-gray-700 shrink-0\"\r\n              />\r\n              <div class=\"max-w-[82%] sm:max-w-[75%]\">\r\n                <div class=\"text-xs text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {{ message.author.name }} • {{ message.author.email }}\r\n                </div>\r\n                <div class=\"p-3 rounded-2xl text-sm shadow-sm break-words ring-1 bg-gray-50 text-gray-900 ring-gray-200 dark:bg-gray-800 dark:text-gray-100 dark:ring-gray-700\">\r\n                  <p class=\"leading-relaxed\">{{ message.text }}</p>\r\n                  <div v-if=\"message.attachments?.length\" class=\"mt-2 grid grid-cols-2 gap-2\">\r\n                    <div v-for=\"(file, i) in message.attachments\" :key=\"i\" class=\"text-xs\">\r\n                      <template v-if=\"isImageUrl(file.url)\">\r\n                        <img :src=\"file.url\" :alt=\"file.name || 'image'\" class=\"max-h-40 w-auto rounded-md border border-gray-200 dark:border-gray-700\" />\r\n                        <div class=\"mt-1 text-[11px] flex items-center justify-between\">\r\n                          <span class=\"truncate\">{{ file.name || 'image' }}</span>\r\n                          <span class=\"text-gray-700 dark:text-gray-300\">{{ file.size ? humanSize(file.size) : '' }}</span>\r\n                        </div>\r\n                      </template>\r\n                      <template v-else>\r\n                        <a :href=\"file.url\" target=\"_blank\" class=\"inline-flex items-center gap-1 underline underline-offset-2 text-blue-800 dark:text-blue-300\">\r\n                          📎 {{ file.name || 'file' }}\r\n                        </a>\r\n                        <span class=\"ml-1 text-gray-700 dark:text-gray-300\">{{ file.size ? humanSize(file.size) : '' }}</span>\r\n                      </template>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"mt-1 text-[10px] text-gray-700 dark:text-gray-300\">\r\n                    {{ message.timestamp }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </template>\r\n\r\n            <!-- Right aligned (user): bubble left, avatar right -->\r\n            <template v-else>\r\n              <div class=\"max-w-[82%] sm:max-w-[75%]\">\r\n                <div class=\"text-right text-xs text-gray-700 dark:text-gray-300 mb-1\">\r\n                  {{ message.author.name }} • {{ message.author.email }}\r\n                </div>\r\n                <div class=\"p-3 rounded-2xl text-sm shadow-sm break-words ring-1 bg-blue-500 text-white ring-blue-600 dark:bg-blue-600 dark:ring-blue-700\">\r\n                  <p class=\"leading-relaxed\">{{ message.text }}</p>\r\n                  <div v-if=\"message.attachments?.length\" class=\"mt-2 grid grid-cols-2 gap-2\">\r\n                    <div v-for=\"(file, i) in message.attachments\" :key=\"i\" class=\"text-xs\">\r\n                      <template v-if=\"isImageUrl(file.url)\">\r\n                        <img :src=\"file.url\" :alt=\"file.name || 'image'\" class=\"max-h-40 w-auto rounded-md border border-gray-200 dark:border-gray-700\" />\r\n                        <div class=\"mt-1 text-[11px] flex items-center justify-between\">\r\n                          <span class=\"truncate\">{{ file.name || 'image' }}</span>\r\n                          <span class=\"text-white dark:text-gray-100\">{{ file.size ? humanSize(file.size) : '' }}</span>\r\n                        </div>\r\n                      </template>\r\n                      <template v-else>\r\n                        <a :href=\"file.url\" target=\"_blank\" class=\"inline-flex items-center gap-1 underline underline-offset-2 text-white dark:text-gray-100\">\r\n                          📎 {{ file.name || 'file' }}\r\n                        </a>\r\n                        <span class=\"ml-1 text-white dark:text-gray-100\">{{ file.size ? humanSize(file.size) : '' }}</span>\r\n                      </template>\r\n                    </div>\r\n                  </div>\r\n                  <div class=\"mt-1 text-[10px] text-white dark:text-gray-100 text-right\">\r\n                    {{ message.timestamp }}\r\n                  </div>\r\n                </div>\r\n              </div>\r\n              <img\r\n                  :src=\"message.author.avatar\"\r\n                  :alt=\"message.author.name\"\r\n                  class=\"w-8 h-8 rounded-full border border-gray-200 dark:border-gray-700 shrink-0\"\r\n              />\r\n            </template>\r\n          </div>\r\n\r\n          <div v-if=\"showNoNewBanner\" class=\"flex items-center justify-center py-2\">\r\n            <span class=\"text-xs text-gray-600 dark:text-gray-400\">No new messages</span>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Composer (unchanged) -->\r\n        <form novalidate @submit.prevent=\"submitReply\" class=\"px-4 sm:px-6 py-3 border-t border-gray-100 dark:border-gray-800 bg-white dark:bg-gray-900 rounded-b-lg\">\r\n          <div class=\"mb-2 text-xs text-gray-700 dark:text-gray-400\">\r\n            Send a message and optionally attach up to 10 images (JPG, PNG, GIF, WEBP, AVIF). Max size per image: {{ humanSize(MAX_FILE_SIZE) }}.\r\n          </div>\r\n          <div class=\"flex items-end gap-2\">\r\n            <div class=\"flex-1\">\r\n              <textarea\r\n                  ref=\"textareaRef\"\r\n                  v-model.trim=\"replyText\"\r\n                  @input=\"autoResize\"\r\n                  rows=\"1\"\r\n                  placeholder=\"Type a message to support…\"\r\n                  class=\"w-full resize-none overflow-hidden bg-white dark:bg-gray-800 text-sm text-gray-900 dark:text-gray-100 placeholder-gray-500 dark:placeholder-gray-400 border border-gray-300 dark:border-gray-700 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n                  :aria-invalid=\"!!fieldErrors.message\"\r\n              ></textarea>\r\n              <p v-if=\"fieldErrors.message\" class=\"mt-1 text-xs text-red-600\">\r\n                {{ fieldErrors.message }}\r\n              </p>\r\n            </div>\r\n            <div class=\"flex items-center gap-2\">\r\n              <label class=\"cursor-pointer p-2 rounded-md hover:bg-gray-100 dark:hover:bg-gray-800 text-gray-700 dark:text-gray-300 shrink-0\" title=\"Attach images\">\r\n                📎\r\n                <input type=\"file\" accept=\"image/*\" multiple @change=\"handleFileChange\" class=\"hidden\" />\r\n              </label>\r\n              <button\r\n                  type=\"submit\"\r\n                  :disabled=\"isSending || !canSubmit\"\r\n                  class=\"shrink-0 inline-flex items-center justify-center px-4 py-2 rounded-md bg-blue-600 text-white hover:bg-blue-700 disabled:opacity-50 focus:outline-none focus:ring-2 focus:ring-blue-500\"\r\n              >\r\n                <Icon v-if=\"isSending\" name=\"mdi-loading\" class=\"animate-spin mr-2\" />\r\n                <span>{{ isSending ? 'Sending…' : 'Send' }}</span>\r\n              </button>\r\n            </div>\r\n          </div>\r\n          <p v-if=\"fieldErrors.attachments\" class=\"mt-2 text-xs text-red-600\">\r\n            {{ fieldErrors.attachments }}\r\n          </p>\r\n          <div v-if=\"attachments.length\" class=\"mt-3 grid grid-cols-3 sm:grid-cols-5 gap-3 text-xs text-gray-800 dark:text-gray-200\">\r\n            <div v-for=\"(file, index) in attachments\" :key=\"index\" class=\"relative group\">\r\n              <img :src=\"objectUrl(file)\" :alt=\"file.name\" class=\"h-20 w-20 object-cover rounded-md border border-gray-200 dark:border-gray-700\" />\r\n              <div class=\"mt-1 w-20 truncate\">{{ file.name }}</div>\r\n              <div class=\"text-[11px] text-gray-700 dark:text-gray-300\">{{ humanSize(file.size) }}</div>\r\n              <button\r\n                  type=\"button\"\r\n                  @click=\"removeAttachment(index)\"\r\n                  class=\"absolute -top-1.5 -right-1.5 bg-red-600 text-white text-[10px] rounded-full px-1.5 py-0.5 opacity-90 hover:opacity-100\"\r\n                  aria-label=\"Remove attachment\"\r\n                  title=\"Remove\"\r\n              >\r\n                ✕\r\n              </button>\r\n            </div>\r\n          </div>\r\n        </form>\r\n      </section>\r\n\r\n      <!-- Ticket Information (unchanged) -->\r\n      <section v-if=\"!chatExpanded\" class=\"bg-white dark:bg-gray-900 rounded-lg border border-gray-200 dark:border-gray-800 shadow-sm\">\r\n        <header class=\"px-4 sm:px-6 py-3 border-b border-gray-100 dark:border-gray-800\">\r\n          <h2 class=\"text-lg font-semibold text-gray-900 dark:text-gray-100\">Ticket Information</h2>\r\n        </header>\r\n        <div class=\"px-4 sm:px-6 py-4 sm:py-6 space-y-4\">\r\n          <!-- fields ... -->\r\n          <div class=\"flex items-start gap-3\">\r\n            <Icon name=\"mdi-format-title\" class=\"text-gray-600 dark:text-gray-400 mt-1\" />\r\n            <div class=\"min-w-0\">\r\n              <div class=\"text-xs text-gray-600 dark:text-gray-400\">Title</div>\r\n              <div class=\"text-base font-medium text-gray-900 dark:text-gray-100 truncate\">{{ ticket.title }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"flex items-start gap-3\">\r\n            <Icon name=\"mdi-information\" class=\"text-gray-600 dark:text-gray-400 mt-1\" />\r\n            <div>\r\n              <div class=\"text-xs text-gray-600 dark:text-gray-400\">Status</div>\r\n              <span\r\n                  :class=\"[\r\n                  'inline-block px-3 py-1 text-xs font-semibold rounded-full',\r\n                  ticket.status === 'Open'\r\n                    ? 'bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200'\r\n                    : ticket.status === 'Resolved'\r\n                      ? 'bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200'\r\n                      : 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300'\r\n                ]\"\r\n              >\r\n                {{ ticket.status }}\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"flex items-start gap-3\">\r\n            <Icon name=\"mdi-alert-circle\" class=\"text-gray-600 dark:text-gray-400 mt-1\" />\r\n            <div>\r\n              <div class=\"text-xs text-gray-600 dark:text-gray-400\">Priority</div>\r\n              <span\r\n                  :class=\"[\r\n                  'inline-block px-3 py-1 text-xs font-semibold rounded-full',\r\n                  ticket.priority === 'High'\r\n                    ? 'bg-red-100 text-red-700 dark:bg-red-900 dark:text-red-200'\r\n                    : ticket.priority === 'Medium'\r\n                      ? 'bg-orange-100 text-orange-700 dark:bg-orange-900 dark:text-orange-200'\r\n                      : 'bg-gray-100 text-gray-700 dark:bg-gray-800 dark:text-gray-300'\r\n                ]\"\r\n              >\r\n                {{ ticket.priority }}\r\n              </span>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"flex items-start gap-3\">\r\n            <Icon name=\"mdi-calendar-clock\" class=\"text-gray-600 dark:text-gray-400 mt-1\" />\r\n            <div>\r\n              <div class=\"text-xs text-gray-600 dark:text-gray-400\">Created At</div>\r\n              <div class=\"text-base text-gray-900 dark:text-gray-100\">{{ ticket.createdAt }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"flex items-start gap-3\">\r\n            <Icon name=\"mdi-text\" class=\"text-gray-600 dark:text-gray-400 mt-1\" />\r\n            <div class=\"min-w-0\">\r\n              <div class=\"text-xs text-gray-600 dark:text-gray-400\">Description</div>\r\n              <div class=\"text-base text-gray-800 dark:text-gray-300 whitespace-pre-line break-words\">{{ ticket.description }}</div>\r\n            </div>\r\n          </div>\r\n\r\n          <div v-if=\"ticketAttachments.length\" class=\"space-y-2\">\r\n            <div class=\"text-xs text-gray-600 dark:text-gray-400\">Ticket Attachments</div>\r\n            <div class=\"grid grid-cols-2 sm:grid-cols-3 gap-3\">\r\n              <a v-for=\"(url, i) in ticketAttachments\" :key=\"i\" :href=\"url\" target=\"_blank\" class=\"block\">\r\n                <img :src=\"url\" alt=\"ticket attachment\" class=\"rounded-md border border-gray-200 dark:border-gray-700 max-h-36 w-auto\" />\r\n              </a>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </section>\r\n    </div>\r\n\r\n    <div v-if=\"!isLoading\">\r\n      <NuxtLink to=\"/dashboard/helpdesk\">\r\n        <button class=\"px-4 py-2 bg-gray-200 dark:bg-gray-800 text-gray-800 dark:text-gray-200 rounded-md hover:bg-gray-300 dark:hover:bg-gray-700\">\r\n          ← Back to List\r\n        </button>\r\n      </NuxtLink>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { nextTick, onMounted, ref, computed } from 'vue'\r\nimport { useRuntimeConfig, useSanctumFetch, useToast } from '#imports'\r\n\r\ndefinePageMeta({ layout: 'dashboard' })\r\n\r\nconst route = useRoute()\r\nconst toast = useToast()\r\nconst config = useRuntimeConfig()\r\n\r\n// Heights: chat has its own scrollbar; page remains compact\r\nconst compactHeight = '480px'\r\nconst expandedHeight = '68vh'\r\n\r\ntype TicketVM = {\r\n  uuid: string\r\n  title: string\r\n  status: string\r\n  priority: string\r\n  createdAt: string\r\n  description: string\r\n  author?: { email: string; name: string; fingerprint: string; avatar?: string }\r\n}\r\n\r\ntype MessageFile = { name?: string; url: string; size?: number }\r\ntype MessageVM = {\r\n  isSupport: boolean\r\n  from: 'user' | 'support'\r\n  text: string\r\n  timestamp: string\r\n  author: { email: string; name: string; fingerprint: string; avatar?: string }\r\n  attachments?: Array<MessageFile>\r\n}\r\n\r\nconst ticket = ref<TicketVM>({ uuid: '', title: '', status: '', priority: '', createdAt: '', description: '' })\r\nconst ticketAttachments = ref<string[]>([])\r\nconst messages = ref<MessageVM[]>([])\r\nconst replyText = ref('')\r\nconst attachments = ref<File[]>([])\r\nconst textareaRef = ref<HTMLTextAreaElement | null>(null)\r\nconst messagesContainer = ref<HTMLElement | null>(null)\r\n\r\nconst isLoading = ref(true)\r\nconst isSending = ref(false)\r\nconst chatExpanded = ref(false)\r\nconst showNoNewBanner = ref(false)\r\nconst isFetchingOlder = ref(false)\r\nconst reachedBeginning = ref(false)\r\n\r\nconst MAX_FILE_SIZE = 1.5 * 1024 * 1024\r\nconst MAX_FILES = 10\r\nconst TOP_TRIGGER_PX = 120\r\n\r\nconst fieldErrors = ref<{ message?: string; attachments?: string }>({})\r\n\r\n// Helpers\r\nconst objectUrl = (file: File) => URL.createObjectURL(file)\r\nconst humanSize = (bytes: number) => { const u = ['B','KB','MB','GB']; let i=0, n=bytes; while(n>=1024&&i<u.length-1){n/=1024;i++} return `${n.toFixed(1)} ${u[i]}` }\r\nconst IMG_EXT_RE = /\\.(jpe?g|png|gif|webp|avif)(?:\\?.*)?$/i\r\nconst isImageUrl = (url: string) => { try { return !!url && IMG_EXT_RE.test(url) } catch { return false } }\r\nconst safeFileName = (url: string, fallback = 'image') => { try { const u = new URL(url); return (u.pathname.split('/').pop() || fallback) } catch { return (url.split('/').pop() || fallback) } }\r\n\r\nconst autoResize = () => { const el = textareaRef.value; if (!el) return; el.style.height='auto'; el.style.height=`${el.scrollHeight}px` }\r\n\r\nconst validateForm = () => {\r\n  fieldErrors.value = {}\r\n  if (!replyText.value.trim() && attachments.value.length === 0) fieldErrors.value.message = 'Please type a message or attach at least one image.'\r\n  if (attachments.value.length > MAX_FILES) fieldErrors.value.attachments = `You can attach up to ${MAX_FILES} images.`\r\n  for (const f of attachments.value) {\r\n    if (!f.type.startsWith('image/')) { fieldErrors.value.attachments = 'Only image files are allowed.'; break }\r\n    if (f.size > MAX_FILE_SIZE) { fieldErrors.value.attachments = `Each image must be ≤ ${humanSize(MAX_FILE_SIZE)}.`; break }\r\n  }\r\n  return Object.keys(fieldErrors.value).length === 0\r\n}\r\n\r\nconst handleFileChange = (e: Event) => {\r\n  const input = e.target as HTMLInputElement\r\n  if (!input.files) return\r\n  const selected = Array.from(input.files)\r\n  const combined = [...attachments.value, ...selected]\r\n  const filtered: File[] = []\r\n  for (const f of combined) {\r\n    if (!f.type.startsWith('image/')) { toast.error({ title: 'Invalid File', message: `❌ ${f.name} is not an image`, timeout: 2500 }); continue }\r\n    if (f.size > MAX_FILE_SIZE) { toast.error({ title: 'Too Large', message: `❌ ${f.name} exceeds ${humanSize(MAX_FILE_SIZE)}`, timeout: 2500 }); continue }\r\n    filtered.push(f)\r\n  }\r\n  if (filtered.length > MAX_FILES) toast.error({ title: 'Too Many Files', message: `❌ Max ${MAX_FILES} images allowed`, timeout: 2500 })\r\n  attachments.value = filtered.slice(0, MAX_FILES)\r\n  input.value = ''\r\n}\r\n\r\nconst removeAttachment = (i: number) => attachments.value.splice(i, 1)\r\n\r\nasync function loadTicket(showDeltaBanner = false) {\r\n  try {\r\n    if (!messages.value.length) isLoading.value = true\r\n    const uuid = route.params.url\r\n    const res: any = await useSanctumFetch(`${config.public.apiBase}/helpdesk/tickets/${uuid}`, { method: 'GET', credentials: 'include' })\r\n    const payload = res.data?.value ?? res?.value ?? res\r\n    if (!payload?.ticket) throw new Error('No ticket data returned')\r\n\r\n    const t = payload.ticket\r\n    ticket.value = {\r\n      uuid: t.uuid,\r\n      title: t.title,\r\n      status: t.status,\r\n      priority: t.priority,\r\n      createdAt: new Date(t.created_at).toLocaleString(),\r\n      description: t.description ?? '',\r\n      author: t.author ? { email: t.author.email, name: t.author.name, fingerprint: t.author.fingerprint, avatar: t.author.avatar } : undefined\r\n    }\r\n    ticketAttachments.value = Array.isArray(t.attachment) ? t.attachment : []\r\n\r\n    // Determine \"user\" vs \"support\" by fingerprint against ticket.author.fingerprint\r\n    const ticketUserFp = ticket.value.author?.fingerprint || null\r\n\r\n    const prevCount = messages.value.length\r\n    messages.value = (payload.conversations ?? []).map((c: any) => {\r\n      const author = {\r\n        email: c.author?.email || '',\r\n        name: c.author?.name || 'Unknown',\r\n        fingerprint: c.author?.fingerprint || '',\r\n        avatar: c.author?.avatar || ''\r\n      }\r\n      const isSupport = ticketUserFp ? (author.fingerprint !== ticketUserFp) : true\r\n      return {\r\n        isSupport,\r\n        from: isSupport ? 'support' : 'user',\r\n        text: c.message,\r\n        timestamp: new Date(c.created_at).toLocaleString(),\r\n        author,\r\n        attachments: (Array.isArray(c.attachment) ? c.attachment : []).map((url: string) => ({ url, name: safeFileName(url) }))\r\n      }\r\n    })\r\n\r\n    await nextTick()\r\n    if (messagesContainer.value) messagesContainer.value.scrollTop = 0\r\n\r\n    if (showDeltaBanner && prevCount === messages.value.length) {\r\n      showNoNewBanner.value = true\r\n      setTimeout(() => (showNoNewBanner.value = false), 1500)\r\n    }\r\n  } catch (e) {\r\n    console.error('Failed to load ticket', e)\r\n    toast.error({ title: 'Error', message: '❌ Failed to load ticket', timeout: 3000 })\r\n  } finally {\r\n    isLoading.value = false\r\n  }\r\n}\r\n\r\nconst onScrollMessages = async () => {\r\n  const el = messagesContainer.value\r\n  if (!el || isFetchingOlder.value || reachedBeginning.value) return\r\n  if (el.scrollTop <= TOP_TRIGGER_PX) await loadOlder()\r\n}\r\n\r\nasync function loadOlder() {\r\n  const el = messagesContainer.value\r\n  if (!el) return\r\n  isFetchingOlder.value = true\r\n  const prevScrollHeight = el.scrollHeight\r\n\r\n  // TODO: implement real older fetch\r\n  const older: MessageVM[] = []\r\n  if (!older.length) {\r\n    reachedBeginning.value = true\r\n    isFetchingOlder.value = false\r\n    return\r\n  }\r\n\r\n  messages.value = [...older, ...messages.value]\r\n  await nextTick()\r\n  const newScrollHeight = el.scrollHeight\r\n  el.scrollTop += (newScrollHeight - prevScrollHeight)\r\n  isFetchingOlder.value = false\r\n}\r\n\r\nconst canSubmit = computed(() => !!replyText.value.trim() || attachments.value.length > 0)\r\n\r\nasync function submitReply() {\r\n  if (!validateForm()) {\r\n    const first = fieldErrors.value.message || fieldErrors.value.attachments\r\n    if (first) toast.error({ title: 'Validation error', message: first, timeout: 2500 })\r\n    return\r\n  }\r\n  try {\r\n    isSending.value = true\r\n    const uuid = route.params.url\r\n    const fd = new FormData()\r\n    fd.append('message', replyText.value)\r\n    attachments.value.forEach(f => fd.append('attachments[]', f))\r\n    const res: any = await useSanctumFetch(`${config.public.apiBase}/helpdesk/tickets/${uuid}/reply`, { method: 'POST', body: fd, credentials: 'include' })\r\n    if (res.error?.value) throw new Error('Reply failed')\r\n    replyText.value = ''\r\n    attachments.value = []\r\n    await loadTicket(true)\r\n    await nextTick()\r\n    if (textareaRef.value) textareaRef.value.style.height = 'auto'\r\n    if (messagesContainer.value) messagesContainer.value.scrollTop = 0\r\n  } catch (e) {\r\n    console.error('Reply failed', e)\r\n    toast.error({ title: 'Error', message: '❌ Failed to send reply', timeout: 3000 })\r\n  } finally {\r\n    isSending.value = false\r\n  }\r\n}\r\n\r\nonMounted(() => loadTicket())\r\n</script>\r\n"],"names":["compactHeight","expandedHeight","MAX_FILE_SIZE","MAX_FILES","TOP_TRIGGER_PX","route","useRoute","toast","useToast","config","useRuntimeConfig","ticket","ref","ticketAttachments","messages","replyText","attachments","textareaRef","messagesContainer","isLoading","isSending","chatExpanded","showNoNewBanner","isFetchingOlder","reachedBeginning","fieldErrors","objectUrl","file","humanSize","bytes","u","i","n","IMG_EXT_RE","isImageUrl","url","safeFileName","fallback","autoResize","el","validateForm","f","handleFileChange","e","input","selected","combined","filtered","removeAttachment","loadTicket","showDeltaBanner","uuid","res","useSanctumFetch","payload","_a","t","ticketUserFp","_b","prevCount","c","author","_c","_d","isSupport","nextTick","onScrollMessages","loadOlder","prevScrollHeight","older","newScrollHeight","canSubmit","computed","submitReply","first","fd","onMounted","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_createVNode","_component_Icon","_cache","_hoisted_3","_hoisted_4","_hoisted_5","_normalizeClass","_hoisted_6","_hoisted_7","$event","_normalizeStyle","_hoisted_9","_Fragment","_renderList","message","index","_hoisted_11","_hoisted_12","_toDisplayString","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_17","_hoisted_18","_hoisted_19","_hoisted_20","_hoisted_21","_hoisted_22","_hoisted_23","_hoisted_24","_hoisted_25","_hoisted_26","_hoisted_27","_hoisted_29","_hoisted_30","_hoisted_31","_hoisted_32","_hoisted_33","_hoisted_34","_hoisted_36","_hoisted_37","_hoisted_38","_hoisted_39","_hoisted_41","_hoisted_42","_hoisted_43","_createBlock","_hoisted_45","_hoisted_46","_hoisted_48","_hoisted_49","_hoisted_50","_hoisted_51","_hoisted_52","_hoisted_53","_hoisted_54","_hoisted_55","_hoisted_56","_hoisted_57","_hoisted_58","_hoisted_59","_hoisted_60","_hoisted_61","_hoisted_62","_hoisted_63","_hoisted_64","_hoisted_67","_component_NuxtLink"],"mappings":"+6HAySMA,GAAgB,QAChBC,GAAiB,OAqCjBC,EAAgB,IAAM,KAAO,KAC7BC,EAAY,GACZC,GAAiB,mCA7CvB,MAAMC,EAAQC,GAAA,EACRC,EAAQC,GAAA,EACRC,EAASC,GAAA,EA0BTC,EAASC,EAAc,CAAE,KAAM,GAAI,MAAO,GAAI,OAAQ,GAAI,SAAU,GAAI,UAAW,GAAI,YAAa,GAAI,EACxGC,EAAoBD,EAAc,EAAE,EACpCE,EAAWF,EAAiB,EAAE,EAC9BG,EAAYH,EAAI,EAAE,EAClBI,EAAcJ,EAAY,EAAE,EAC5BK,EAAcL,EAAgC,IAAI,EAClDM,EAAoBN,EAAwB,IAAI,EAEhDO,EAAYP,EAAI,EAAI,EACpBQ,EAAYR,EAAI,EAAK,EACrBS,EAAeT,EAAI,EAAK,EACxBU,EAAkBV,EAAI,EAAK,EAC3BW,EAAkBX,EAAI,EAAK,EAC3BY,EAAmBZ,EAAI,EAAK,EAM5Ba,EAAcb,EAAgD,EAAE,EAGhEc,EAAaC,GAAe,IAAI,gBAAgBA,CAAI,EACpDC,EAAaC,GAAkB,CAAE,MAAMC,EAAI,CAAC,IAAI,KAAK,KAAK,IAAI,EAAG,IAAIC,EAAE,EAAGC,EAAEH,EAAO,KAAMG,GAAG,MAAMD,EAAED,EAAE,OAAO,GAAGE,GAAG,KAAKD,IAAK,MAAO,GAAGC,EAAE,QAAQ,CAAC,CAAC,IAAIF,EAAEC,CAAC,CAAC,EAAG,EAC9JE,EAAa,yCACbC,EAAcC,GAAgB,CAAE,GAAI,CAAE,MAAO,CAAC,CAACA,GAAOF,EAAW,KAAKE,CAAG,CAAE,MAAQ,CAAE,MAAO,EAAM,CAAE,EACpGC,GAAe,CAACD,EAAaE,EAAW,UAAY,CAAE,GAAI,CAA0B,OAAd,IAAI,IAAIF,CAAG,EAAa,SAAS,MAAM,GAAG,EAAE,OAASE,CAAU,MAAQ,CAAE,OAAQF,EAAI,MAAM,GAAG,EAAE,OAASE,CAAU,CAAE,EAE3LC,GAAa,IAAM,CAAE,MAAMC,EAAKtB,EAAY,MAAYsB,IAAYA,EAAG,MAAM,OAAO,OAAQA,EAAG,MAAM,OAAO,GAAGA,EAAG,YAAY,KAAK,EAEnIC,GAAe,IAAM,CACzBf,EAAY,MAAQ,CAAA,EAChB,CAACV,EAAU,MAAM,KAAA,GAAUC,EAAY,MAAM,SAAW,IAAGS,EAAY,MAAM,QAAU,uDACvFT,EAAY,MAAM,OAASb,MAAuB,MAAM,YAAc,wBAAwBA,CAAS,YAC3G,UAAWsC,KAAKzB,EAAY,MAAO,CACjC,GAAI,CAACyB,EAAE,KAAK,WAAW,QAAQ,EAAG,CAAEhB,EAAY,MAAM,YAAc,gCAAiC,KAAM,CAC3G,GAAIgB,EAAE,KAAOvC,EAAe,CAAEuB,EAAY,MAAM,YAAc,wBAAwBG,EAAU1B,CAAa,CAAC,IAAK,KAAM,CAC3H,CACA,OAAO,OAAO,KAAKuB,EAAY,KAAK,EAAE,SAAW,CACnD,EAEMiB,GAAoBC,GAAa,CACrC,MAAMC,EAAQD,EAAE,OAChB,GAAI,CAACC,EAAM,MAAO,OAClB,MAAMC,EAAW,MAAM,KAAKD,EAAM,KAAK,EACjCE,EAAW,CAAC,GAAG9B,EAAY,MAAO,GAAG6B,CAAQ,EAC7CE,EAAmB,CAAA,EACzB,UAAWN,KAAKK,EAAU,CACxB,GAAI,CAACL,EAAE,KAAK,WAAW,QAAQ,EAAG,CAAElC,EAAM,MAAM,CAAE,MAAO,eAAgB,QAAS,KAAKkC,EAAE,IAAI,mBAAoB,QAAS,IAAA,CAAM,EAAG,QAAS,CAC5I,GAAIA,EAAE,KAAOvC,EAAe,CAAEK,EAAM,MAAM,CAAE,MAAO,YAAa,QAAS,KAAKkC,EAAE,IAAI,YAAYb,EAAU1B,CAAa,CAAC,GAAI,QAAS,KAAM,EAAG,QAAS,CACvJ6C,EAAS,KAAKN,CAAC,CACjB,CACIM,EAAS,OAAS5C,GAAWI,EAAM,MAAM,CAAE,MAAO,iBAAkB,QAAS,SAASJ,CAAS,kBAAmB,QAAS,KAAM,EACrIa,EAAY,MAAQ+B,EAAS,MAAM,EAAG5C,CAAS,EAC/CyC,EAAM,MAAQ,EAChB,EAEMI,GAAoBjB,GAAcf,EAAY,MAAM,OAAOe,EAAG,CAAC,EAErE,eAAekB,EAAWC,EAAkB,GAAO,SACjD,GAAI,CACGpC,EAAS,MAAM,WAAkB,MAAQ,IAC9C,MAAMqC,EAAO9C,EAAM,OAAO,IACpB+C,EAAW,MAAMC,EAAgB,GAAG5C,EAAO,OAAO,OAAO,qBAAqB0C,CAAI,GAAI,CAAE,OAAQ,MAAO,YAAa,UAAW,EAC/HG,IAAUC,EAAAH,EAAI,OAAJ,YAAAG,EAAU,SAASH,GAAA,YAAAA,EAAK,QAASA,EACjD,GAAI,EAACE,GAAA,MAAAA,EAAS,QAAQ,MAAM,IAAI,MAAM,yBAAyB,EAE/D,MAAME,EAAIF,EAAQ,OAClB3C,EAAO,MAAQ,CACb,KAAM6C,EAAE,KACR,MAAOA,EAAE,MACT,OAAQA,EAAE,OACV,SAAUA,EAAE,SACZ,UAAW,IAAI,KAAKA,EAAE,UAAU,EAAE,eAAA,EAClC,YAAaA,EAAE,aAAe,GAC9B,OAAQA,EAAE,OAAS,CAAE,MAAOA,EAAE,OAAO,MAAO,KAAMA,EAAE,OAAO,KAAM,YAAaA,EAAE,OAAO,YAAa,OAAQA,EAAE,OAAO,QAAW,MAAA,EAElI3C,EAAkB,MAAQ,MAAM,QAAQ2C,EAAE,UAAU,EAAIA,EAAE,WAAa,CAAA,EAGvE,MAAMC,IAAeC,EAAA/C,EAAO,MAAM,SAAb,YAAA+C,EAAqB,cAAe,KAEnDC,EAAY7C,EAAS,MAAM,OACjCA,EAAS,OAASwC,EAAQ,eAAiB,IAAI,IAAKM,GAAW,aAC7D,MAAMC,EAAS,CACb,QAAON,EAAAK,EAAE,SAAF,YAAAL,EAAU,QAAS,GAC1B,OAAMG,EAAAE,EAAE,SAAF,YAAAF,EAAU,OAAQ,UACxB,cAAaI,EAAAF,EAAE,SAAF,YAAAE,EAAU,cAAe,GACtC,SAAQC,EAAAH,EAAE,SAAF,YAAAG,EAAU,SAAU,EAAA,EAExBC,EAAYP,EAAgBI,EAAO,cAAgBJ,EAAgB,GACzE,MAAO,CACL,UAAAO,EACA,KAAMA,EAAY,UAAY,OAC9B,KAAMJ,EAAE,QACR,UAAW,IAAI,KAAKA,EAAE,UAAU,EAAE,eAAA,EAClC,OAAAC,EACA,aAAc,MAAM,QAAQD,EAAE,UAAU,EAAIA,EAAE,WAAa,CAAA,GAAI,IAAKzB,IAAiB,CAAE,IAAAA,EAAK,KAAMC,GAAaD,CAAG,GAAI,CAAA,CAE1H,CAAC,EAED,MAAM8B,EAAA,EACF/C,EAAkB,QAAOA,EAAkB,MAAM,UAAY,GAE7DgC,GAAmBS,IAAc7C,EAAS,MAAM,SAClDQ,EAAgB,MAAQ,GACxB,WAAW,IAAOA,EAAgB,MAAQ,GAAQ,IAAI,EAE1D,OAASqB,EAAG,CACV,QAAQ,MAAM,wBAAyBA,CAAC,EACxCpC,EAAM,MAAM,CAAE,MAAO,QAAS,QAAS,0BAA2B,QAAS,IAAM,CACnF,QAAA,CACEY,EAAU,MAAQ,EACpB,CACF,CAEA,MAAM+C,GAAmB,SAAY,CACnC,MAAM3B,EAAKrB,EAAkB,MACzB,CAACqB,GAAMhB,EAAgB,OAASC,EAAiB,OACjDe,EAAG,WAAanC,IAAgB,MAAM+D,GAAA,CAC5C,EAEA,eAAeA,IAAY,CACzB,MAAM5B,EAAKrB,EAAkB,MAC7B,GAAI,CAACqB,EAAI,OACThB,EAAgB,MAAQ,GACxB,MAAM6C,EAAmB7B,EAAG,aAGtB8B,EAAqB,CAAA,EAC3B,GAAI,CAACA,EAAM,OAAQ,CACjB7C,EAAiB,MAAQ,GACzBD,EAAgB,MAAQ,GACxB,MACF,CAEAT,EAAS,MAAQ,CAAC,GAAGuD,EAAO,GAAGvD,EAAS,KAAK,EAC7C,MAAMmD,EAAA,EACN,MAAMK,EAAkB/B,EAAG,aAC3BA,EAAG,WAAc+B,EAAkBF,EACnC7C,EAAgB,MAAQ,EAC1B,CAEA,MAAMgD,GAAYC,GAAS,IAAM,CAAC,CAACzD,EAAU,MAAM,KAAA,GAAUC,EAAY,MAAM,OAAS,CAAC,EAEzF,eAAeyD,IAAc,OAC3B,GAAI,CAACjC,KAAgB,CACnB,MAAMkC,EAAQjD,EAAY,MAAM,SAAWA,EAAY,MAAM,YACzDiD,GAAOnE,EAAM,MAAM,CAAE,MAAO,mBAAoB,QAASmE,EAAO,QAAS,KAAM,EACnF,MACF,CACA,GAAI,CACFtD,EAAU,MAAQ,GAClB,MAAM+B,EAAO9C,EAAM,OAAO,IACpBsE,EAAK,IAAI,SAIf,GAHAA,EAAG,OAAO,UAAW5D,EAAU,KAAK,EACpCC,EAAY,MAAM,QAAQyB,GAAKkC,EAAG,OAAO,gBAAiBlC,CAAC,CAAC,GAExDc,GADa,MAAMF,EAAgB,GAAG5C,EAAO,OAAO,OAAO,qBAAqB0C,CAAI,SAAU,CAAE,OAAQ,OAAQ,KAAMwB,EAAI,YAAa,UAAW,GAC9I,QAAJ,MAAApB,EAAW,MAAO,MAAM,IAAI,MAAM,cAAc,EACpDxC,EAAU,MAAQ,GAClBC,EAAY,MAAQ,CAAA,EACpB,MAAMiC,EAAW,EAAI,EACrB,MAAMgB,EAAA,EACFhD,EAAY,QAAOA,EAAY,MAAM,MAAM,OAAS,QACpDC,EAAkB,QAAOA,EAAkB,MAAM,UAAY,EACnE,OAASyB,EAAG,CACV,QAAQ,MAAM,eAAgBA,CAAC,EAC/BpC,EAAM,MAAM,CAAE,MAAO,QAAS,QAAS,yBAA0B,QAAS,IAAM,CAClF,QAAA,CACEa,EAAU,MAAQ,EACpB,CACF,CAEA,OAAAwD,GAAU,IAAM3B,GAAY,0BA5e1B,OAAA4B,EAAA,EAAAC,EA0RM,MA1RNC,GA0RM,CAxRJC,EAGM,MAHNC,GAGM,CAFJC,EAA4EC,EAAA,CAAtE,KAAK,aAAa,MAAM,2CAAA,GAC9BC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAAmF,KAAA,CAA/E,MAAM,uDAAsD,iBAAc,EAAA,EAAA,GAIrE7D,EAAA,OAAX0D,EAAA,EAAAC,EAKM,MALNO,GAKM,CAJJL,EAGM,MAHNM,GAGM,CAFJJ,EAAgDC,EAAA,CAA1C,KAAK,cAAc,MAAM,cAAA,GAC/BC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAA6C,YAAvC,mCAAgC,EAAA,EAAA,OAI1CH,EAAA,EAAAC,EAkQM,MAlQNS,GAkQM,CAhQJP,EA+KU,UAAA,CA9KL,MAAKQ,EAAA,kIAA4JnE,EAAA,MAAY,gBAAA,EAAA,KAKhL2D,EAaS,SAbTS,GAaS,CAZPT,EAWM,MAXNU,GAWM,CAVJN,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAAoF,KAAA,CAAhF,MAAM,wDAAA,EAAyD,eAAY,EAAA,GAC/EA,EAQS,SAAA,CAPL,KAAK,SACJ,QAAKI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAO,GAAEtE,EAAA,MAAY,CAAIA,EAAA,OACxB,MAAM,0KACL,eAAcA,EAAA,KAAA,GAEjB6D,EAAyEC,EAAA,CAAlE,KAAM9D,EAAA,MAAY,qBAAA,kBAAA,mBACzB2D,EAAyD,cAAhD3D,EAAA,MAAY,WAAA,UAAA,EAAA,CAAA,CAAA,YAM3B2D,EAgGM,MAAA,SA/FE,oBAAJ,IAAI9D,EACJ,MAAM,oEACL,MAAK0E,GAAA,CAAA,OAAYvE,EAAA,MAAepB,GAAiBD,GAAa,kBAC9CkE,EAAA,GAGnBc,EAA6B,MAA7Ba,GAA6B,KAAA,GAAA,GAG7BhB,EAAA,EAAA,EAAAC,EAiFMgB,EAAA,KAAAC,EAhFyBjF,EAAA,MAAQ,CAA3BkF,EAASC,IAAK,oBAD1BnB,EAiFM,MAAA,CA/ED,IAAKmB,EACL,MAAKT,EAAA,0BAA4DQ,EAAQ,UAAS,gBAAA,aAAA,KAMrEA,EAAQ,eAAxBlB,EAkCWgB,EAAA,CAAA,IAAA,GAAA,CAjCTd,EAIE,MAAA,CAHG,IAAKgB,EAAQ,OAAO,OACpB,IAAKA,EAAQ,OAAO,KACrB,MAAM,2EAAA,aAEVhB,EA2BM,MA3BNkB,GA2BM,CA1BJlB,EAEM,MAFNmB,GAEMC,EADDJ,EAAQ,OAAO,IAAI,EAAG,MAAGI,EAAGJ,EAAQ,OAAO,KAAK,EAAA,CAAA,EAErDhB,EAsBM,MAtBNqB,GAsBM,CArBJrB,EAAiD,IAAjDsB,GAAiDF,EAAnBJ,EAAQ,IAAI,EAAA,CAAA,GAC/BzC,EAAAyC,EAAQ,cAAR,MAAAzC,EAAqB,QAAhCsB,IAAAC,EAgBM,MAhBNyB,GAgBM,EAfJ1B,EAAA,EAAA,EAAAC,EAcMgB,SAdmBE,EAAQ,YAAW,CAA/BrE,EAAMI,SAAnB+C,EAcM,MAAA,CAdyC,IAAK/C,EAAG,MAAM,SAAA,GAC3CG,EAAWP,EAAK,GAAG,OAAnCmD,EAMWgB,EAAA,CAAA,IAAA,GAAA,CALTd,EAAkI,MAAA,CAA5H,IAAKrD,EAAK,IAAM,IAAKA,EAAK,MAAI,QAAa,MAAM,wEAAA,aACvDqD,EAGM,MAHNwB,GAGM,CAFJxB,EAAwD,OAAxDyB,GAAwDL,EAA9BzE,EAAK,MAAI,OAAA,EAAA,CAAA,EACnCqD,EAAiG,OAAjG0B,GAAiGN,EAA/CzE,EAAK,KAAOC,EAAUD,EAAK,IAAI,EAAA,EAAA,EAAA,CAAA,CAAA,cAGrFmD,EAKWgB,EAAA,CAAA,IAAA,GAAA,CAJTd,EAEI,IAAA,CAFA,KAAMrD,EAAK,IAAK,OAAO,SAAS,MAAM,8FAAA,EAA+F,OACpIyE,EAAGzE,EAAK,MAAI,MAAA,EAAA,EAAAgF,EAAA,EAEjB3B,EAAsG,OAAtG4B,GAAsGR,EAA/CzE,EAAK,KAAOC,EAAUD,EAAK,IAAI,EAAA,EAAA,EAAA,CAAA,CAAA,6BAI5FqD,EAEM,MAFN6B,GAEMT,EADDJ,EAAQ,SAAS,EAAA,CAAA,CAAA,gBAO5BlB,EAkCWgB,EAAA,CAAA,IAAA,GAAA,CAjCTd,EA2BM,MA3BN8B,GA2BM,CA1BJ9B,EAEM,MAFN+B,GAEMX,EADDJ,EAAQ,OAAO,IAAI,EAAG,MAAGI,EAAGJ,EAAQ,OAAO,KAAK,EAAA,CAAA,EAErDhB,EAsBM,MAtBNgC,GAsBM,CArBJhC,EAAiD,IAAjDiC,GAAiDb,EAAnBJ,EAAQ,IAAI,EAAA,CAAA,GAC/BtC,EAAAsC,EAAQ,cAAR,MAAAtC,EAAqB,QAAhCmB,IAAAC,EAgBM,MAhBNoC,GAgBM,EAfJrC,EAAA,EAAA,EAAAC,EAcMgB,SAdmBE,EAAQ,YAAW,CAA/BrE,EAAMI,SAAnB+C,EAcM,MAAA,CAdyC,IAAK/C,EAAG,MAAM,SAAA,GAC3CG,EAAWP,EAAK,GAAG,OAAnCmD,EAMWgB,EAAA,CAAA,IAAA,GAAA,CALTd,EAAkI,MAAA,CAA5H,IAAKrD,EAAK,IAAM,IAAKA,EAAK,MAAI,QAAa,MAAM,wEAAA,aACvDqD,EAGM,MAHNmC,GAGM,CAFJnC,EAAwD,OAAxDoC,GAAwDhB,EAA9BzE,EAAK,MAAI,OAAA,EAAA,CAAA,EACnCqD,EAA8F,OAA9FqC,GAA8FjB,EAA/CzE,EAAK,KAAOC,EAAUD,EAAK,IAAI,EAAA,EAAA,EAAA,CAAA,CAAA,cAGlFmD,EAKWgB,EAAA,CAAA,IAAA,GAAA,CAJTd,EAEI,IAAA,CAFA,KAAMrD,EAAK,IAAK,OAAO,SAAS,MAAM,2FAAA,EAA4F,OACjIyE,EAAGzE,EAAK,MAAI,MAAA,EAAA,EAAA2F,EAAA,EAEjBtC,EAAmG,OAAnGuC,GAAmGnB,EAA/CzE,EAAK,KAAOC,EAAUD,EAAK,IAAI,EAAA,EAAA,EAAA,CAAA,CAAA,6BAIzFqD,EAEM,MAFNwC,GAEMpB,EADDJ,EAAQ,SAAS,EAAA,CAAA,CAAA,KAI1BhB,EAIE,MAAA,CAHG,IAAKgB,EAAQ,OAAO,OACpB,IAAKA,EAAQ,OAAO,KACrB,MAAM,2EAAA,+BAKH1E,EAAA,OAAXuD,EAAA,EAAAC,EAEM,MAFN2C,GAEMrC,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAA,CADJJ,EAA6E,OAAA,CAAvE,MAAM,0CAAA,EAA2C,kBAAe,EAAA,CAAA,mBAK1EA,EAqDO,OAAA,CArDD,WAAA,GAAY,YAAgBP,GAAW,CAAA,SAAA,CAAA,EAAE,MAAM,wGAAA,GACnDO,EAEM,MAFN0C,GAA2D,4GACgD9F,EAAU1B,CAAa,CAAA,EAAI,KACtI,CAAA,EACA8E,EA6BM,MA7BN2C,GA6BM,CA5BJ3C,EAaM,MAbN4C,GAaM,IAZJ5C,EAQY,WAAA,SAPJ,cAAJ,IAAI/D,uCACUF,EAAS,MAAA4E,GACtB,QAAOrD,GACR,KAAK,IACL,YAAY,6BACZ,MAAM,4QACL,eAAY,CAAA,CAAIb,EAAA,MAAY,OAAA,mBALfV,EAAA,aAAN,CAAA,KAAR,EAAA,CAAwB,IAOnBU,EAAA,MAAY,SAArBoD,EAAA,EAAAC,EAEI,IAFJ+C,GAEIzB,EADC3E,EAAA,MAAY,OAAO,EAAA,CAAA,cAG1BuD,EAaM,MAbN8C,GAaM,CAZJ9C,EAGQ,QAHR+C,GAGQ,gBAH8I,MAEpJ,GAAA/C,EAAyF,QAAA,CAAlF,KAAK,OAAO,OAAO,UAAU,SAAA,GAAU,SAAQtC,GAAkB,MAAM,QAAA,aAEhFsC,EAOS,SAAA,CANL,KAAK,SACJ,SAAU5D,EAAA,OAAS,CAAKmD,GAAA,MACzB,MAAM,wLAAA,GAEInD,EAAA,WAAZ4G,GAAsE7C,EAAA,OAA/C,KAAK,cAAc,MAAM,mBAAA,aAChDH,EAAkD,cAAzC5D,EAAA,MAAS,WAAA,MAAA,EAAA,CAAA,CAAA,YAIfK,EAAA,MAAY,aAArBoD,EAAA,EAAAC,EAEI,IAFJmD,GAEI7B,EADC3E,EAAA,MAAY,WAAW,EAAA,CAAA,YAEjBT,EAAA,MAAY,QAAvB6D,IAAAC,EAeM,MAfNoD,GAeM,EAdJrD,EAAA,EAAA,EAAAC,EAaMgB,EAAA,KAAAC,EAbuB/E,EAAA,MAAW,CAA3BW,EAAMsE,SAAnBnB,EAaM,MAAA,CAbqC,IAAKmB,EAAO,MAAM,gBAAA,GAC3DjB,EAAqI,MAAA,CAA/H,IAAKtD,EAAUC,CAAI,EAAI,IAAKA,EAAK,KAAM,MAAM,+EAAA,aACnDqD,EAAqD,MAArDmD,GAAqD/B,EAAlBzE,EAAK,IAAI,EAAA,CAAA,EAC5CqD,EAA0F,MAA1FoD,GAA0FhC,EAA7BxE,EAAUD,EAAK,IAAI,CAAA,EAAA,CAAA,EAChFqD,EAQS,SAAA,CAPL,KAAK,SACJ,QAAKW,GAAE3C,GAAiBiD,CAAK,EAC9B,MAAM,yHACN,aAAW,oBACX,MAAM,QAAA,EACT,MAED,EAAAoC,EAAA,CAAA,gCAOQhH,EAAA,gBAAhBwD,IAAAC,EA6EU,UA7EVwD,GA6EU,eA5ERtD,EAES,SAAA,CAFD,MAAM,mEAAiE,CAC7EA,EAA0F,KAAA,CAAtF,MAAM,wDAAA,EAAyD,oBAAkB,CAAA,OAEvFA,EAwEM,MAxENuD,GAwEM,CAtEJvD,EAMM,MANNwD,GAMM,CALJtD,EAA8EC,EAAA,CAAxE,KAAK,mBAAmB,MAAM,uCAAA,GACpCH,EAGM,MAHNyD,GAGM,CAFJrD,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAAiE,MAAA,CAA5D,MAAM,0CAAA,EAA2C,QAAK,EAAA,GAC3DA,EAAqG,MAArG0D,GAAqGtC,EAArBzF,EAAA,MAAO,KAAK,EAAA,CAAA,CAAA,KAIhGqE,EAiBM,MAjBN2D,GAiBM,CAhBJzD,EAA6EC,EAAA,CAAvE,KAAK,kBAAkB,MAAM,uCAAA,GACnCH,EAcM,MAAA,KAAA,CAbJI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAAkE,MAAA,CAA7D,MAAM,0CAAA,EAA2C,SAAM,EAAA,GAC5DA,EAWO,OAAA,CAVF,MAAKQ,EAAA,6DAAuG7E,EAAA,MAAO,SAAM,+EAAkIA,EAAA,MAAO,SAAM,kJASxQyF,EAAAzF,EAAA,MAAO,MAAM,EAAA,CAAA,CAAA,KAKtBqE,EAiBM,MAjBN4D,GAiBM,CAhBJ1D,EAA8EC,EAAA,CAAxE,KAAK,mBAAmB,MAAM,uCAAA,GACpCH,EAcM,MAAA,KAAA,CAbJI,EAAA,CAAA,IAAAA,EAAA,CAAA,EAAAJ,EAAoE,MAAA,CAA/D,MAAM,0CAAA,EAA2C,WAAQ,EAAA,GAC9DA,EAWO,OAAA,CAVF,MAAKQ,EAAA,6DAAuG7E,EAAA,MAAO,WAAQ,mEAAsHA,EAAA,MAAO,WAAQ,oJAShQyF,EAAAzF,EAAA,MAAO,QAAQ,EAAA,CAAA,CAAA,KAKxBqE,EAMM,MANN6D,GAMM,CALJ3D,EAAgFC,EAAA,CAA1E,KAAK,qBAAqB,MAAM,uCAAA,GACtCH,EAGM,MAAA,KAAA,CAFJI,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAJ,EAAsE,MAAA,CAAjE,MAAM,0CAAA,EAA2C,aAAU,EAAA,GAChEA,EAAoF,MAApF8D,GAAoF1C,EAAzBzF,EAAA,MAAO,SAAS,EAAA,CAAA,CAAA,KAI/EqE,EAMM,MANN+D,GAMM,CALJ7D,EAAsEC,EAAA,CAAhE,KAAK,WAAW,MAAM,uCAAA,GAC5BH,EAGM,MAHNgE,GAGM,CAFJ5D,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAJ,EAAuE,MAAA,CAAlE,MAAM,0CAAA,EAA2C,cAAW,EAAA,GACjEA,EAAsH,MAAtHiE,GAAsH7C,EAA3BzF,EAAA,MAAO,WAAW,EAAA,CAAA,CAAA,KAItGE,EAAA,MAAkB,QAA7BgE,IAAAC,EAOM,MAPNoE,GAOM,CANJ9D,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAAJ,EAA8E,MAAA,CAAzE,MAAM,0CAAA,EAA2C,qBAAkB,EAAA,GACxEA,EAIM,MAJNmE,GAIM,EAHJtE,EAAA,EAAA,EAAAC,EAEIgB,EAAA,KAAAC,EAFkBlF,EAAA,MAAiB,CAA5BsB,EAAKJ,SAAhB+C,EAEI,IAAA,CAFsC,IAAK/C,EAAI,KAAMI,EAAK,OAAO,SAAS,MAAM,OAAA,GAClF6C,EAAyH,MAAA,CAAnH,IAAK7C,EAAK,IAAI,oBAAoB,MAAM,wEAAA,kDAQ9ChB,EAAA,oBAAZ2D,EAMM,MAAAsE,GAAA,CALJlE,EAIWmE,EAAA,CAJD,GAAG,uBAAqB,YAChC,IAESjE,EAAA,EAAA,IAAAA,EAAA,EAAA,EAAA,CAFTJ,EAES,SAAA,CAFD,MAAM,6HAAA,EAA8H,mBAE5I,EAAA,CAAA"}