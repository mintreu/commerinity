import{_ as G}from"./CzGapVpC.js";import{aX as W,br as X,bq as Z,bp as H,bd as i,aW as J,ba as K,aY as s,a_ as o,b5 as t,bk as Q,bg as d,b9 as B,b8 as f,bl as m,bm as T,bh as ee,be as te,bf as ae,bB as le,bu as M,b7 as D,aZ as se,bt as oe,bo as I}from"./B132AJ_X.js";import{_ as ne}from"./DeG0kbPa.js";import{s as ie}from"./BjZ6Woku.js";(function(){try{var v=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{};v.SENTRY_RELEASE={id:"3703708ef9ac1b45e23fc2a6a145a79341d4c60a"}}catch{}})();try{(function(){var v=typeof window<"u"?window:typeof global<"u"?global:typeof globalThis<"u"?globalThis:typeof self<"u"?self:{},_=new v.Error().stack;_&&(v._sentryDebugIds=v._sentryDebugIds||{},v._sentryDebugIds[_]="7d818512-0c0d-49a6-9a21-ad4ecaa24174",v._sentryDebugIdIdentifier="sentry-dbid-7d818512-0c0d-49a6-9a21-ad4ecaa24174")})()}catch{}const re={class:"relative h-screen w-full bg-gray-100 dark:bg-gray-900 overflow-hidden"},ue={class:"relative z-10 flex items-center justify-center h-full px-4 max-w-full"},de={class:"w-full max-w-md bg-white dark:bg-gray-800 shadow-xl rounded-lg p-6 md:p-8"},ve={key:0,class:"space-y-5"},be=["for"],me={class:"flex flex-col gap-2 items-start"},pe=["disabled"],ce=["disabled"],fe={key:2,class:"text-sm text-red-500 mt-1 block"},ye={class:"flex justify-end w-full"},ge=["disabled"],xe={key:0},we={class:"flex gap-2 justify-between"},ke=["onUpdate:modelValue","onInput"],_e={class:"text-xs mt-1 text-gray-500 dark:text-gray-400"},he={key:0,class:"text-sm text-red-500 mt-2"},Pe={key:1,class:"text-center mt-4"},Te={key:1,class:"space-y-5"},Se={key:0,class:"text-red-500 text-sm"},Ce={key:0,class:"text-red-500 text-sm"},Oe={key:0,class:"text-red-500 text-sm"},Ve={key:2,class:"space-y-5"},Ee={class:"relative"},Be=["type"],Ie={key:0},Ne={key:1},Re={class:"relative"},$e=["type"],Me={key:0},De={key:1},Ue={key:0,class:"text-red-500 text-sm"},je={class:"mt-6 text-center text-sm text-gray-600 dark:text-gray-400"},Fe={__name:"RegisterForm",props:{redirectTo:{type:String,default:"/dashboard"}},setup(v){const _=v,{login:U}=X(),j=Z(),F=H(),h=J(),S=i(!1),C=i(!1),r=h.public.registrationMode||"mobile",a=i({mobile:"",email:"",name:"",gender:"",dob:"",password:"",confirmPassword:"",referral:""}),y=i(["","","","","",""]),g=i(!1),x=i(!1),O=i(!1),N=i(!1),b=i(""),w=i(""),k=i(""),V=i(60);let R=null;const P=i(1),p=i(!1);K(()=>{const n=j.query.referral||"";n&&(a.value.referral=n)});async function $(){var c;const n=r,e=(n==="mobile"?a.value.mobile:a.value.email).trim(),u=/^[6-9]\d{9}$/,l=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(n==="mobile"&&!u.test(e)||n==="email"&&!l.test(e)){w.value=n==="mobile"?"Enter a valid 10-digit Indian mobile":"Enter a valid email address",p.value=!1;return}w.value="";try{((c=(await I(`${h.public.apiBase}/auth/has_contact`,{method:"POST",body:{type:n,value:e}})).data)==null?void 0:c.exists)?(w.value=`${n==="mobile"?"Mobile number":"Email"} already in use`,p.value=!1):p.value=!0}catch{w.value="Failed to check contact",p.value=!1}}async function q(){b.value="",x.value=!1,O.value=!0;try{await I(`${h.public.apiBase}/auth/send-otp`,{method:"POST",body:{type:r,value:a.value[r].trim()}}),g.value=!0,p.value=!1,V.value=60,R=ie(()=>{V.value--,V.value<=0&&(clearInterval(R),p.value=!0,O.value=!1)},1e3)}catch{b.value="Failed to send OTP",O.value=!1}}function A(n,e){if(e.inputType!=="deleteContentBackward"){const u=e.target.nextElementSibling;u&&u.focus()}}async function L(){var e,u;const n=y.value.join("");if(n.length!==6){b.value="Enter a 6-digit OTP";return}N.value=!0,b.value="";try{const l=await I(`${h.public.apiBase}/auth/verify-otp`,{method:"POST",body:{type:r,value:a.value[r].trim(),otp:n}});x.value=((e=l==null?void 0:l.data)==null?void 0:e.valid)===!0,x.value||(b.value="Invalid OTP, please try again or resend")}catch(l){b.value=((u=l==null?void 0:l.data)==null?void 0:u.message)||"OTP verification failed"}finally{N.value=!1}}function Y(){!a.value.name||!a.value.gender||!a.value.dob||P.value++}async function z(){var e;if(k.value="",a.value.password!==a.value.confirmPassword){k.value="Passwords do not match";return}if(a.value.password.length<6){k.value="Password must be 6+ characters";return}const n={name:a.value.name,gender:a.value.gender,dob:a.value.dob,password:a.value.password,confirmPassword:a.value.confirmPassword,referral:a.value.referral,type:r,otp:y.value.join(""),...r==="mobile"?{mobile:a.value.mobile}:{email:a.value.email}};try{await I(`${h.public.apiBase}/register`,{method:"POST",body:n}),await U({[r==="mobile"?"mobile":"email"]:a.value[r],password:a.value.password,remember:!0}),F.push(_.redirectTo)}catch(u){k.value=((e=u==null?void 0:u.data)==null?void 0:e.message)||"Registration failed"}}return(n,e)=>{const u=G;return o(),s("div",re,[e[23]||(e[23]=t("div",{class:"absolute inset-0 bg-cover bg-center w-full h-full",style:{"background-image":"url('/images/bg-registration.jpeg')"}},null,-1)),e[24]||(e[24]=t("div",{class:"absolute inset-0 bg-black bg-opacity-30 dark:bg-opacity-40 backdrop-blur-sm"},null,-1)),t("div",ue,[t("div",de,[e[22]||(e[22]=t("div",{class:"flex flex-col items-center mb-6"},[t("img",{src:ne,alt:"Logo",class:"h-12 w-auto mb-2"}),t("h1",{class:"text-xl font-semibold text-gray-900 dark:text-white"},"Create Your Account")],-1)),t("form",{onSubmit:Q(z,["prevent"]),class:"space-y-5"},[P.value===1?(o(),s("div",ve,[t("label",{for:B(r)==="mobile"?"mobile":"email",class:"form-label"},f(B(r)==="mobile"?"Mobile Number":"Email Address"),9,be),t("div",me,[B(r)==="mobile"?m((o(),s("input",{key:0,"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.mobile=l),type:"tel",id:"mobile",placeholder:"e.g. 9876543210",disabled:g.value,onBlur:$,class:"input-field"},null,40,pe)),[[T,a.value.mobile]]):m((o(),s("input",{key:1,"onUpdate:modelValue":e[1]||(e[1]=l=>a.value.email=l),type:"email",id:"email",placeholder:"e.g. you@example.com",disabled:g.value,onBlur:$,class:"input-field"},null,40,ce)),[[T,a.value.email]]),w.value?(o(),s("span",fe,f(w.value),1)):d("",!0),t("div",ye,[p.value?(o(),s("button",{key:0,type:"button",onClick:q,disabled:O.value,class:ee(["text-white px-3 py-2 rounded-md text-sm transition",g.value?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"])},f(g.value?`Resend OTP (${V.value}s)`:"Send OTP"),11,ge)):d("",!0)])]),e[12]||(e[12]=t("p",{class:"text-xs mt-1 text-gray-500 dark:text-gray-400"},"Weâ€™ll send a 6-digit verification code.",-1)),g.value&&!x.value?(o(),s("div",xe,[e[10]||(e[10]=t("label",{class:"form-label mt-4 mb-1"},"OTP Code",-1)),t("div",we,[(o(!0),s(te,null,ae(y.value,(l,c)=>m((o(),s("input",{key:c,maxlength:"1",type:"text",inputmode:"numeric",class:"w-10 h-10 text-center rounded border border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-900 text-lg text-gray-800 dark:text-white focus:outline-none focus:ring-2 focus:ring-blue-500","onUpdate:modelValue":E=>y.value[c]=E,onInput:E=>A(c,E)},null,40,ke)),[[T,y.value[c]]])),128))]),t("p",_e,"Enter the code sent to your "+f(B(r))+".",1),b.value?(o(),s("p",he,f(b.value),1)):d("",!0),y.value.join("").length===6&&!x.value?(o(),s("button",{key:1,type:"button",onClick:L,class:"btn-green mt-2"},f(N.value?"Verifying...":"Verify OTP"),1)):d("",!0)])):x.value?(o(),s("div",Pe,[e[11]||(e[11]=t("div",{class:"text-green-600 font-semibold text-sm"},"âœ… OTP Verified Successfully",-1)),t("button",{type:"button",onClick:e[2]||(e[2]=l=>P.value++),class:"btn-blue mt-3"},"Next")])):d("",!0)])):d("",!0),P.value===2?(o(),s("div",Te,[t("div",null,[e[13]||(e[13]=t("label",{for:"name",class:"form-label"},"Full Name",-1)),m(t("input",{"onUpdate:modelValue":e[3]||(e[3]=l=>a.value.name=l),type:"text",id:"name",class:"input-field"},null,512),[[T,a.value.name]]),a.value.name?d("",!0):(o(),s("span",Se,"Name is required."))]),t("div",null,[e[15]||(e[15]=t("label",{for:"gender",class:"form-label"},"Gender",-1)),m(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.gender=l),id:"gender",class:"input-field"},e[14]||(e[14]=[t("option",{disabled:"",value:""},"Select gender",-1),t("option",{value:"male"},"Male",-1),t("option",{value:"female"},"Female",-1),t("option",{value:"other"},"Other",-1)]),512),[[le,a.value.gender]]),a.value.gender?d("",!0):(o(),s("span",Ce,"Gender is required."))]),t("div",null,[e[16]||(e[16]=t("label",{for:"dob",class:"form-label"},"Date of Birth",-1)),m(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.dob=l),type:"date",id:"dob",class:"input-field"},null,512),[[T,a.value.dob]]),a.value.dob?d("",!0):(o(),s("span",Oe,"Date of birth is required."))]),t("button",{type:"button",onClick:Y,class:"btn-blue mt-4"},"Next")])):d("",!0),P.value===3?(o(),s("div",Ve,[t("div",null,[e[17]||(e[17]=t("label",{for:"password",class:"form-label"},"Password",-1)),t("div",Ee,[m(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.password=l),type:S.value?"text":"password",id:"password",class:"input-field pr-10"},null,8,Be),[[M,a.value.password]]),t("button",{type:"button",onClick:e[7]||(e[7]=l=>S.value=!S.value),class:"absolute right-3 top-2 text-gray-500 dark:text-gray-400"},[S.value?(o(),s("span",Ie,"ðŸ™ˆ")):(o(),s("span",Ne,"ðŸ‘ï¸"))])])]),t("div",null,[e[18]||(e[18]=t("label",{for:"confirmPassword",class:"form-label"},"Confirm Password",-1)),t("div",Re,[m(t("input",{"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.confirmPassword=l),type:C.value?"text":"password",id:"confirmPassword",class:"input-field pr-10"},null,8,$e),[[M,a.value.confirmPassword]]),t("button",{type:"button",onClick:e[9]||(e[9]=l=>C.value=!C.value),class:"absolute right-3 top-2 text-gray-500 dark:text-gray-400"},[C.value?(o(),s("span",Me,"ðŸ™ˆ")):(o(),s("span",De,"ðŸ‘ï¸"))])])]),k.value?(o(),s("span",Ue,f(k.value),1)):d("",!0),e[19]||(e[19]=t("button",{type:"submit",class:"btn-blue mt-4"},"Create Account",-1))])):d("",!0)],32),t("div",je,[e[21]||(e[21]=D(" Already have an account? ")),se(u,{to:"/auth/login",class:"text-blue-600 hover:underline dark:text-blue-400"},{default:oe(()=>e[20]||(e[20]=[D("Login")])),_:1,__:[20]})])])])])}}},Ge=W(Fe,[["__scopeId","data-v-ef9f7de7"]]);export{Ge as _};
